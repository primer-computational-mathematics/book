

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Coordinate systems &#8212; ESE Jupyter Material</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".cell"
        const thebe_selector_input = ".cell_input div.highlight"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Eigenvalues" href="Eigenvalues.html" />
    <link rel="prev" title="Mathematical methods 1" href="intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ESE Jupyter Material</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../../intro.html">Landing page</a>
  </li>
  <li class="">
    <a href="../../coding/intro.html">Coding</a>
  </li>
  <li class="">
    <a href="../../geosciences/intro.html">Geosciences</a>
  </li>
  <li class="active">
    <a href="../intro.html">Mathematics</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="../calculus/intro.html">Calculus</a>
    </li>
    <li class="">
      <a href="../complex analysis/intro.html">Complex analysis</a>
    </li>
    <li class="">
      <a href="../differential_equations/intro.html">Differential equations</a>
    </li>
    <li class="">
      <a href="../linear_algebra/intro.html">Linear algebra</a>
    </li>
    <li class="active">
      <a href="intro.html">Mathematical methods 1</a>
      <ul class="nav sidenav_l3">
      <li class="active">
        <a href="">Coordinate systems</a>
      </li>
      <li class="">
        <a href="Eigenvalues.html">Eigenvalues</a>
      </li>
      <li class="">
        <a href="Matrices_Linear_Algebra.html">Defining a matrix</a>
      </li>
      <li class="">
        <a href="Modelling.html">Numerical differentiation</a>
      </li>
      <li class="">
        <a href="Multivariable_Calculus.html">Multivariable calculus</a>
      </li>
      <li class="">
        <a href="ODEs.html">Order of an ODE</a>
      </li>
      <li class="">
        <a href="Series.html">Series</a>
      </li>
      <li class="">
        <a href="Vector_Calculus.html">Vector calculus</a>
      </li>
      <li class="">
        <a href="Vectors.html">Vectors</a>
      </li>
    </ul>
    </li>
    <li class="">
      <a href="../mathematical_notation/intro.html">Mathematical notation</a>
    </li>
    <li class="">
      <a href="../numerical_methods/intro.html">Numerical methods</a>
    </li>
    <li class="">
      <a href="../series_and_sequences/intro.html">Series and sequences</a>
    </li>
    <li class="">
      <a href="../sets and functions/intro.html">Sets and functions</a>
    </li>
    <li class="">
      <a href="../statistics/intro.html">Statistics</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../../z_extra_resources_for_researchers/intro.html">Extra resources for researchers</a>
  </li>
  <li class="">
    <a href="../../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/mathematics/math_methods_1/Coordinate_Systems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/primer-computational-mathematics/book/issues/new?title=Issue%20on%20page%20%2Fmathematics/math_methods_1/Coordinate_Systems.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/primer-computational-mathematics/book/master?urlpath=tree/notebooks/mathematics/math_methods_1/Coordinate_Systems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#interactive-plots" class="nav-link">Interactive plots</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#functions" class="nav-link">Functions</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#cartesian-coordinates" class="nav-link">Cartesian coordinates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#cartesian-to-polar-conversion" class="nav-link">Cartesian to polar conversion</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#polar-to-cartesian-conversion" class="nav-link">Polar to cartesian conversion</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#cylindrical-and-spherical-coordinates" class="nav-link">Cylindrical and spherical coordinates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#spherical-to-cartesian" class="nav-link">Spherical to cartesian</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#final-tip" class="nav-link">Final tip</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#notebook-extensions" class="nav-link">Notebook extensions</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## This cell just imports necessary modules</span>
<span class="o">%</span><span class="n">pylab</span> <span class="n">notebook</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span> <span class="c1"># For 3D plotting of Cylindrical and Spherical coordinates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
</div>
</div>
<div class="section" id="coordinate-systems">
<h1>Coordinate systems<a class="headerlink" href="#coordinate-systems" title="Permalink to this headline">¶</a></h1>
<p>This notebook will illustrate how to apply the maths discussed in the lecture using Python.</p>
<p>In these notebooks, we will adopt the following prefix convention when naming variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;s&#39;</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">sDotProduct</span><span class="p">)</span> <span class="n">means</span> <span class="n">the</span> <span class="n">variable</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">scalar</span>
<span class="s1">&#39;v&#39;</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">vCrossProduct</span><span class="p">)</span> <span class="n">means</span> <span class="n">the</span> <span class="n">variable</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">vector</span>
<span class="s1">&#39;m&#39;</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">mA</span><span class="p">)</span> <span class="n">means</span> <span class="n">the</span> <span class="n">variable</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">matrix</span>
</pre></div>
</div>
<p>To help us apply coordinate transformations, we start by writing a number of functions for each of the different changes of coordinate that we may wish to apply. Note that we could write each of these functions much more efficiently, but as we are quite new to Python we will err on the side of clarity. First, let’s consider the function for converting from 2D Cartesian coordinates to Polar coordinates.</p>
<div class="section" id="interactive-plots">
<h2>Interactive plots<a class="headerlink" href="#interactive-plots" title="Permalink to this headline">¶</a></h2>
<p>This notebook uses interactive plots that can’t be used on the website. Please download this notebook into jupyter notebooks to gain access to the interactive plots.</p>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cartesian_to_polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts 2D Cartesian coordinates to Polar coordinates.&#39;&#39;&#39;</span>
    <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="c1"># Interpret input</span>
    <span class="n">sX</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># The first component of the input vector is the x-coordinate</span>
    <span class="n">sY</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># The second component of the input vector is the y-coordinate</span>

    <span class="c1"># Coordinate transform</span>
    <span class="n">sR</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sX</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sY</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>     <span class="c1"># Pythagoras&#39; theorem</span>
    <span class="n">sTheta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">sY</span><span class="o">/</span><span class="n">sX</span><span class="p">)</span> <span class="c1"># Simple trigonometry: &#39;TOA&#39;, Tangent = opposite/adjacent</span>
   
    <span class="c1"># Remember: we might have to modify sTheta</span>
    <span class="c1"># depending on which &#39;quadrant&#39; we are in.</span>
    <span class="n">sTheta</span> <span class="o">=</span> <span class="n">check_angle</span><span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">)</span>
      
    <span class="k">return</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that this function itself calls a function, because there will be circumstances when we need to resolve the ambiguity in the angle theta because the tangent fucntion repeats every 180 (or pi) degrees. Let’s write a function <code class="docutils literal notranslate"><span class="pre">check_angle</span></code> to handle these situations.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_angle</span><span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sAngle</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Adjust Polar coordinate angle based on quadrant, returning angle in</span>
<span class="sd">    radians between 0 and 2*pi.&#39;&#39;&#39;</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">sX</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sY</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># We are in the upper left quadrant</span>
        <span class="c1"># so add 180 degrees (pi radians)</span>
        <span class="c1"># onto sAngle</span>
        <span class="n">sAngle</span> <span class="o">=</span> <span class="n">sAngle</span> <span class="o">+</span> <span class="n">pi</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">sX</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sY</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># We are in the lower left quadrant</span>
        <span class="c1"># so add 180 degrees (pi radians)</span>
        <span class="c1"># onto sAngle</span>
        <span class="n">sAngle</span> <span class="o">=</span> <span class="n">sAngle</span> <span class="o">+</span> <span class="n">pi</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">sX</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sY</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># We are in the lower right quadrant</span>
        <span class="c1"># so add 360 degrees (2*pi radians)</span>
        <span class="c1"># onto sAngle</span>
        <span class="n">sAngle</span> <span class="o">=</span> <span class="n">sAngle</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span>
     
    <span class="k">return</span> <span class="n">sAngle</span>
</pre></div>
</div>
</div>
</div>
<p>Now consider the reverse function that converts from Polar coordinates to 2D Cartesian.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">polar_to_cartesian</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A function to convert 2D Polar coordinates to Cartesian coordinates.&#39;&#39;&#39;</span>
    <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="c1"># Interpret input</span>
    <span class="n">sR</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sTheta</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
   
    <span class="c1"># Coordinate transform</span>
    <span class="n">sX</span> <span class="o">=</span> <span class="n">sR</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sTheta</span><span class="p">)</span>
    <span class="n">sY</span> <span class="o">=</span> <span class="n">sR</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sTheta</span><span class="p">)</span>
   
    <span class="k">return</span> <span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can follow this same procedure to define the other functions we might need.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cartesian_to_cylindrical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts 3D Cartesian coordinates to Cylindrical coordinates.&#39;&#39;&#39;</span>
    <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="c1"># 3D Cartesian coordinate vector</span>
    <span class="c1"># Convert to cylindrical coordinates (r, phi, z)</span>
    
    <span class="c1"># Interpret input</span>
    <span class="n">sX</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sY</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sZ</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Coordinate transform</span>
    <span class="n">sR</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sX</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sY</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sPhi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">sY</span><span class="o">/</span><span class="n">sX</span><span class="p">)</span>
   
    <span class="c1"># Again, check that we have the right value of sPhi</span>
    <span class="c1"># for the quadrant we are in.</span>
    <span class="n">sPhi</span> <span class="o">=</span> <span class="n">check_angle</span><span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">)</span>
      
    <span class="k">return</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sZ</span><span class="p">)</span>
  
<span class="k">def</span> <span class="nf">cylindrical_to_cartesian</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts 3D Cylindrical coordinates to Cartesian coordinates.&#39;&#39;&#39;</span>

    <span class="c1"># Interpret input</span>
    <span class="n">sR</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sPhi</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sZ</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Coordinate transform</span>
    <span class="n">sX</span> <span class="o">=</span> <span class="n">sR</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sPhi</span><span class="p">)</span>
    <span class="n">sY</span> <span class="o">=</span> <span class="n">sR</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sPhi</span><span class="p">)</span>
    <span class="n">sZ</span> <span class="o">=</span> <span class="n">sZ</span>
   
    <span class="k">return</span> <span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sZ</span><span class="p">)</span>
   
<span class="k">def</span> <span class="nf">spherical_to_cartesian</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts 3D Cartesian coordinates to Spherical coordinates.&#39;&#39;&#39;</span>

    <span class="c1"># Interpret inputs</span>
    <span class="n">sR</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sPhi</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sTheta</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
   
    <span class="c1"># Coordinate transform</span>
    <span class="n">sX</span> <span class="o">=</span> <span class="n">sR</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sTheta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sPhi</span><span class="p">)</span>
    <span class="n">sY</span> <span class="o">=</span> <span class="n">sR</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sTheta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sPhi</span><span class="p">)</span>
    <span class="n">sZ</span> <span class="o">=</span> <span class="n">sR</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sTheta</span><span class="p">)</span>
   
    <span class="k">return</span> <span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sZ</span><span class="p">)</span>
      
<span class="k">def</span> <span class="nf">cartesian_to_spherical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts 3D Spherical coordinates to Cartesian coordinates.&#39;&#39;&#39;</span>
    <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span> <span class="c1"># 3D Cartesian coordinate vector</span>
    <span class="c1"># Convert to spherical coordinates (r, phi, theta)</span>
    <span class="c1"># Interpret inputs</span>
    <span class="n">sX</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sY</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sZ</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
   
    <span class="c1"># Coordinate transform</span>
    <span class="n">sR</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sX</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sY</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sZ</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sPhi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">sY</span><span class="o">/</span><span class="n">sX</span><span class="p">)</span>
    <span class="n">sTheta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">sZ</span><span class="o">/</span><span class="n">sR</span><span class="p">)</span>
   
    <span class="c1"># Again, check that we have the right value of sPhi</span>
    <span class="c1"># for the quadrant we are in.</span>
    <span class="n">sPhi</span> <span class="o">=</span> <span class="n">check_angle</span><span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we’ll write a function to help us plot the coordinates for illustrative purposes. Don’t worry about this function for now.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_coordinates</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">xSystem</span><span class="o">=</span><span class="s2">&quot;Cart2D&quot;</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Plots 2D or 3D coordinates of a point on formatted axes with the </span>
<span class="sd">    option of showing the projection of the point onto the x-y-(z) axes.&#39;&#39;&#39;</span>
    <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="n">xlimits</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">ylimits</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cart2D&#39;</span><span class="p">):</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="c1"># Set the spines to go through the origin</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="c1"># turn off the right spine/ticks</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="c1"># turn off the top spine/ticks</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.475</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.475</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlimits</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylimits</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Polar&#39;</span><span class="p">):</span>
        <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">)</span> <span class="o">=</span> <span class="n">cartesian_to_polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="n">vCoordinate</span> <span class="o">=</span><span class="p">[</span><span class="n">sTheta</span><span class="p">,</span> <span class="n">sR</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;r = </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sR</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta = </span><span class="si">%.3f</span><span class="se">\n</span><span class="s2"> (radians)&quot;</span> <span class="o">%</span> <span class="n">sTheta</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        

    <span class="c1"># Plot the projections</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">projection</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cart2D&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Plot the point</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cylindrical&#39;</span> <span class="ow">or</span> <span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">],[</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
        
    <span class="c1"># Add a grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_vcoordinates</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">,</span> <span class="n">xSystem</span><span class="o">=</span><span class="s2">&quot;Cart2D&quot;</span><span class="p">,</span> 
                       <span class="n">xlimits</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span> <span class="n">ylimits</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Plots 2D or 3D coordinates of a point on formatted axes with the </span>
<span class="sd">    option of showing the projection of the point onto the x-y-(z) axes.&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cart2D&#39;</span><span class="p">):</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="c1"># Set the spines to go through the origin</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="c1"># turn off the right spine/ticks</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="c1"># turn off the top spine/ticks</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.475</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">0.475</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlimits</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylimits</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Polar&#39;</span><span class="p">):</span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cylindrical&#39;</span> <span class="ow">or</span> <span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">):</span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="p">[</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">vCoordinate</span>

    <span class="c1"># Plot the projections</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">projection</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cylindrical&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="n">sZ</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cart2D&#39;</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Plot the point</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cylindrical&#39;</span> <span class="ow">or</span> <span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">],[</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
        
    <span class="c1"># Add a grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_3Dcoordinates</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">xSystem</span><span class="o">=</span><span class="s2">&quot;Cart2D&quot;</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Plots 3D coordinates of a point on formatted axes with the </span>
<span class="sd">    option of showing the projection of the point onto the x-y-(z) axes.&#39;&#39;&#39;</span>
    <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span>
    <span class="n">xlimits</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">ylimits</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cylindrical&#39;</span><span class="p">):</span>
        <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sZ</span><span class="p">)</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plotting cylindrical coordinates R, Phi(radians) and Z:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sZ</span><span class="p">))</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Phi&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="p">[</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">vCoordinate</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">):</span>
        <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">)</span> <span class="o">=</span> <span class="n">cartesian_to_spherical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plotting spherical coordinates R, Phi(radians) and Theta(radians):&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">))</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Phi&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;Theta&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="p">[</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">vCoordinate</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">projection</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cylindrical&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="n">sZ</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">,</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">,</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;k:&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">],[</span><span class="mf">0.</span><span class="p">],</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1"># Plot the point</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Cylindrical&#39;</span> <span class="ow">or</span> <span class="n">xSystem</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sX</span><span class="p">],[</span><span class="n">sY</span><span class="p">],[</span><span class="n">sZ</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vCoordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
        
    <span class="c1"># Add a grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cartesian-coordinates">
<h2>Cartesian coordinates<a class="headerlink" href="#cartesian-coordinates" title="Permalink to this headline">¶</a></h2>
<p><strong>Lecture 1, slide 3</strong></p>
<p>Right, so let’s now utilise our functions to convert between different coordinate systems. Let’s start by defining a point in 2D Cartesian coordinates and plotting the point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># A Cartesian coordinate vector in the form (x, y).</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="c1"># %matplotlib widget</span>

<span class="c1"># Let&#39;s plot coordinates on the X-Y plane using the sliders.</span>
<span class="n">interactive_plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">plot_coordinates</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">interactive_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5a6d26f6755942adb8f683ed2c3bb273", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="cartesian-to-polar-conversion">
<h2>Cartesian to polar conversion<a class="headerlink" href="#cartesian-to-polar-conversion" title="Permalink to this headline">¶</a></h2>
<p><strong>Lecture 1, slide 4</strong></p>
<p>We can convert these coordinates to Polar coordinates using our function and plot on a Polar diagram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Cartesian to polar sliders</span>
<span class="c1"># Remember: theta will be in RADIANS</span>

<span class="c1">#Change the xSystems tab to &#39;Polar&#39; to see the 2D cartesian coordinates converted </span>
<span class="c1"># to Polar coordinates on a Polar diagram</span>

<span class="n">systems</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cart2D&#39;</span><span class="p">,</span> <span class="s1">&#39;Polar&#39;</span><span class="p">]</span>

<span class="n">interactive_plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">plot_coordinates</span><span class="p">,</span> <span class="n">xSystem</span><span class="o">=</span><span class="n">systems</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">interactive_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "84041f8c9141448996d27fa03d4e71ef", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>We can also convert the Polar coordinates back to Cartesian coordinates</p>
</div>
<div class="section" id="polar-to-cartesian-conversion">
<h2>Polar to cartesian conversion<a class="headerlink" href="#polar-to-cartesian-conversion" title="Permalink to this headline">¶</a></h2>
<p>Lecture 1, slide 4</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converting r = </span><span class="si">%.2f</span><span class="s2">, theta = </span><span class="si">%.2f</span><span class="s2"> back to Cartesian coordinates&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">))</span>
<span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">sR</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">]</span>
<span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">)</span> <span class="o">=</span> <span class="n">polar_to_cartesian</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sX</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sY</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Converting r = 6400.00, theta = 1.97 back to Cartesian coordinates
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="n">d2499be0faef</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converting r = </span><span class="si">%.2f</span><span class="s2">, theta = </span><span class="si">%.2f</span><span class="s2"> back to Cartesian coordinates&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">sR</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">)</span> <span class="o">=</span> <span class="n">polar_to_cartesian</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sX</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y = </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sY</span><span class="p">)</span>

<span class="nn">&lt;ipython-input-5-21f368f3cfca&gt;</span> in <span class="ni">polar_to_cartesian</span><span class="nt">(vCoordinate)</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">def</span> <span class="nf">polar_to_cartesian</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="sd">&#39;&#39;&#39;A function to convert 2D Polar coordinates to Cartesian coordinates.&#39;&#39;&#39;</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="c1"># Interpret input</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">sR</span> <span class="o">=</span> <span class="n">vCoordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;x&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cylindrical-and-spherical-coordinates">
<h2>Cylindrical and spherical coordinates<a class="headerlink" href="#cylindrical-and-spherical-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Lecture 1, slide 7</p>
<p>Lecture 1, slide 10</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Change the xSystems tab to &#39;Cylindrical&#39; and &#39;Spherical&#39; to see the </span>
<span class="c1"># 3D cartesian coordinates converted to Cylindrical and Spherical coordinates respectively</span>
<span class="n">systems</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cylindrical&#39;</span><span class="p">,</span><span class="s1">&#39;Spherical&#39;</span><span class="p">]</span>

<span class="n">interactive_plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">plot_3Dcoordinates</span><span class="p">,</span> <span class="n">xSystem</span><span class="o">=</span><span class="n">systems</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">interactive_plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "084a317bf6bc4fe68dded66c45354afd", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="spherical-to-cartesian">
<h2>Spherical to cartesian<a class="headerlink" href="#spherical-to-cartesian" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s define some spherical coordinates. . .</span>
<span class="n">sR</span> <span class="o">=</span> <span class="mf">6400.0</span>
<span class="c1"># Convert angles in degrees to radians</span>
<span class="n">sPhi</span> <span class="o">=</span> <span class="mf">316.8</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="n">sTheta</span> <span class="o">=</span> <span class="mf">112.9</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plotting spherical coordinates &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">),</span> <span class="s2">&quot; in 3D Cartesian space&quot;</span><span class="p">)</span>

<span class="c1"># Convert back to Cartesian for 3D plotting purposes</span>
<span class="n">vCoordinate</span> <span class="o">=</span> <span class="p">[</span><span class="n">sR</span><span class="p">,</span> <span class="n">sPhi</span><span class="p">,</span> <span class="n">sTheta</span><span class="p">]</span>
<span class="p">(</span><span class="n">sX</span><span class="p">,</span> <span class="n">sY</span><span class="p">,</span> <span class="n">sZ</span><span class="p">)</span> <span class="o">=</span> <span class="n">spherical_to_cartesian</span><span class="p">(</span><span class="n">vCoordinate</span><span class="p">)</span>

<span class="c1"># Plot the 3D Cartesian coordinates </span>
<span class="n">plot_vcoordinates</span><span class="p">([</span><span class="n">sX</span><span class="p">,</span><span class="n">sY</span><span class="p">,</span><span class="n">sZ</span><span class="p">],</span> <span class="n">xSystem</span> <span class="o">=</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#fig = pylab.figure()        </span>
<span class="c1">#axes = Axes3D(fig)</span>
<span class="c1">#axes.plot([0.],[0.],[0.],&#39;oy&#39;)</span>
<span class="c1">#axes.plot([sX],[sY],[sZ],&#39;or&#39;)</span>
<span class="c1">#axes.plot([0.,sX],[0.,sY],[0.,sZ],&#39;b-&#39;)</span>
<span class="c1">#axes.plot([0.,sX],[0.,sY],[0.,0.],&#39;k--&#39;)</span>
<span class="c1">#axes.plot([sX,sX],[sY,sY],[0.,sZ],&#39;k:&#39;)</span>
<span class="c1">#axes.plot([sX],[sY],[0.],&#39;ok&#39;)</span>
<span class="c1">#axes.set_xlabel(&quot;X&quot;)</span>
<span class="c1">#axes.set_ylabel(&quot;Y&quot;)</span>
<span class="c1">#axes.set_zlabel(&quot;Z&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Plotting spherical coordinates  (6400.0, 5.529203070318037, 1.9704767255015982)  in 3D Cartesian space
</pre></div>
</div>
<img alt="../../_images/Coordinate_Systems_25_1.png" src="../../_images/Coordinate_Systems_25_1.png" />
</div>
</div>
</div>
<div class="section" id="final-tip">
<h2>Final tip<a class="headerlink" href="#final-tip" title="Permalink to this headline">¶</a></h2>
<p>So what did I mean when I said we could write these functions much more efficiently?</p>
<p>Well, let’s try writing the first function again in as few lines as possible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cartesian_to_polar</span><span class="p">(</span><span class="n">vC</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts 2D Cartesian coordinates to Polar coordinates.&#39;&#39;&#39;</span>
          
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">vC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">vC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">check_angle</span><span class="p">(</span><span class="n">vC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vC</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">vC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">vC</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>It turns out we can write this function in just one line of code, because there was no need to rename the input vector components as scalars and we can write the transformation formulae (and the <code class="docutils literal notranslate"><span class="pre">check_angle</span></code> function in the return statement.</p>
</div>
<div class="section" id="notebook-extensions">
<h2>Notebook extensions<a class="headerlink" href="#notebook-extensions" title="Permalink to this headline">¶</a></h2>
<p>To improve this notebook you could add interactive plots for the conversions from polar, cylindrical and spherical coordinates back to cartesian coordinates.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "primer-computational-mathematics/book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./mathematics/math_methods_1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Mathematical methods 1</a>
    <a class='right-next' id="next-link" href="Eigenvalues.html" title="next page">Eigenvalues</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Imperial College London<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>