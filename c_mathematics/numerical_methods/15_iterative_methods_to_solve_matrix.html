
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Iterative methods to solve a matrix &#8212; ESE Jupyter Material</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".cell"
const thebe_selector_input = ".cell_input div.highlight"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Series and sequences" href="../series_and_sequences/intro.html" />
    <link rel="prev" title="Ill-conditioning and roundoff errors" href="14_ill_conditioning_errors.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ESE Jupyter Material</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Landing page
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../a_modules/intro.html">
   Modules
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/math_methods_1/intro.html">
     Mathematical methods 1
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/1_Coordinate_Systems.html">
       Coordinate systems (Lecture 1)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/2_Vectors.html">
       Vectors (Lecture 1)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/3_Multivariable_Calculus.html">
       Multivariable calculus (Lecture 2)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/4_Vector_Calculus.html">
       Vector calculus (Lecture 3)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/5_Matrices.html">
       Matrices (Lecture 4)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/6_Eigenvalues.html">
       Eigenvalues (Lecture 5)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/7_Series.html">
       Series (Lecture 6)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/8_ODEs.html">
       ODEs (Lecture 7)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/9_Modelling.html">
       Modelling (Lecture 8)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/mechanics/intro.html">
     Mechanics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/1_Motion_in_1D.html">
       Motion in 1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/2_Motion_in_2D.html">
       Motion in 2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/3_Work_and_Energy.html">
       Work and Energy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/4_Rotational_Motion.html">
       Rotational Motion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/5_Gravity.html">
       Gravity
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/seismology/intro.html">
     Seismology
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/CMP_Common_Mid_Point_Gather.html">
       Common Mid-point Gather
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Ghosting.html">
       Ghosting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Spatial_aliasing.html">
       Spatial Aliasing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Temporal_aliasing.html">
       Temporal Aliasing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/tectonics_of_the_ocean/intro.html">
     Techtonics of the ocean
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/tectonics_of_the_ocean/Latitude_Longitude_and_Degree_Notation.html">
       Reading Maps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/tectonics_of_the_ocean/Plate_Models.html">
       Heat Flow
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../b_coding/intro.html">
   Coding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../b_coding/NumPy_Arrays.html">
     NumPy arrays
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/intro.html">
     Fundamentals of Computer Science
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/1_Algorythmic_Complexity.html">
       Algorithmic complexity
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/2_Recursion.html">
       Recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/3_Divide_and_Conquer.html">
       Divide and Conquer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/4_Dynamic_Programming.html">
       Dynamic Programming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/5_Greedy_Algorithms.html">
       Greedy Algorithms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/6_Data_Structures.html">
       Data Structures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/7_Graph_Algorithms.html">
       Graph Algorithms
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Intro%20to%20Python/intro.html">
     Intro to Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/1_Printing_and_formatting_statements.html">
       Printing and formatting statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/2_Variables.html">
       Variables
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/3_If_statement.html">
       If statement
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/4_While_loops.html">
       While loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/5_Lists.html">
       Lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/6_For_loops.html">
       For loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/7_List_comprehensions.html">
       List comprehensions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/8_Nested_lists.html">
       Nested lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/9_Handling_errors.html">
       Handling errors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/10_Importing.html">
       Importing in Python
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/11_Functions.html">
       Creating custom functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/12_Tuples.html">
       Tuples
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/13_File_handling.html">
       File handling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/14_Dictionaries.html">
       Dictionaries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/15_Flow_control_statements.html">
       Flow control statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/16_Sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/17_Matplotlib.html">
       Plotting data with Matplotlib
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/18_Assert.html">
       Assert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/19_Classes.html">
       Python classes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/20_Lambdas.html">
       Lambdas
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Pandas/intro.html">
     Pandas
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/1_basics.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/2_filter_select_assign.html">
       Filtering, selecting and assigning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/3_merge_combine_group_sort.html">
       Merging, combining, grouping and sorting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/4_summary_statistics.html">
       Summary statistics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/5_time_stamps.html">
       Creating date-time stamps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/6_plotting.html">
       Plotting
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Programming%20Tools/intro.html">
     Programming tools
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Programming%20Tools/1_Version_Control_Git.html">
       Version control Git
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro.html">
   Mathematics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../calculus/intro.html">
     Calculus
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../calculus/Vector_calculus.html">
       Vector calculus
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../complex_analysis/intro.html">
     Complex analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/1_introduction.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/2_complex_plane.html">
       Complex plane
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/3_complex_functions.html">
       Complex functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/4_holomorphic_functions.html">
       Holomorphic functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/5_integrating.html">
       Complex integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/6_fractals.html">
       Fractals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../differential_equations/intro.html">
     Differential equations
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/1_de_introduction.html">
       Introduction to differential equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/2_linear_des.html">
       Linear Differential Equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/3_first-order_odes.html">
       First-order ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/4_higher_ord_lin_odes.html">
       Higher order Linear ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/5_ode_series.html">
       Series ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/6_pde_basicdefinitions.html">
       Introductory definitions and concepts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/7_pde_first_order.html">
       First-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/8_pde_second_order.html">
       Canonical form of second-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/9_poisson_laplace_eq.html">
       Poisson’s and Laplace’s equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/10_heat_eq.html">
       Heat (diffusion) equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/11_pde_fourier.html">
       Solving PDEs with fourier methods
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/12_wave_eq.html">
       Wave equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/13_similarity_solutions.html">
       Self-similar solutions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../linear_algebra/intro.html">
     Linear algebra
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/1_Basic_definitions_and_operations.html">
       Basic definitions and operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/2_Linear_Systems.html">
       Systems of linear equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/3_Theory.html">
       Theory
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/4_Eigenvalues_and_eigenvectors.html">
       Eigenvalues and eigenvectors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/5_Linear_Algebra_in_Python.html">
       Linear Algebra in Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../mathematical_notation/intro.html">
     Mathematical notation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../mathematical_notation/Big_O_notation.html">
       Big O notation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../mathematical_notation/Tensors_Review.html">
       Review of tensors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="intro.html">
     Numerical methods
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="1_Interpolation_curve_fitting.html">
       Interpolation and curve fitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="2_Numerical_differentiation.html">
       Numerical differentiation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="3_Timestepping_an_ODE.html">
       Solving or timestepping an ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="4_Heuns_method.html">
       Heun’s method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="5_Runge_Kutta_method.html">
       Runge-Kutta method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="6_Solving_PDEs_SOR.html">
       Successive over-relaxation method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="7_FTCS.html">
       FTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="8_BTCS.html">
       BTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="9_Numerical_integration.html">
       Numerical integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="10_Roots_of_equations.html">
       Roots of equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="11_linear_algebra_intro.html">
       Linear algebra introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="12_Gaussian_elimination.html">
       Gaussian elimination
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="13_LU_decomposition.html">
       LU decomposition
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="14_ill_conditioning_errors.html">
       Ill-conditioning and roundoff errors
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Iterative methods to solve a matrix
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../series_and_sequences/intro.html">
     Series and sequences
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Fourier_series.html">
       Fourier series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Fourier_transforms.html">
       Fourier transforms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Taylor_series.html">
       Taylor series
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../sets_and_functions/intro.html">
     Sets and functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/1_logic.html">
       Logic and proof
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/2_sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/3_functions.html">
       Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/4_elementary_functions_1.html">
       Elementary functions 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/5_elementary_functions_2.html">
       Elementary functions 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/6_composition_and_inverse.html">
       Composition and Inverse Functions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../statistics/intro.html">
     Statistics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../statistics/Linear_Regression.html">
       Linear regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../statistics/Statistics_for_Geoscientists.html">
       Introduction to statistics for Geoscientists
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../d_geosciences/intro.html">
   Geosciences
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/1D_Heat_Conduction.html">
     1D heat conduction (layered medium)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/1D_Resistivity_Forward_Modelling.html">
     1D resistivity forward modelling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/3D_Earthquake_Focus_Plot.html">
     Plotting Earthquake Focus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Climate_Model.html">
     Climate model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Dynamic_Earth.html">
     Seafloor ages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Keplerian_Orbits.html">
     Keplerian orbits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Longitude_Latitude_Degree_Convertion.html">
     Reading Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Milankovitch_cycles.html">
     Milankovitch cycles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Seismology.html">
     Downloading earthquake data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Tides.html">
     Tides
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Wave_dispersion.html">
     Wave dispersion
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Electromagnetism/intro.html">
     Electromagnetism
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/1_electricity_magnetism.html">
       Electricity and magnetism
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/2_maxwell_eqs.html">
       Maxwell’s equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/3_four_field.html">
       The four-field formalism
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/intro.html">
     Fluid dynamics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture5_1D_Pipe_Flow.html">
       Lecture5_1D_Pipe_Flow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture6_Non_Linear_Viscosity_2D_Stokes.html">
       Lecture6_Non_Linear_Viscosity_2D_Stokes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture7_Pipe_Flow_with_Heat.html">
       Lecture7_Pipe_Flow_with_Heat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture8_Part1_Navier_Stoke_Equation.html">
       Lecture8_Part1_Navier_Stoke_Equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture8_Part2_SPH_Algorithm_For_Energy_Equation.html">
       Lecture8_Part2_SPH_Algorithm_For_Energy_Equation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/remote_sensing/intro.html">
     Remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/remote_sensing/Image_Filtering.html">
       Image filtering
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/remote_sensing/Image_Point_Operations.html">
       Image point operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/remote_sensing/Image_Transformations_and_Orthorectification.html">
       Image transformations and orthorectification
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../e_extra/intro.html">
   Further resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
  <label for="toctree-checkbox-25">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Camera_Calibration.html">
     Camera calibration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Cartography_Cartopy.html">
     Cartopy (maps)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Dakota.html">
     Dakota
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Foundations.html">
     Google Earth Engine foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Getting_Started_.html">
     Google Earth Engine getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Particle_Image_Velocimetry.html">
     Particle image velocimetry (PIV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/contributors_guide.html">
     Contributor’s guide
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../e_extra/UAV_Mapping/intro.html">
     UAV Mapping
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
    <label for="toctree-checkbox-26">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/UAV_Mapping/1.Mission_Planning.html">
       1. Mission Planning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/intro.html">
     Machine learning
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
    <label for="toctree-checkbox-27">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%200%20--%20Introduction.html">
       Chapter 0 – Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%201%20--%20Neural%20Network.html">
       Chapter 1 – Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%202%20--%20Maximum%20Likelihood.html">
       Chapter 2 – Maximum Likelihood
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%203%20--%20Cross%20Entropy.html">
       Chapter 3 – Cross Entropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%204%20--%20Cost%20Function.html">
       Chapter 4 – Cost Function
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%205%20--%20Gradient%20Descent%201.html">
       Chapter 5 – Gradient Descent 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%206%20--%20Gradient%20Descent%202.html">
       Chapter 6 – Gradient Descent 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%207%20--%20Real%20%28Non-linear%29%20Neural%20Network.html">
       Chapter 7 – Real (Non-linear) Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%208%20--%20Feedforward.html">
       Chapter 8 – Feedforward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%209%20--%20Back%20Propagation.html">
       Chapter 9 – Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2010%20--%20General%20Back%20Propagation.html">
       Chapter 10 – General Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2011%20--%20Underfitting%20and%20Overfitting.html">
       Chapter 11 – Underfitting and Overfitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2012%20--%20Early-stopping%2C%20Dropout%20%26%20Mini-batch.html">
       Chapter 12 – Early-stopping, Dropout &amp; Mini-batch
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2013%20--%20Vanishing%20Gradient%201.html">
       Chapter 13 – Vanishing Gradient 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2014%20--%20Vanishing%20Gradient%202.html">
       Chapter 14 – Vanishing Gradient 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2015%20--%20Regularisation.html">
       Chapter 15 – Regularisation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2016%20--%20Other%20Activation%20Functions.html">
       Chapter 16 – Other Activation Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2017%20--%20Local%20Minima%20Trap.html">
       Chapter 17 – Local Minima Trap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2018%20--%20Softmax.html">
       Chapter 18 – Softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2019%20--%20Hyper-Parameters.html">
       Chapter 19 – Hyper-Parameters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2020%20--%20Coding%20Example.html">
       Chapter 20 – Coding Example
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/primer-computational-mathematics/book/master?urlpath=tree/notebooks/c_mathematics/numerical_methods/15_iterative_methods_to_solve_matrix.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/primer-computational-mathematics/book/issues/new?title=Issue%20on%20page%20%2Fc_mathematics/numerical_methods/15_iterative_methods_to_solve_matrix.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/c_mathematics/numerical_methods/15_iterative_methods_to_solve_matrix.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#jacobi-s-method">
   Jacobi’s method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gauss-seidel-s-method">
   Gauss-Seidel’s method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sparse-matrices">
   Sparse matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Iterative methods to solve a matrix</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#jacobi-s-method">
   Jacobi’s method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gauss-seidel-s-method">
   Gauss-Seidel’s method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sparse-matrices">
   Sparse matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="iterative-methods-to-solve-a-matrix">
<span id="nm-iterative-methods-matrix"></span><h1>Iterative methods to solve a matrix<a class="headerlink" href="#iterative-methods-to-solve-a-matrix" title="Permalink to this headline">#</a></h1>
<p><a class="reference internal" href="../../a_modules/intro.html#module-nm"><span class="std std-ref"><!-- module-nm badge --><span class="module module-nm">Numerical Methods</span></span></a></p>
<p id="index-0">Two types/families of methods exist to solve matrix systems. These are termed <strong>direct</strong> methods and <strong>iterative</strong> (or <strong>indirect</strong>) methods.</p>
<p>Direct methods perform operations on the linear equations (the matrix system), e.g. the substitution of one equation (e.g. Gaussian elimination). This transformed the equations making up the linear system into equivalent ones with the aim of eliminating unknowns from some of the equations and hence allowing for easy solution through back (or forward) substitution.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Cramer%27s_rule">Cramer’s rule</a> gives an explicit formula for the inverse of a matrix, or for the solution of a linear matrix system. The computational cost of this method (in terms of arithmetic operations required; also termed complexity) scales with \((n+1)!\), whereas the Gaussian elimination method (which is basically the substitution method) scales with \(n^3\). For large \(n\) Gaussian elimination will clearly be more efficient. \(n\) here refers to the number of unknowns or equations, or sometimes termed the degrees of freedom of the problem.</p>
<p>An advantage of direct methods is that they provide the exact solution (assuming exact arithmetic, i.e. ignoring the round off related issues) in a finite number of operations. However, as pointed out previously, \(n\) could be billions for hard-core applications such as in numerical weather forecasting. In this case the \(n^3\) operations required of a direct algorithm such as Gaussian elimination is completely prohibitive. In an attempt to further reduce this cost <strong>iterative algorithms</strong> were devised.</p>
<p>These algorithms start with an initial guess at the solution (\(\pmb{x}_0\)), and iteratively improve this producing a series of approximate answers \(\pmb{x}_k\). For the exact answer to the matrix system \(A\pmb{x} = \pmb{b}\), we know that the residual vector \(\pmb{r} = A\pmb{x}-\pmb{b}\) is zero. For our iterative procedure, we can use the norm of the residual vector \(\pmb{r}_k = A\pmb{x}_k-\pmb{b}\) based on the approximate solution \(\pmb{x}_k\), as a measure of how close we are to solving the equation (the norm \(||\pmb{r}_k||\) expresses this as a single number). As we iterate further, we hope to drive down this number and we may stop the iterations at some small (non-zero) residual norm tolerance level. The final iteration gives us an answer \(\pmb{x}_k\) which is still an approximation to the solution and not the exact solution we would obtain with direct methods. The residual norm tolerance stopping criteria therefore needs to be thought about carefully, e.g. depending on how accurate a solution \(\pmb{x}\) we require.</p>
<p>Since well through iterative methods, \(\pmb{x}_k\) is still very much an approximation rather than an exact answer, you could imagine why weather forecasting, which uses iterative methods, is still very much an approximation rather than an exact answer. However, our current exact methods are prohibitively expensive in terms of time taken, so iterative method is the best we have. You could imagine why weather forecasting is very strict on time. For large agricultural farms which use remote sensing for weather monitoring and forecast, it would be useless to tell them the exact solution to a storm a long time after the storm has passed and devastated the crop production because you tried to solve the equations involved exactly, and from the time the storm was on the horizon it took you such a long time to find the exact solution, assuming that such an exact solution even exist in the 1st place. Our most powerful supercomputers are needed for weather forecasting even if we used iterative methods.</p>
<p>We have already considered Gaussian elimination (and back substitution) as examples of direct solution methods. We’ll consider an example of an iterative method now.</p>
<section id="jacobi-s-method">
<h2>Jacobi’s method<a class="headerlink" href="#jacobi-s-method" title="Permalink to this headline">#</a></h2>
<p id="index-1">Consider a matrix system</p>
<p>\[A\pmb{x}=\pmb{b} \quad \iff \quad \sum_{j=1}^nA_{ij}x_j=b_i,\quad \textrm{for}\quad i=1,2,\ldots, n.\]</p>
<p>Let’s rewrite this by pulling out the term involving \(x_i\) (i.e. for each row \(i\) pull out the diagonal from the summation):</p>
<p>\[A_{ii}x_i + \sum_{\substack{j=1\ j\ne i}}^nA_{ij}x_j=b_i,\quad  i=1,2,\ldots, n.\]</p>
<p>We can then come up with a formula for our unknown \(x_i\):</p>
<p>\[x_i = \frac{1}{A_{ii}}\left(b_i- \sum_{\substack{j=1\ j\ne i}}^nA_{ij}x_j\right),\quad  i=1,2,\ldots, n.\]</p>
<p>For each individual \(x_i\), all the other components of \(\pmb{x}\) appearing on the RHS are also unknown and so this is an example of an implicit formula which doesn’t help us directly, but does suggest the following iterative scheme:</p>
<ul class="simple">
<li><p>starting from a guess at the solution \(\pmb{x}^{(0)}\)</p></li>
<li><p>iterate for \(k&gt;0\)
\[x_i^{(k)} = \frac{1}{A_{ii}}\left(b_i- \sum_{\substack{j=1\ j\ne i}}^nA_{ij}x_j^{(k-1)}\right),\quad  i=1,2,\ldots, n.\]</p></li>
</ul>
<p>For this iteration, for a fixed \(k\), it does not matter in which order we perform the operations over \(i\) as the right hand side only contains the entries of \(\pmb{x}\) at the previous iteration.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">sl</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">5.</span> <span class="p">,</span><span class="mf">4.</span> <span class="p">,</span><span class="mf">3.</span> <span class="p">,</span><span class="mf">11.</span> <span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>

<span class="c1"># An initial guess at the solution</span>
<span class="c1"># just a vector of zeros of length the number of rows in A</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 

<span class="c1"># Iteration tolerance</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1.e-6</span>

<span class="c1"># Upper limit on iterations if we don&#39;t hit tolerance</span>
<span class="n">it_max</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Store residuals</span>
<span class="n">residuals</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">it_max</span><span class="p">):</span>
    
    <span class="c1"># Initialise the new solution vector</span>
    <span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">x_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> 
                                   <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]))</span>

    <span class="c1"># Calculate the norm of the residual r=Ax-b for this latest guess</span>
    <span class="n">residual</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> 
    
    <span class="c1"># Store it for later plotting</span>
    <span class="n">residuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residual</span><span class="p">)</span>
    
    <span class="c1"># If less than our required tolerance</span>
    <span class="c1"># jump out of the iteration and end.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">residual</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>
        <span class="k">break</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x_new</span> <span class="c1"># update old solution</span>

<span class="c1"># Plot the log of the residual</span>
<span class="c1"># against iteration number </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># Plot the log of the residual</span>
<span class="c1"># against iteration number </span>
<span class="n">ax1</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residual&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convergence plot&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Our solution =&quot;</span><span class="p">,</span> <span class="n">x_new</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SciPy solution =&quot;</span><span class="p">,</span> <span class="n">sl</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/15_iterative_methods_to_solve_matrix_1_0.png" src="../../_images/15_iterative_methods_to_solve_matrix_1_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Our solution = [-0.16340811 -0.01532703  0.27335262  0.36893551]
SciPy solution = [-0.16340816 -0.01532706  0.27335264  0.36893555]
</pre></div>
</div>
</div>
</div>
</section>
<section id="gauss-seidel-s-method">
<h2>Gauss-Seidel’s method<a class="headerlink" href="#gauss-seidel-s-method" title="Permalink to this headline">#</a></h2>
<p id="index-2">We can make a small improvement to Jacobi’s method using the updated components of the solution vector as soon as they become available:</p>
<ul class="simple">
<li><p>starting from a guess at the solution \(\pmb{x}^{(0)}\)</p></li>
<li><p>iterate for \(k&gt;0\)
\[x_i^{(k)} = \frac{1}{A_{ii}}\left(b_i- \sum_{\substack{j=1\ j&lt; i}}^nA_{ij}x_j^{(k)} - \sum_{\substack{j=1\ j&gt; i}}^nA_{ij}x_j^{(k-1)}\right),\quad  i=1,2,\ldots, n.\]</p></li>
</ul>
<p>As opposed to Jacobi, we can overwrite the entries of \(\pmb{x}\) as they are updated, with Jacobi we need to store both the new as well as the old iteration (i.e. not overwrite the old entries until we have finished with them - which was not until the end of every iteration).</p>
<p>As we are using updated knowledge immediately, the <a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Seidel_method">Gauss-Seidel algorithm</a> should converge faster than Jacobi, but note that this convergence can only be guaranteed for matrices which are diagonally dominant (for every row, the magnitude of value on the main diagonal is greater than the sum of the magnitudes of all the other entries in that row), or if the matrix is symmetric positive definite.</p>
<p>We will generelise the Jacobi code to solve the matrix problem using Gauss-Seidel’s method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gauss_seidel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">maxit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.e-6</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxit</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> 
                                   <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]))</span> 
        <span class="n">residual</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="nd">@x</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">residuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residual</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">residual</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span> <span class="k">break</span>
        
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">residuals</span>

<span class="k">def</span> <span class="nf">jacobi</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">maxit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.e-6</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxit</span><span class="p">):</span>
        <span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">x_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> 
                                   <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_new</span> <span class="c1"># update old solution </span>
        <span class="n">residual</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="nd">@x</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">residuals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residual</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">residual</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span> <span class="k">break</span>       
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">residuals</span>
</pre></div>
</div>
</div>
</div>
<p>Check the algorithm:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
                 <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">5.</span> <span class="p">,</span><span class="mf">4.</span> <span class="p">,</span><span class="mf">3.</span> <span class="p">,</span><span class="mf">11.</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>

<span class="c1"># Check gauss_seidel solution</span>
<span class="c1"># agrees with multiplying through by the inverse matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Is our algorithm working?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="nd">@b</span><span class="p">,</span> <span class="n">gauss_seidel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Is our algorithm working? True
</pre></div>
</div>
</div>
</div>
<p>Now, we can plot convergence for both methods:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
                 <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">16.</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">5.</span> <span class="p">,</span><span class="mf">4.</span> <span class="p">,</span><span class="mf">3.</span> <span class="p">,</span><span class="mf">11.</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>

<span class="c1"># an initial guess at the solution</span>
<span class="c1"># here just a vector of zeros of length the number of rows in A</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 

<span class="n">tol</span> <span class="o">=</span> <span class="mf">1.e-6</span> <span class="c1"># iteration tolerance</span>
<span class="n">it_max</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># upper limit on iterations if we don&#39;t hit tolerance</span>

<span class="n">x_j</span><span class="p">,</span> <span class="n">res_j</span> <span class="o">=</span> <span class="n">jacobi</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">x_gs</span><span class="p">,</span> <span class="n">res_gs</span> <span class="o">=</span> <span class="n">gauss_seidel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># Plot the log of the residual against iteration number </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># Plot the log of the residual against iteration number </span>
<span class="n">ax1</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">res_j</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Jacobi&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">res_gs</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gauss-Seidel&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residual&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convergence plot&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/15_iterative_methods_to_solve_matrix_7_0.png" src="../../_images/15_iterative_methods_to_solve_matrix_7_0.png" />
</div>
</div>
</section>
<section id="sparse-matrices">
<span id="nm-sparse-matrices"></span><h2>Sparse matrices<a class="headerlink" href="#sparse-matrices" title="Permalink to this headline">#</a></h2>
<p id="index-3">Matrices which result from the numerical solution of differential equations are generally <a class="reference external" href="https://en.wikipedia.org/wiki/Sparse_matrix"><strong>sparse</strong></a> which means that most entries are zero (the alternative is termed <strong>dense</strong>).  Knowing which entries are zero means that we can devise more efficient matrix storage methods, as well as more efficient implementations of the above algorithms (e.g. by not bothering to do operations that we know involve multiplications by zero - we know the answer will be zero).</p>
<p>As an example, for the two iterative methods shown above (Jacobi and Gauss-Seidel), the cost of each iteration is quadratically dependent on the number of unknowns \(n\), since we need to loop through all the entries of the \(n\times n\) matrix \(A\). For a fixed number of iterations the computational cost of these methods therefore scales as \(n^2\). If we know that each row only contains a fixed, small number of non-zero entries however, we can simply skip the zero entries and the cost per iteration becomes linear in \(n\). These scalings of \(n^2\) for dense and \(n\) for sparse matrices for the cost per iteration are typical for iterative methods. Unfortunately this does not mean that the overall cost of an iterative method is also \(n^2\) or \(n\), as the number of iterations that is needed to achieve a certain accuracy quite often also increases for larger problem sizes. The number of required iterations typically only increases very slowly however, so that the cost of the method is still considerably cheaper than direct methods, in particular for very large problems.</p>
<p>A huge range of iterative solution methods exist and the literature on this topic is massive. Below is an example of using SciPy to access the <a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method">conjugate gradient algorithm</a> which is a popular example of a method suitable for matrices which result from the numerical solution of differential equations.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.sparse.linalg</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Just a vector of ones</span>
<span class="n">main_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># To make it a bit more interesting</span>
<span class="c1"># make the off-diagonals random</span>
<span class="n">off_diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">main_diag</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">off_diag</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">off_diag</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># A random RHS vector</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Print our A in &quot;dense&quot; matrix format</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># The same matrix in a &quot;sparse&quot; matrix</span>
<span class="c1"># data structure where only non-zeros stored</span>
<span class="n">sA</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This is the same matrix but now stored in a sparse matrix data structure.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sA</span><span class="p">)</span>

<span class="c1"># Now use a scipy iterative algorithm (Conjugate Gradient) to solve</span>
<span class="c1"># First define a (callback) function which we are allowed to pass to the solver</span>
<span class="c1"># here this is coded such that it will store and print the iteration numbers</span>
<span class="c1"># and residuals - basically a method to output some diagnostic</span>
<span class="c1"># information on the solver as it executes</span>
<span class="k">def</span> <span class="nf">gen_callback_cg</span><span class="p">():</span>
    <span class="n">diagnostics</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">it</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="p">[])</span> 
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">xk</span><span class="p">):</span>   <span class="c1"># xk is the solution computed by CG at each iteration</span>
        <span class="n">diagnostics</span><span class="p">[</span><span class="s2">&quot;it&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">diagnostics</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">xk</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">diagnostics</span><span class="p">[</span><span class="s2">&quot;it&quot;</span><span class="p">],</span> <span class="n">sl</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">xk</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">callback</span>    

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Execute the CG algorithm with:&#39;</span><span class="p">)</span>
<span class="n">x_sol</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cg</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">x0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">gen_callback_cg</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-2.          0.63693799  0.         ...  0.          0.
   0.        ]
 [ 0.63693799 -2.          0.54560525 ...  0.          0.
   0.        ]
 [ 0.          0.54560525 -2.         ...  0.          0.
   0.        ]
 ...
 [ 0.          0.          0.         ... -2.          0.56842649
   0.        ]
 [ 0.          0.          0.         ...  0.56842649 -2.
   0.53907618]
 [ 0.          0.          0.         ...  0.          0.53907618
  -2.        ]]
This is the same matrix but now stored in a sparse matrix data structure.
  (0, 0)	-2.0
  (0, 1)	0.6369379874213537
  (1, 0)	0.6369379874213537
  (1, 1)	-2.0
  (1, 2)	0.5456052511306624
  (2, 1)	0.5456052511306624
  (2, 2)	-2.0
  (2, 3)	0.970464569174672
  (3, 2)	0.970464569174672
  (3, 3)	-2.0
  (3, 4)	0.35765701903000946
  (4, 3)	0.35765701903000946
  (4, 4)	-2.0
  (4, 5)	0.07860832073703727
  (5, 4)	0.07860832073703727
  (5, 5)	-2.0
  (5, 6)	0.3857377666372107
  (6, 5)	0.3857377666372107
  (6, 6)	-2.0
  (6, 7)	0.01413073345489535
  (7, 6)	0.01413073345489535
  (7, 7)	-2.0
  (7, 8)	0.19319497793638785
  (8, 7)	0.19319497793638785
  (8, 8)	-2.0
  :	:
  (41, 41)	-2.0
  (41, 42)	0.5978774245111921
  (42, 41)	0.5978774245111921
  (42, 42)	-2.0
  (42, 43)	0.5364153930379388
  (43, 42)	0.5364153930379388
  (43, 43)	-2.0
  (43, 44)	0.8850205063670634
  (44, 43)	0.8850205063670634
  (44, 44)	-2.0
  (44, 45)	0.5886471808711005
  (45, 44)	0.5886471808711005
  (45, 45)	-2.0
  (45, 46)	0.14115466547922895
  (46, 45)	0.14115466547922895
  (46, 46)	-2.0
  (46, 47)	0.7418366933859565
  (47, 46)	0.7418366933859565
  (47, 47)	-2.0
  (47, 48)	0.5684264855197085
  (48, 47)	0.5684264855197085
  (48, 48)	-2.0
  (48, 49)	0.5390761814966529
  (49, 48)	0.5390761814966529
  (49, 49)	-2.0
Execute the CG algorithm with:
1 2.1446643589548575
2 1.070394492386954
3 0.5270408998541989
4 0.26468789893087064
5 0.1150793812511437
6 0.048339130346893515
7 0.015170369679322069
8 0.0049590338020348585
9 0.0019015453866031366
10 0.0006015353754676559
11 0.00015613057602840554
12 4.984341427366033e-05
13 1.89056660627782e-05
14 5.268717944123653e-06
15 2.1699221761019266e-06
16 7.376293575240594e-07
17 2.7570379894507307e-07
18 7.962798313839378e-08
19 2.6775365292152457e-08
20 8.620130253695909e-09
21 2.3822127324450435e-09
22 7.590095683106053e-10
23 1.5049403130876243e-10
</pre></div>
</div>
</div>
</div>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h3>
<p>Let us consider an electric circuit arranged in a regular grid of \(n\) rows and \(m\) columns. The nodes in the grid are numbered from 0 to \(nm-1\) as indicated in the diagram below.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../../_images/circuit.png"><img alt="../../_images/circuit.png" src="../../_images/circuit.png" style="width: 300px;" /></a>
</figure>
<p>We want to calculate the electric potential \(V_i\) in all of the nodes \(i\). A node \(i\) somewhere in the middle of the circuit is connected via resistor to nodes \(i-1\) and \(i+1\) to the left and right respectively, and to the nodes \(i-m\) and \(i+m\) in the rows above and below. For simplicity we assume that all resistors have the same resistance value \(R\). The first and last node of the circuit (0 and \(nm-1\)) to a battery via two additional resistors, with the same resistance value \(R\).</p>
<p>The sum of the currents coming into a node is zero (if we use a sign convention where a current coming into a node is positive and a current going out is negative. The currents between two nodes can be calculated using Ohm’s law: \(I=V/R\) where \(R\) is the resistance of the resistor, and \(V\) is the potential difference between two nodes, say \(V=V_i-V_{i-1}\). Therefore we can write:</p>
<p>\[
\begin{eqnarray}
0 &amp;=&amp; I_{i-1\to i} + I_{i+1\to i} + I_{i-m\to i} + I_{i+m\to i} \\
&amp;=&amp; V_{i-1\to i}/R + V_{i+1\to i}/R + V_{i-m\to i}/R + V_{i+m\to i}/R \\
&amp;=&amp; (V_{i}-V_{i-1})/R + (V_{i}-V_{i+1})/R + (V_{i}-V_{i-m})/R + (V_{i}-V_{i+m})/R \\
&amp;=&amp; (4V_{i}-V_{i-1}-V_{i+1}-V_{i-m}-V_{i+m})/R
\end{eqnarray}
\]</p>
<p>This gives us one linear equation for each node in the circuit (with slight modifications for nodes that are not in the interior). These can be combined into a linear system \(Ax=b\)  which is assembled in the code below:</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>             <span class="c1"># Number of rows</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>             <span class="c1"># Mumber of columns</span>
<span class="n">V_battery</span> <span class="o">=</span> <span class="mf">5.0</span>   <span class="c1"># Voltage on the right of the battery</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="p">))</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">row</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">column</span>   <span class="c1"># Node number</span>
        <span class="k">if</span> <span class="n">column</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>         <span class="c1"># Left neighbour</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">column</span><span class="o">&lt;</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>       <span class="c1"># Right neighbour</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>            <span class="c1"># Neighbour above</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="n">m</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">&lt;</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>          <span class="c1"># Neighbour below</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">m</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>

<span class="c1"># Connecting node 0 to the battery: </span>
<span class="c1"># I = (V_0 - 0)/R</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span> 

<span class="c1"># Connecting last node nm-1 to the battery:</span>
<span class="c1"># I = (V_0 - V_battery)/R = V_0/R - V_battery/R</span>
<span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>

<span class="c1"># The V_battery/R term is a constant that</span>
<span class="c1"># does not depend on the unknowns, so ends up in the rhs vector b</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">b</span><span class="p">[</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_battery</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 3. -1.  0. -1.  0.  0.  0.  0.  0.  0.  0.  0.]
 [-1.  3. -1.  0. -1.  0.  0.  0.  0.  0.  0.  0.]
 [ 0. -1.  2.  0.  0. -1.  0.  0.  0.  0.  0.  0.]
 [-1.  0.  0.  3. -1.  0. -1.  0.  0.  0.  0.  0.]
 [ 0. -1.  0. -1.  4. -1.  0. -1.  0.  0.  0.  0.]
 [ 0.  0. -1.  0. -1.  3.  0.  0. -1.  0.  0.  0.]
 [ 0.  0.  0. -1.  0.  0.  3. -1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0. -1.  0. -1.  4. -1.  0. -1.  0.]
 [ 0.  0.  0.  0.  0. -1.  0. -1.  3.  0.  0. -1.]
 [ 0.  0.  0.  0.  0.  0. -1.  0.  0.  2. -1.  0.]
 [ 0.  0.  0.  0.  0.  0.  0. -1.  0. -1.  3. -1.]
 [ 0.  0.  0.  0.  0.  0.  0.  0. -1.  0. -1.  3.]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "primer-computational-mathematics/book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./c_mathematics/numerical_methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="14_ill_conditioning_errors.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ill-conditioning and roundoff errors</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../series_and_sequences/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Series and sequences</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Imperial College London<br/>
  
      &copy; Copyright 2020.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>