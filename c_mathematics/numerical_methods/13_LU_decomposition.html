
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>LU decomposition &#8212; ESE Jupyter Material</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".cell"
const thebe_selector_input = ".cell_input div.highlight"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Ill-conditioning and roundoff errors" href="14_ill_conditioning_errors.html" />
    <link rel="prev" title="Gaussian elimination" href="12_Gaussian_elimination.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ESE Jupyter Material</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Landing page
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../a_modules/intro.html">
   Modules
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/continental_tectonics/intro.html">
     Continental Tectonics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Euler_Pole.html">
       Euler Pole
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Isostasy.html">
       Isostasy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Lithospheric_Strength.html">
       Lithospheric Strength
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Ridge_Push_and_Slab_Pull.html">
       Ridge Push and Slab Pull
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/math_methods_1/intro.html">
     Mathematical methods 1
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/1_Coordinate_Systems.html">
       Coordinate systems
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/2_Vectors.html">
       Vectors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/3_Multivariable_Calculus.html">
       Multivariable calculus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/4_Vector_Calculus.html">
       Vector calculus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/5_Matrices.html">
       Matrices
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/6_Eigenvalues.html">
       Eigenvalues
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/7_Series.html">
       Series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/8_ODEs.html">
       ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/9_Modelling.html">
       Modelling
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/mathematical_methods_2/intro.html">
     Mathematical Methods 2
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mathematical_methods_2/1_complex_numbers.html">
       Complex Numbers
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/mechanics/intro.html">
     Mechanics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/1_Motion_in_1D.html">
       Motion in 1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/2_Motion_in_2D.html">
       Motion in 2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/3_Work_and_Energy.html">
       Work and Energy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/4_Rotational_Motion.html">
       Rotational Motion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/5_Gravity.html">
       Gravity
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/seismology/intro.html">
     Seismology
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/CMP_Common_Mid_Point_Gather.html">
       Common Mid-point Gather
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Ghosting.html">
       Ghosting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Spatial_aliasing.html">
       Spatial Aliasing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Temporal_aliasing.html">
       Temporal Aliasing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/tectonics_of_the_ocean/intro.html">
     Techtonics of the ocean
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/tectonics_of_the_ocean/Plate_Models.html">
       Heat Flow
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../b_coding/intro.html">
   Coding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../b_coding/NumPy_Arrays.html">
     NumPy arrays
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/intro.html">
     Fundamentals of Computer Science
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/1_Algorithmic_Complexity.html">
       Algorithmic complexity
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/2_Recursion.html">
       Recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/3_Divide_and_Conquer.html">
       Divide and Conquer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/4_Dynamic_Programming.html">
       Dynamic Programming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/5_Greedy_Algorithms.html">
       Greedy Algorithms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/6_Data_Structures.html">
       Data Structures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/7_Graph_Algorithms.html">
       Graph Algorithms
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Intro%20to%20Python/intro.html">
     Intro to Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/1_Printing_and_formatting_statements.html">
       Printing and formatting statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/2_Variables.html">
       Variables
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/3_If_statement.html">
       If statement
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/4_While_loops.html">
       While loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/5_Lists.html">
       Lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/6_For_loops.html">
       For loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/7_List_comprehensions.html">
       List comprehensions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/8_Nested_lists.html">
       Nested lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/9_Handling_errors.html">
       Handling errors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/10_Importing.html">
       Importing in Python
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/11_Functions.html">
       Creating custom functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/12_Tuples.html">
       Tuples
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/13_File_handling.html">
       File handling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/14_Dictionaries.html">
       Dictionaries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/15_Flow_control_statements.html">
       Flow control statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/16_Sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/17_Matplotlib.html">
       Plotting data with Matplotlib
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/18_Assert.html">
       Assert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/19_Classes.html">
       Python classes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/20_Lambdas.html">
       Lambdas
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Pandas/intro.html">
     Pandas
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/1_basics.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/2_filter_select_assign.html">
       Filtering, selecting and assigning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/3_merge_combine_group_sort.html">
       Merging, combining, grouping and sorting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/4_summary_statistics.html">
       Summary statistics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/5_time_stamps.html">
       Creating date-time stamps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/6_plotting.html">
       Plotting
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Programming%20Tools/intro.html">
     Programming tools
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Programming%20Tools/1_Version_Control_Git.html">
       Version control Git
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro.html">
   Mathematics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../calculus/intro.html">
     Calculus
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../calculus/Vector_calculus.html">
       Vector calculus
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../complex_analysis/intro.html">
     Complex analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/1_introduction.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/2_complex_plane.html">
       Complex plane
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/3_complex_functions.html">
       Complex functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/4_holomorphic_functions.html">
       Holomorphic functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/5_integrating.html">
       Complex integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/6_fractals.html">
       Fractals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../differential_equations/intro.html">
     Differential equations
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/1_de_introduction.html">
       Introduction to differential equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/2_linear_des.html">
       Linear Differential Equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/3_first-order_odes.html">
       First-order ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/4_higher_ord_lin_odes.html">
       Higher order Linear ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/5_ode_series.html">
       Series ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/6_pde_basicdefinitions.html">
       Introductory definitions and concepts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/7_pde_first_order.html">
       First-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/8_pde_second_order.html">
       Canonical form of second-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/9_poisson_laplace_eq.html">
       Poisson’s and Laplace’s equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/10_heat_eq.html">
       Heat (diffusion) equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/11_pde_fourier.html">
       Solving PDEs with fourier methods
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/12_wave_eq.html">
       Wave equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/13_similarity_solutions.html">
       Self-similar solutions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../linear_algebra/intro.html">
     Linear algebra
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/1_Basic_definitions_and_operations.html">
       Basic definitions and operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/2_Linear_Systems.html">
       Systems of linear equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/3_Theory.html">
       Theory
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/4_Eigenvalues_and_eigenvectors.html">
       Eigenvalues and eigenvectors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/5_Linear_Algebra_in_Python.html">
       Linear Algebra in Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../mathematical_notation/intro.html">
     Mathematical notation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../mathematical_notation/Big_O_notation.html">
       Big O notation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../mathematical_notation/Tensors_Review.html">
       Review of tensors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="intro.html">
     Numerical methods
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="1_Interpolation_curve_fitting.html">
       Interpolation and curve fitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="2_Numerical_differentiation.html">
       Numerical differentiation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="3_Timestepping_an_ODE.html">
       Solving or timestepping an ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="4_Heuns_method.html">
       Heun’s method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="5_Runge_Kutta_method.html">
       Runge-Kutta method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="6_Solving_PDEs_SOR.html">
       Successive over-relaxation method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="7_FTCS.html">
       FTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="8_BTCS.html">
       BTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="9_Numerical_integration.html">
       Numerical integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="10_Roots_of_equations.html">
       Roots of equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="11_linear_algebra_intro.html">
       Linear algebra introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="12_Gaussian_elimination.html">
       Gaussian elimination
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       LU decomposition
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="14_ill_conditioning_errors.html">
       Ill-conditioning and roundoff errors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="15_iterative_methods_to_solve_matrix.html">
       Iterative methods to solve a matrix
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../series_and_sequences/intro.html">
     Series and sequences
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Fourier_series.html">
       Fourier series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Fourier_transforms.html">
       Fourier transforms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Taylor_series.html">
       Taylor series
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../sets_and_functions/intro.html">
     Sets and functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/1_logic.html">
       Logic and proof
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/2_sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/3_functions.html">
       Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/4_elementary_functions_1.html">
       Elementary functions 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/5_elementary_functions_2.html">
       Elementary functions 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../sets_and_functions/6_composition_and_inverse.html">
       Composition and Inverse Functions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../statistics/intro.html">
     Statistics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../statistics/Linear_Regression.html">
       Linear regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../statistics/Statistics_for_Geoscientists.html">
       Introduction to statistics for Geoscientists
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../d_geosciences/intro.html">
   Geosciences
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
  <label for="toctree-checkbox-23">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/1D_Heat_Conduction.html">
     1D heat conduction (layered medium)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/1D_Resistivity_Forward_Modelling.html">
     1D resistivity forward modelling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/3D_Earthquake_Focus_Plot.html">
     Plotting Earthquake Focus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Climate_Model.html">
     Climate model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Downloading_earthquake_data.html">
     Downloading earthquake data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Keplerian_Orbits.html">
     Keplerian orbits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Longitude_Latitude_Degree_Convertion.html">
     Reading Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Milankovitch_cycles.html">
     Milankovitch cycles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Seafloor_ages.html">
     Seafloor ages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Tides.html">
     Tides
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../d_geosciences/Wave_dispersion.html">
     Wave dispersion
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Electromagnetism/intro.html">
     Electromagnetism
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/1_electricity_magnetism.html">
       Electricity and magnetism
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/2_maxwell_eqs.html">
       Maxwell’s equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/3_four_field.html">
       The four-field formalism
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/intro.html">
     Fluid dynamics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
    <label for="toctree-checkbox-25">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture5_1D_Pipe_Flow.html">
       1D Pipe Flow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture6_Non_Linear_Viscosity_2D_Stokes.html">
       Non Linear Viscosity 2D Stokes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture7_Pipe_Flow_with_Heat.html">
       Pipe Flow with Heat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture8_Part1_Navier_Stoke_Equation.html">
       Navier Stoke Equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Fluid_Dynamics/Lecture8_Part2_SPH_Algorithm_For_Energy_Equation.html">
       SPH Algorithm for Energy Equation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics/intro.html">
     Geophysical Fluid Dynamics of the Oceans
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
    <label for="toctree-checkbox-26">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics/Mixed%20layer.html">
       The mixed layer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics/Stream%20lines.html">
       Stream functions and stream lines
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/intro.html">
     High-Temperature Geochemistry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
    <label for="toctree-checkbox-27">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Distribution_Coefficients.html">
       Distribution coefficients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Evaporation_and_Condensation.html">
       Evaporation and Condensation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Isotope_Systematics_of_Mixing.html">
       Isotope Systematics of Mixing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Lu-Hf_Decay.html">
       Lu-Hf Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Major_and_Trace_Elements.html">
       Major and trace elements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Melting_and_Crystalisation.html">
       Melting and crystalisation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Nuclides.html">
       Nuclides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Radioactive_Dating.html">
       Radioactive Dating
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Rb-Sr_Decay.html">
       Rb-Sr Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Re-Os_Decay.html">
       Re-Os Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Sm-Nd_Decay.html">
       Sm-Nd Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Stable_Isotope_Geochemistry%20.html">
       Stable Isotope Geochemistry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/U-Th-Pb_Decay.html">
       U-Th-Pb Decay
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/intro.html">
     Low-Temperature Geochemistry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
    <label for="toctree-checkbox-28">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Arrhenius_Equation.html">
       Arrhenius Equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/CO2_H2O_System.html">
       CO2-H2O System
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Defining_Activity_Coefficients.html">
       Defining activity coefficients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Hess_Law.html">
       Hess’ law
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Rate_Law.html">
       Rate Law
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Reaction_Quotients.html">
       Reaction Quotients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Stability_Diagram.html">
       Stability Diagram
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Physical%20Processes/intro.html">
     Physical Processes
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
    <label for="toctree-checkbox-29">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Dimensional_Analysis.html">
       Dimensional Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Fluids_%26_the_Bernoulli_effect.html">
       Fluids &amp; the Bernoulli effect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Heat.html">
       Heat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Reynolds_number.html">
       Reynolds number
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Pure%20and%20Applied%20Geophysics/intro.html">
     Pure and Applied Geophysics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
    <label for="toctree-checkbox-30">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Pure%20and%20Applied%20Geophysics/Gravity%20correction.html">
       Gravity corrections
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Pure%20and%20Applied%20Geophysics/Magnetic%20surveys.html">
       Magnetic surveys
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Waves/intro.html">
     Waves
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
    <label for="toctree-checkbox-31">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Attenuation.html">
       Attenuation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Fourier_Series.html">
       Fourier series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Introduction_To_Waves.html">
       Introduction to waves
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Refraction.html">
       Superposition of Waves, Reflection and Refraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Transmission_and_Reflection.html">
       Impedance, Transmission and Reflection
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/remote_sensing/intro.html">
     Remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
    <label for="toctree-checkbox-32">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/remote_sensing/Image_Filtering.html">
       Image filtering
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/remote_sensing/Image_Point_Operations.html">
       Image point operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/remote_sensing/Image_Transformations_and_Orthorectification.html">
       Image transformations and orthorectification
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../e_extra/intro.html">
   Further resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/>
  <label for="toctree-checkbox-33">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Camera_Calibration.html">
     Camera calibration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Cartography_Cartopy.html">
     Cartopy (maps)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Dakota.html">
     Dakota
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Foundations.html">
     Google Earth Engine foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Getting_Started_.html">
     Google Earth Engine getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Particle_Image_Velocimetry.html">
     Particle image velocimetry (PIV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/contributors_guide.html">
     Contributor’s guide
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../e_extra/UAV_Mapping/intro.html">
     UAV Mapping
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/>
    <label for="toctree-checkbox-34">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/UAV_Mapping/1.Mission_Planning.html">
       1. Mission Planning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/intro.html">
     Machine learning
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/>
    <label for="toctree-checkbox-35">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%200%20--%20Introduction.html">
       Chapter 0 – Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%201%20--%20Neural%20Network.html">
       Chapter 1 – Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%202%20--%20Maximum%20Likelihood.html">
       Chapter 2 – Maximum Likelihood
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%203%20--%20Cross%20Entropy.html">
       Chapter 3 – Cross Entropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%204%20--%20Cost%20Function.html">
       Chapter 4 – Cost Function
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%205%20--%20Gradient%20Descent%201.html">
       Chapter 5 – Gradient Descent 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%206%20--%20Gradient%20Descent%202.html">
       Chapter 6 – Gradient Descent 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%207%20--%20Real%20%28Non-linear%29%20Neural%20Network.html">
       Chapter 7 – Real (Non-linear) Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%208%20--%20Feedforward.html">
       Chapter 8 – Feedforward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%209%20--%20Back%20Propagation.html">
       Chapter 9 – Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2010%20--%20General%20Back%20Propagation.html">
       Chapter 10 – General Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2011%20--%20Underfitting%20and%20Overfitting.html">
       Chapter 11 – Underfitting and Overfitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2012%20--%20Early-stopping%2C%20Dropout%20%26%20Mini-batch.html">
       Chapter 12 – Early-stopping, Dropout &amp; Mini-batch
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2013%20--%20Vanishing%20Gradient%201.html">
       Chapter 13 – Vanishing Gradient 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2014%20--%20Vanishing%20Gradient%202.html">
       Chapter 14 – Vanishing Gradient 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2015%20--%20Regularisation.html">
       Chapter 15 – Regularisation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2016%20--%20Other%20Activation%20Functions.html">
       Chapter 16 – Other Activation Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2017%20--%20Local%20Minima%20Trap.html">
       Chapter 17 – Local Minima Trap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2018%20--%20Softmax.html">
       Chapter 18 – Softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2019%20--%20Hyper-Parameters.html">
       Chapter 19 – Hyper-Parameters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2020%20--%20Coding%20Example.html">
       Chapter 20 – Coding Example
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/primer-computational-mathematics/book/master?urlpath=tree/notebooks/c_mathematics/numerical_methods/13_LU_decomposition.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/primer-computational-mathematics/book/issues/new?title=Issue%20on%20page%20%2Fc_mathematics/numerical_methods/13_LU_decomposition.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/c_mathematics/numerical_methods/13_LU_decomposition.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theory">
   Theory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#doolittle-algorithm">
   Doolittle algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise">
     Exercise
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#partial-pivoting">
   Partial pivoting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Implementation
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>LU decomposition</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theory">
   Theory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#doolittle-algorithm">
   Doolittle algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise">
     Exercise
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#partial-pivoting">
   Partial pivoting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Implementation
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="lu-decomposition">
<span id="nm-lu-decomposition"></span><h1>LU decomposition<a class="headerlink" href="#lu-decomposition" title="Permalink to this headline">#</a></h1>
<p><a class="reference internal" href="../../a_modules/intro.html#module-nm"><span class="std std-ref"><!-- module-nm badge --><span class="module module-nm">Numerical Methods</span></span></a></p>
<section id="motivation">
<span id="index-0"></span><h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">#</a></h2>
<p>The Gaussian elimination solves a matrix system with one RHS vector \(\pmb{b}\). We often have to deal with problems where we have multiple RHS vectors, all with the same matrix \(A\).</p>
<p>We could call the same code (e.g. <code class="docutils literal notranslate"><span class="pre">upper_triangle</span></code> and <code class="docutils literal notranslate"><span class="pre">back_substitution</span></code> from <a class="reference internal" href="12_Gaussian_elimination.html#nm-gaussian-elimination-code"><span class="std std-ref">Gaussian elimination</span></a> notebook) multiple times to solve all of these corresponding linear systems, but note that as the elimination algorithm is actually performing operations based upon (the same) \(A\) each time, we would actually be wasting time repeating exactly the same operations - this is therefore clearly not an efficient solution to the problem.</p>
<p>We could easily generalise our Gaussian elimination/back substitution algorithms to include multiple RHS column vectors in the augmented system, perform the same sequence of row operations (but now only once) to transform the matrix to upper-triangular form, and then perform back substitution on each of the transformed RHS vectors from the augmented system - cf. the use of Gaussian elimination to compute the inverse to a matrix by placing the identity on the right of the augmented system.</p>
<p>However, it is often the case that each RHS vector depends on the solutions to the matrix systems obtained from some or all of the earlier RHS vectors, and so this generalisation would not work in this case. For example, our discrete system could be of the form</p>
<p>\[A\pmb{x}^{n+1} = \pmb{b}(\pmb{x}^n, \ldots)\]</p>
<aside class="margin sidebar">
<p class="sidebar-title">Note</p>
<p>This is true if our model is linear, in the nonlinear case \(A\) would be updated evey time step.</p>
</aside>
<p>where \(\pmb{x}^{n+1}\) is the numerical solution of an ordinary or partial differential equation at time level \(n+1\), the RHS is a function of the the solution at the previous time level \(n\) (and possibly other things such as forcing terms, represented by the \(\ldots\) above. \(A\) is then a discretisation of the differential equation written in the form that it maps the old solution to the new one. Time stepping this problem invovles solving the same linear system multiple times with different RHSs.</p>
</section>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">#</a></h2>
<p>To deal with this situation efficiently we decompose or factorise the matrix \(A\) in such a way that it is cheap to compute a new solution vector \(\pmb{x}\) for any given RHS vector \(\pmb{b}\). This decomposition involves a lower- and an upper-triangular matrix, hence the name <strong>LU decomposition</strong>. These matrices encode the steps conducted in Gaussian elimination, so we don’t have to explicilty conduct all of the operations again and again.</p>
<p>Mathematically, let’s assume that we have already found/constructed a lower-triangular matrix (\(L\) - where all entries above the diagonal are zero) and an upper-triangular matrix (\(U\) - where all entries below the diagonal are zero) such that we can write</p>
<p>\[ A = LU.\]</p>
<p>In this case the matrix system we need to solve for \(\pmb{x}\) becomes</p>
<p>\[ A\pmb{x} = \pmb{b} \iff (LU)\pmb{x} = L(U\pmb{x}) = \pmb{b}.\]</p>
<p>Notice that the matrix-vector product \(U\pmb{x}\) is itself a vector, let’s call it \(\pmb{c}\) for the time-being (i.e. \(\pmb{c}=U\pmb{x}\)).</p>
<p>The above system then reads</p>
<p>\[ L\pmb{c} = \pmb{b}, \]</p>
<p>where \(L\) is a matrix and \(\pmb{c}\) is an unknown.</p>
<p>As \(L\) is in the lower-triangular form, we can use forward substitution (generalising the back subsitution algorithm/code) to very easily find \(\pmb{c}\) in relatively few operations (we don’t need to call the entire Gaussian elimination algorithm).</p>
<p>Once we know \(\pmb{c}\) we then solve the second linear system</p>
<p>\[ U\pmb{x} = \pmb{c},\]</p>
<p>where now we can use the fact that \(U\) is upper-triangular to use our back substitution algorithm again very efficiently to give the solution \(\pmb{x}\) we require.</p>
<p>So for a given \(\pmb{b}\) we can find the corresponding \(\pmb{x}\) very efficiently, we can therefore do this repeatedly as each new \(\pmb{b}\) is given to us.</p>
<p>Our challenge is therefore to find the matrices \(L\) and \(U\) allowing us to perform the decomposition \(A=LU\).</p>
</section>
<section id="doolittle-algorithm">
<h2>Doolittle algorithm<a class="headerlink" href="#doolittle-algorithm" title="Permalink to this headline">#</a></h2>
<p>Recall the comment above on the \(L\) and \(U\) matrices encoding the steps taken in Gaussian elimination. Let’s see how this works through the development of the so-called <strong>Doolittle algorithm</strong>.</p>
<p>Let’s consider an example matrix:</p>
<p>\[
A=\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{black}5} &amp; {\color{black}14} &amp; {\color{black}7} &amp; {\color{black}10}\\
{\color{black}20} &amp; {\color{black}77} &amp; {\color{black}41} &amp; {\color{black}48}\\
{\color{black}25} &amp; {\color{black}91} &amp; {\color{black}55} &amp; {\color{black}67}\\
\end{bmatrix}
\]</p>
<p>The first step of Gaussian elimination is to set the sub-diagonal elements in the first column to zero by subtracting multiples of the first row from each of the subsequent rows.</p>
<p>For this example, this requires the row operations</p>
<p>\[
\begin{align}
Eq. (2) &amp;\leftarrow Eq. (2) - 1\times Eq. (1)\\
Eq. (3) &amp;\leftarrow Eq. (3) - 4\times Eq. (1)\\
Eq. (4) &amp;\leftarrow Eq. (4) - 5\times Eq. (1)\\
\end{align}
\]</p>
<p>or mathematically, and for each element of the matrix (remembering that we are adding rows together - while one of
the entries of a row will end up being zero, this also has the consequence of updating the rest of the values in that row, hence the iteration over \(j\) below):</p>
<p>\[
\begin{align}
A_{2j} &amp;\leftarrow A_{2j} - \frac{A_{21}}{A_{11}} A_{1j} = A_{2j} - \frac{5}{5} \times A_{1j}, \quad j=1,2,3,4\\
A_{3j} &amp;\leftarrow A_{3j} - \frac{A_{31}}{A_{11}} A_{1j} = A_{3j} - \frac{20}{5} \times A_{1j}, \quad j=1,2,3,4\\
A_{4j} &amp;\leftarrow A_{4j} - \frac{A_{41}}{A_{11}} A_{1j} = A_{4j} - \frac{25}{5} \times A_{1j}, \quad j=1,2,3,4\\
\end{align}
\]</p>
<p>Notice that we can also write these exact operations on elements in terms of multiplication by a carefully chosen lower-triangular matrix where the non-zero’s below the diagonal are restricted to a single column, e.g. for the example above</p>
<p>\[
\begin{bmatrix}
{\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{Orange}{-1}} &amp; {\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{Orange}{-4}} &amp; {\color{black}0} &amp; {\color{black}1} &amp; {\color{black}0}\\
{\color{Orange}{-5}} &amp; {\color{black}0} &amp; {\color{black}0} &amp; {\color{black}1}\\<br />
\end{bmatrix}\qquad\times\qquad\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{black}5} &amp; {\color{black}14} &amp; {\color{black}7} &amp; {\color{black}10}\\
{\color{black}20} &amp; {\color{black}77} &amp; {\color{black}41} &amp; {\color{black}48}\\
{\color{black}25} &amp; {\color{black}91} &amp; {\color{black}55} &amp; {\color{black}67}\\<br />
\end{bmatrix}\qquad=\qquad\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{blue}{0}} &amp; {\color{blue}{7}} &amp; {\color{blue}{2}} &amp; {\color{blue}{1}}\\
{\color{blue}{0}} &amp; {\color{blue}{49}} &amp; {\color{blue}{21}} &amp; {\color{blue}{12}}\\
{\color{blue}{0}} &amp; {\color{blue}{56}} &amp; {\color{blue}{30}} &amp; {\color{blue}{22}}\\<br />
\end{bmatrix}
\]</p>
<p>The lower-triangular matrix (let’s call this one \(L_0\)) is thus encoding the first step in Gaussian elimination.</p>
<p>The next step involves taking the second row of the updated matrix as the new pivot (we will ignore partial pivoting for simplicity), and subtracting multiples of this row from those below in order to set the zeros below the diagonal in the second column to zero.</p>
<p>Note that this step can be achieved here with the multiplication by the following lower-triangular matrix (call this one \(L_1\))</p>
<p>\[
\begin{bmatrix}
{\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{black}0} &amp; {\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{black}0} &amp; {\color{Orange}{-7}} &amp; {\color{black}1} &amp; {\color{black}0}\\
{\color{black}0} &amp; {\color{Orange}{-8}} &amp; {\color{black}0} &amp; {\color{black}1}\\
\end{bmatrix}\qquad\times\qquad\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{black}0} &amp; {\color{black}7} &amp; {\color{black}2} &amp; {\color{black}1}\\
{\color{black}0} &amp; {\color{black}49} &amp; {\color{black}21} &amp; {\color{black}12}\\
{\color{black}0} &amp; {\color{black}56} &amp; {\color{black}30} &amp; {\color{black}22}\\
\end{bmatrix}\qquad=\qquad\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{black}0} &amp; {\color{black}7} &amp; {\color{black}2} &amp; {\color{black}1}\\
{\color{black}0} &amp; {\color{blue}{0}} &amp; {\color{blue}{7}} &amp; {\color{blue}{5}}\\
{\color{black}0} &amp; {\color{blue}{0}} &amp; {\color{blue}{14}} &amp; {\color{blue}{14}}\\
\end{bmatrix}
\]</p>
<p>and finally for this example to get rid the of the leading 14 on the final row:</p>
<p>\[
\begin{bmatrix}
{\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{black}0} &amp; {\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{black}0} &amp; {\color{black}0} &amp; {\color{black}1} &amp; {\color{black}0}\\
{\color{black}0} &amp; {\color{black}0} &amp; {\color{Orange}{-2}} &amp; {\color{black}{1}}\\
\end{bmatrix}\qquad\times\qquad\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{black}0} &amp; {\color{black}7} &amp; {\color{black}2} &amp; {\color{black}1}\\
{\color{black}0} &amp; {\color{black}0} &amp; {\color{black}7} &amp; {\color{black}5}\\
{\color{black}0} &amp; {\color{black}0} &amp; {\color{black}14} &amp; {\color{black}14}\\
\end{bmatrix}\qquad=\qquad\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{black}0} &amp; {\color{black}7} &amp; {\color{black}2} &amp; {\color{black}1}\\
{\color{black}0} &amp; {\color{black}0} &amp; {\color{black}7} &amp; {\color{black}5}\\
{\color{black}0} &amp; {\color{black}0} &amp; {\color{blue}{0}} &amp; {\color{blue}{4}}\\
\end{bmatrix}
\]</p>
<p>where this lower triangular matrix we will call \(L_2\), and the RHS matrix is now in upper-triangular form as we expect from Gaussian elimination (call this \(U\)).</p>
<p>In summary, the above operations (starting from \(A\), first multipling on the left by \(L_0\), the multiplying the result on the left by \(L_1\) and so on to arrive at an upper trianglualr matrix \(U\)) can be written as</p>
<p>\[ L_2(L_1(L_0A)) = U.\]</p>
<p>Note that these special lower-triangular matrices \(L_0, \ldots\) are all examples of what is known as <em>atomic</em> lower-triangular matrices: a special form of unitriangular matrix - the diagonals are unity, where the off-diagonal entries are all zero apart from in a single column.</p>
<p>Notice that for these special, simple matrices, their inverse is simply the original with the sign of those off-diagnonals changed:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{bmatrix}
    1      &amp; 0      &amp; \cdots      &amp;        &amp;              &amp;        &amp;         &amp;   &amp; 0 \\
    0      &amp; 1      &amp; 0           &amp; \cdots &amp;              &amp;        &amp;         &amp;   &amp; 0 \\
    0      &amp; \ddots &amp; \ddots      &amp; \ddots &amp;              &amp;        &amp;         &amp;   &amp;  \vdots \\
    \vdots &amp; \ddots &amp; \ddots      &amp; \ddots &amp;              &amp;        &amp;         &amp;   &amp;  \\
           &amp;        &amp;             &amp;   0    &amp;   1          &amp;  0     &amp;         &amp; &amp;  &amp;  \\        
           &amp;        &amp;             &amp;   0    &amp;   l_{i+1,i}  &amp;  1     &amp;  \ddots &amp;   &amp;  &amp;  \\ 
           &amp;        &amp;             &amp;   0    &amp;   l_{i+2,i}  &amp;  0     &amp;  \ddots &amp;   &amp; &amp;  \\
           &amp;        &amp;             &amp; \vdots &amp;   \vdots     &amp; \vdots &amp;  \ddots &amp;   &amp; 0 &amp;  \\               
    0      &amp; \cdots &amp;             &amp; 0      &amp;   l_{n,i}    &amp; 0      &amp;  \cdots &amp; 0 &amp; 1 &amp;  \\    
\end{bmatrix}^{-1}
=
\begin{bmatrix}
    1      &amp; 0      &amp; \cdots      &amp;        &amp;              &amp;        &amp;         &amp;   &amp; 0 \\
    0      &amp; 1      &amp; 0           &amp; \cdots &amp;              &amp;        &amp;         &amp;   &amp; 0 \\
    0      &amp; \ddots &amp; \ddots      &amp; \ddots &amp;              &amp;        &amp;         &amp;   &amp;  \vdots \\
    \vdots &amp; \ddots &amp; \ddots      &amp; \ddots &amp;              &amp;        &amp;         &amp;   &amp;  \\
           &amp;        &amp;             &amp;   0    &amp;   1          &amp;  0     &amp;         &amp; &amp;  &amp;  \\          
           &amp;        &amp;             &amp;   0    &amp;   -l_{i+1,i}  &amp;  1     &amp;  \ddots &amp;   &amp;  &amp;  \\ 
           &amp;        &amp;             &amp;   0    &amp;   -l_{i+2,i}  &amp;  0     &amp;  \ddots &amp;   &amp; &amp;  \\  
           &amp;        &amp;             &amp; \vdots &amp;   \vdots     &amp; \vdots &amp;  \ddots &amp;   &amp; 0 &amp;  \\               
    0      &amp; \cdots &amp;             &amp; 0      &amp;   -l_{n,i}    &amp; 0      &amp;  \cdots &amp; 0 &amp; 1 &amp;  \\    
\end{bmatrix}
\end{split}\]</div>
<section id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">#</a></h3>
<p>Convince yourselves of the following facts:</p>
<ol class="simple">
<li><p>the above statement on what the inverse of the special \(L\) matrices is - check on a small example.</p></li>
<li><p>the multiplication of arbitrary lower-triangular square matrices is also lower-triangular.</p></li>
<li><p>\(L_2(L_1(L_0A)) = U \implies A = L_0^{-1}(L_1^{-1}(L_2^{-1}U))\)</p></li>
<li><p>and hence that \(A=LU\) where \(U\) is the upper-triangular matrix found at the end of Guassian elimination, and where \(L\) is the following matrix
\[L = L_0^{-1}L_1^{-1}L_2^{-1}.\]</p></li>
<li><p>finally, compute this product of these lower-triangular matrices to show that
\[L =
\begin{bmatrix}
{\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{black}{1}} &amp; {\color{black}1} &amp; {\color{black}0} &amp; {\color{black}0}\\
{\color{black}{4}} &amp; {\color{black}7} &amp; {\color{black}1} &amp; {\color{black}0}\\
{\color{black}{5}} &amp; {\color{black}8} &amp; {\color{black}2} &amp; {\color{black}1}\\<br />
\end{bmatrix}
\]
i.e. that the multiplication of these individual atomic matrices (importantly in this order) simply merges the entries from the non-zero columns of each atomic matrix, and hence is both lower-triangular, as well as trivial to compute.</p></li>
</ol>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="c1"># as above: A matrix,</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span>   <span class="mf">7.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">77.</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">48.</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">91.</span><span class="p">,</span>  <span class="mf">55.</span><span class="p">,</span> <span class="mf">67.</span><span class="p">]])</span>

<span class="c1"># lower triangular matrices,</span>
<span class="n">L0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">L1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">L2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="c1"># and their inverse matrices</span>
<span class="n">L0_</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">L0</span><span class="p">)</span>
<span class="n">L1_</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">L1</span><span class="p">)</span>
<span class="n">L2_</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>

<span class="c1"># our base matrix</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># ad: The multiplication of arbitrary lower-triangular</span>
<span class="c1"># square matrices is also lower-triangular</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Question 1:&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L0</span><span class="p">,</span> <span class="n">L1</span><span class="p">))</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="n">L1</span><span class="p">))</span>

<span class="c1"># ad: L2(L1(L0 A)) = U</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Question 2:&quot;</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L0</span><span class="p">,</span> <span class="n">A</span><span class="p">)))</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

<span class="c1"># ad: A = L0^-1(L1^-1(L2^-1 U))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Question 3:&quot;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L0_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L1_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L2_</span><span class="p">,</span> <span class="n">U</span><span class="p">)))</span> 
<span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># ad: L = L0^-1 L1^-1 L2^-1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Question 4:&quot;</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L0_</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L1_</span><span class="p">,</span><span class="n">L2_</span><span class="p">))</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

<span class="c1"># ad: A = LU</span>
<span class="c1"># numpy.allclose takes two numpy arrays and checks </span>
<span class="c1"># whether all elements are identical to some tolerance</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Question 5:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">U</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.,  7.,  5.,  9.],
       [ 5., 14.,  7., 10.],
       [20., 77., 41., 48.],
       [25., 91., 55., 67.]])
Question 1:
array([[ 1,  0,  0,  0],
       [-1,  1,  0,  0],
       [-4, -7,  1,  0],
       [-5, -8,  0,  1]])
array([[ 1,  0,  0,  0],
       [ 0,  1,  0,  0],
       [ 0, -7,  1,  0],
       [ 0,  6, -2,  1]])
Question 2:
array([[5., 7., 5., 9.],
       [0., 7., 2., 1.],
       [0., 0., 7., 5.],
       [0., 0., 0., 4.]])
Question 3:
array([[ 5.,  7.,  5.,  9.],
       [ 5., 14.,  7., 10.],
       [20., 77., 41., 48.],
       [25., 91., 55., 67.]])
Question 4:
array([[1., 0., 0., 0.],
       [1., 1., 0., 0.],
       [4., 7., 1., 0.],
       [5., 8., 2., 1.]])
Question 5:
True
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">#</a></h2>
<p>We can build an LU code easily from <a class="reference internal" href="12_Gaussian_elimination.html#nm-gaussian-elimination"><span class="std std-ref">Gaussian elimination code</span></a>. The final \(U\) matrix we need here is as was already constructed through Gaussian elimination, the entries of \(L\) we need are simply the \({A_{ik}}/{A_{kk}}\) multipliers we computed as part of the elimination, but threw away previously.</p>
<p>For a given pivot row \(k\), for each of these multipliers (for every row below the pivot), as we compute them we know that we are going to transform the augmented matrix in order to achieve a new zero below the diagonal - we can store each multiplier in this position before moving on to the following row, we implicitly know that the diagonals of \(L\) will be unity and so don’t need to store these (and noting that we don’t actually have a space for them anyway!). We then move on to the following pivot row, replacing the zeros in the corresponding column we are zero’ing, but again using the now spare space to store the multipliers.</p>
<p>For example, for the case above</p>
<p>\[ A =
\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{black}5} &amp; {\color{black}14} &amp; {\color{black}7} &amp; {\color{black}10}\\
{\color{black}20} &amp; {\color{black}77} &amp; {\color{black}41} &amp; {\color{black}48}\\
{\color{black}25} &amp; {\color{black}91} &amp; {\color{black}55} &amp; {\color{black}67}\\<br />
\end{bmatrix}\quad\rightarrow\quad
\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{blue}{1}} &amp; {\color{black}{7}} &amp; {\color{black}{2}} &amp; {\color{black}{1}}\\
{\color{blue}{4}} &amp; {\color{black}{49}} &amp; {\color{black}{21}} &amp; {\color{black}{12}}\\
{\color{blue}{5}} &amp; {\color{black}{56}} &amp; {\color{black}{30}} &amp; {\color{black}{22}}\\<br />
\end{bmatrix}\quad\rightarrow\quad
\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{blue}1} &amp; {\color{black}7} &amp; {\color{black}2} &amp; {\color{black}1}\\
{\color{blue}4} &amp; {\color{blue}{7}} &amp; {\color{black}{7}} &amp; {\color{black}{5}}\\
{\color{blue}5} &amp; {\color{blue}{8}} &amp; {\color{black}{14}} &amp; {\color{black}{14}}\\
\end{bmatrix}\quad\rightarrow\quad
\begin{bmatrix}
{\color{black}5} &amp; {\color{black}7} &amp; {\color{black}5} &amp; {\color{black}9}\\
{\color{blue}1} &amp; {\color{black}7} &amp; {\color{black}2} &amp; {\color{black}1}\\
{\color{blue}4} &amp; {\color{blue}7} &amp; {\color{black}7} &amp; {\color{black}5}\\
{\color{blue}5} &amp; {\color{blue}8} &amp; {\color{blue}{2}} &amp; {\color{black}{4}}\\
\end{bmatrix}
= [\color{blue}L\backslash U]
\]</p>
<p>Starting from <a class="reference internal" href="12_Gaussian_elimination.html#nm-gaussian-elimination"><span class="std std-ref">Gaussian elimination code</span></a> we will compute the LU decomposition of a matrix. First, we will store \(L\) and \(U\) in two different matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LU_dec</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="c1"># Upper triangular matrix contains gaussian elimination result</span>
    <span class="c1"># We won&#39;t change A in-place but create a local copy</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># Lower triangular matrix has identity diagonal and scaling factors</span>
    <span class="c1"># Start from the identity:</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="c1"># Loop over each pivot row.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># Loop over each equation below the pivot row.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="c1"># Define the scaling factor outside the innermost</span>
            <span class="c1"># loop otherwise its value gets changed.</span>
            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="c1"># Scaling factors make up the lower matrix </span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
    <span class="c1"># A now is the upper triangular matrix U</span>
    <span class="k">return</span> <span class="n">L</span><span class="p">,</span> <span class="n">A</span>
</pre></div>
</div>
</div>
</div>
<p>Test the code:</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span>  <span class="mf">7.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">77.</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">48.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">91.</span> <span class="p">,</span><span class="mf">55.</span><span class="p">,</span> <span class="mf">67.</span><span class="p">]])</span>

<span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">LU_dec</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">U</span><span class="p">),</span> <span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.,  7.,  5.,  9.],
       [ 5., 14.,  7., 10.],
       [20., 77., 41., 48.],
       [25., 91., 55., 67.]])
array([[1., 0., 0., 0.],
       [1., 1., 0., 0.],
       [4., 7., 1., 0.],
       [5., 8., 2., 1.]])
array([[5., 7., 5., 9.],
       [0., 7., 2., 1.],
       [0., 0., 7., 5.],
       [0., 0., 0., 4.]])
True
</pre></div>
</div>
</div>
</div>
</section>
<section id="partial-pivoting">
<h2>Partial pivoting<a class="headerlink" href="#partial-pivoting" title="Permalink to this headline">#</a></h2>
<p>Problems can occur in a numerical implementation of our algorithm if <span class="math notranslate nohighlight">\(A_{kk}\)</span> divided through by in the Gaussian elimination and/or back substitution algorithms might be zero (or close to zero).</p>
<p>Using Gaussian elimination as an example, let’s again consider the algorithm mid-way working on an arbitrary matrix system, i.e. assume that the first \(k\) rows have already been transformed into upper-triangular form, while the equations/rows below are not yet in this form:</p>
<p>\[
\begin{bmatrix}
A_{11} &amp; A_{12} &amp; A_{13} &amp; \cdots &amp; A_{1k}  &amp; \cdots &amp; A_{1n} &amp; b_1 \\
0      &amp; A_{22} &amp; A_{23} &amp; \cdots &amp; A_{2k} &amp; \cdots &amp; A_{2n} &amp; b_2 \\
0      &amp; 0      &amp; A_{33} &amp; \cdots &amp; A_{3k}  &amp; \cdots &amp; A_{3n} &amp; b_3 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots  &amp; \ddots &amp; \vdots &amp; \vdots \\
\hdashline<br />
0      &amp; 0      &amp; 0      &amp; \cdots &amp; A_{kk}  &amp; \cdots &amp; A_{kn} &amp; b_k \\<br />
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots  &amp; \ddots &amp; \vdots &amp; \vdots \\
0      &amp; 0      &amp; 0      &amp; \cdots &amp; A_{nk}  &amp; \cdots &amp; A_{nn} &amp; b_n \\
\end{bmatrix}
\]</p>
<p>We have drawn the horizontal dashed line one row higher, as we are not going to blindly asssume that it is wise to take the current row \(k\) as the pivot row, and \(A_{kk}\) as the so-called pivot element.</p>
<p><strong>Partial pivoting</strong> selects the best pivot (row or element) as the one where the \(A_{ik}\) (for \(i\ge k\)) value is largest (relative to the other values of components in its own row \(i\)), and then swaps this row with the current \(k\) row.</p>
<p>To generalise our codes above we would simply need to search for this row, and perform the row swap operation.</p>
<p>Python’s <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code> library has its own implementation of the LU decomposition, that uses partial pivoting.</p>
<div class="dropdown admonition">
<p class="admonition-title">Example of partial pivoting</p>
<p>Suppose that we have the matrix \(\pmb{A}\) from before</p>
<p>\[
A =
\begin{bmatrix}
5 &amp; 7 &amp; 5 &amp;  9 \\
5 &amp; 14 &amp; 7 &amp; 10 \\
20 &amp; 77 &amp;41 &amp; 48 \\
25 &amp; 91 &amp; 55 &amp; 67 \\
\end{bmatrix}
\]</p>
<p>and then we do some timeskipping and skip to partway through</p>
<p>\[
A =
\begin{bmatrix}
5 &amp; 7 &amp; 5 &amp;  9 \\
0 &amp; 7 &amp; 2 &amp; 1 \\
0 &amp; 49 &amp;21 &amp; 12 \\
0 &amp; 56 &amp; 30 &amp; 22 \\
\end{bmatrix}.
\]</p>
<p>Now, magic happens for the sake of illustrating the partial pivoting - “magic magic poof poof and magically \(7\) becomes \(0\)”:</p>
<p>\[
A =
\begin{bmatrix}
5 &amp; 7 &amp; 5 &amp;  9 \\
0 &amp; 0 &amp; 2 &amp; 1 \\
0 &amp; 49 &amp;21 &amp; 12 \\
0 &amp; 56 &amp; 30 &amp; 22 \\
\end{bmatrix}
\]</p>
<p>Suppose that the matrix storing our unknowns is</p>
<p>\[
\pmb{x} =
\begin{bmatrix}
x \\
y \\
z \\
\text{letter after }z
\end{bmatrix}
\]</p>
<p>And the matrix storing the results of our equations, after all of the Gaussian elimination previously that have modified the matrix \(\pmb{b}\)</p>
<p>\[
\pmb{b} =
\begin{bmatrix}
b_1 \\
b_2 \\
b_3 \\
b_4
\end{bmatrix}
\]</p>
<p>Writing this in equation this would be</p>
<p>\[
5x + 7y + 5z + 9(\text{letter after }z) = b_1 \\
0x + 0y + 2z + 1(\text{letter after }z) = b_2 \\
0x + 49y + 21z + 12(\text{letter after }z) = b_3  \\
0x + 56y + 30z + 22(\text{letter after }z) = b_4
\]</p>
<p>Now, we are going to use equation 2 and equation 3</p>
<p>\[
A =
\begin{bmatrix}
5 &amp; 7 &amp; 5 &amp;  9 \\
0 &amp; 0 &amp; 2 &amp; 1 \\
0 &amp; 49 &amp;21 &amp; 12 \\
0 &amp; 56 &amp; 30 &amp; 22 \\
\end{bmatrix}
\]</p>
<p>The coefficient of the second unknown in the second equation is 0. The coefficient of the second unknown in the third equation is 49. Thus, I will divide the coefficient of the 3rd equation with the coefficient of the 2nd equation, and then I would multiply the coefficient of the 3rd equation by the quotient. As such, I will divide \(49/0\), and then, I will get an error since you cannot divide by \(0\). It does not neccesarily have to be \(0\) to give errors, even if it is very close to \(0\), it will still give an error.</p>
<p>Thus what can I do?</p>
<p>Well, I need two equations. I cannot use the equation 2 because there is a \(0\). Then, I will use equation 3 and equation 4. Therefore, let’s swap the position of equation 4 and equation 2.</p>
<p>\[
A =
\begin{bmatrix}
5 &amp; 7 &amp; 5 &amp;  9 \\
0 &amp; 56 &amp; 30 &amp; 22 \\
0 &amp; 49 &amp;21 &amp; 12 \\
0 &amp; 0 &amp; 2 &amp; 1 \\
\end{bmatrix}
\]</p>
<p>Remember when you swap rows in matrix \(\pmb{A}\), you must also swap rows in the matrix \(\pmb{b}\). Matrix \(\pmb{x}\) does not have to swapped since the order of the variables has not changed.</p>
<p>The matrix storing our unknowns remains</p>
<p>\[
\pmb{x} =
\begin{bmatrix}
x \\
y \\
z \\
\text{letter after }z
\end{bmatrix}
\]</p>
<p>And the matrix storing the results of our equations</p>
<p>\[
\pmb{b} =
\begin{bmatrix}
b_1 \\
b_4 \\
b_3 \\
b_2
\end{bmatrix}
\]</p>
<p>Writing this in equation this would be</p>
<p>\[
5x + 7y + 5z + 9(\text{letter after }z) = b_1 \\
0x + 56y + 30z + 22(\text{letter after }z) = b_4 \\
0x + 49y + 21z + 12(\text{letter after }z) = b_3  \\
0x + 0y + 2z + 1(\text{letter after }z) = b_2
\]</p>
<p>Inspecting this equation, we see that the equation is essentially the same as it was before the swap, so we can say that our action to swap it is a valid action. I have rewritten the equation before the swap as reference</p>
<p>\[
5x + 7y + 5z + 9(\text{letter after }z) = b_1 \\
0x + 0y + 2z + 1(\text{letter after }z) = b_2 \\
0x + 49y + 21z + 12(\text{letter after }z) = b_3  \\
0x + 56y + 30z + 22(\text{letter after }z) = b_4
\]</p>
<p>Now let’s continue, after we finished swapping, and we will focus only on getting to the upper triangle form, and only on matrix \(\pmb{A}\). The matrix \(\pmb{b}\) will also change accordingly as detailed in the previous lecture, but let’s focus on matrix \(\pmb{A}\):</p>
<p>\[
A =
\begin{bmatrix}
5 &amp; 7 &amp; 5 &amp;  9 \\
0 &amp; 56 &amp; 30 &amp; 22 \\
0 &amp; 56 &amp; 24 &amp; 96/7 \\
0 &amp; 0 &amp; 2 &amp; 1 \\
\end{bmatrix}
\]</p>
<p>\[
A =
\begin{bmatrix}
5 &amp; 7 &amp; 5 &amp;  9 \\
0 &amp; 56 &amp; 30 &amp; 22 \\
0 &amp; 0 &amp; -6 &amp; 96/7 -22 \\
0 &amp; 0 &amp; 2 &amp; 1 \\
\end{bmatrix}
\]</p>
<p>We will not encounter the problem with dividing by zero anymore, at least for this matrix.</p>
<p>This matrix was nice and only required one swap. But if your matrix has lots of \(0\) or very small numbers, then maybe you might need more swaps. You might also want to nondimensionalize that matrix. That is, of course assuming that the equations contain enough information to actually allow you to solve the equation. You could use the determinant, or the <a class="reference internal" href="12_Gaussian_elimination.html#nm-gauss-jordan-elimination"><span class="std std-ref">Gauss-Jordan elimination</span></a> to check if there is actually a solution. You should always check the solvability of an equation before solving it, since trying to solve an equation which cannot be solved is wasted effort.</p>
<p>You could use conditionals to control the swapping or the skipping of rows. Although the example here used \(0\), it could be a very small number too, and not neccesary \(0\) that could cause the problem, so maybe it would be nice to compare the conditional to a certain threshold to decided whether to swap or not.</p>
</div>
<p>Example partial pivoting using <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code>:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">sl</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">],</span>
               <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span>  <span class="mf">7.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">77.</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">48.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">91.</span> <span class="p">,</span><span class="mf">55.</span><span class="p">,</span> <span class="mf">67.</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A =&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># P here is a &#39;permutation matrix&#39; that performs</span>
<span class="c1"># swaps based upon partial pivoting</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P =&quot;</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

<span class="c1"># The lower-triangular matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

<span class="c1"># The upper-triangular matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

<span class="c1"># Double check that P*L*U does indeed equal A</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Does P*L*U = A?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">P</span> <span class="o">@</span> <span class="n">L</span> <span class="o">@</span> <span class="n">U</span><span class="p">,</span> <span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A = [[ 5.  7.  5.  9.]
 [ 5. 14.  7. 10.]
 [20. 77. 41. 48.]
 [25. 91. 55. 67.]]
P = [[0. 1. 0. 0.]
 [0. 0. 0. 1.]
 [0. 0. 1. 0.]
 [1. 0. 0. 0.]]
[[ 1.          0.          0.          0.        ]
 [ 0.2         1.          0.          0.        ]
 [ 0.8        -0.375       1.          0.        ]
 [ 0.2         0.375       0.33333333  1.        ]]
[[ 25.          91.          55.          67.        ]
 [  0.         -11.2         -6.          -4.4       ]
 [  0.           0.          -5.25        -7.25      ]
 [  0.           0.           0.           0.66666667]]
Does P*L*U = A? True
</pre></div>
</div>
</div>
</div>
<p>Looking at the form of \(P\) above, we can re-order the rows in advance and consider the LU decomposition of the matrix where \(P=I\), as below. As we haven’t bothered implementing pivoting ourselves, check that your LU implementation recreates the \(A\), \(L\) and \(U\) below.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">25.</span> <span class="p">,</span><span class="mf">91.</span> <span class="p">,</span><span class="mf">55.</span> <span class="p">,</span><span class="mf">67.</span><span class="p">],</span>
               <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">7.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">],</span> 
               <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">77.</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">48.</span><span class="p">],</span>
               <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A =&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># P here is a &#39;permutation matrix&#39; that performs</span>
<span class="c1"># swaps based upon partial pivoting</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P =&quot;</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

<span class="c1"># The lower-triangular matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

<span class="c1"># The upper-triangular matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

<span class="c1"># Double check that P*L*U does indeed equal A</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Does P*L*U = A?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">P</span> <span class="o">@</span> <span class="n">L</span> <span class="o">@</span> <span class="n">U</span><span class="p">,</span> <span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A = [[25. 91. 55. 67.]
 [ 5.  7.  5.  9.]
 [20. 77. 41. 48.]
 [ 5. 14.  7. 10.]]
P = [[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
[[ 1.          0.          0.          0.        ]
 [ 0.2         1.          0.          0.        ]
 [ 0.8        -0.375       1.          0.        ]
 [ 0.2         0.375       0.33333333  1.        ]]
[[ 25.          91.          55.          67.        ]
 [  0.         -11.2         -6.          -4.4       ]
 [  0.           0.          -5.25        -7.25      ]
 [  0.           0.           0.           0.66666667]]
Does P*L*U = A? True
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>Implementation<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>See below the code implementation to partial pivoting:</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function is not necessary but makes the LU_dec_pp function less cluttered</span>
<span class="c1"># Making general operations into functions is good way of improving readability</span>
<span class="c1"># and reducing your workload later!</span>
<span class="k">def</span> <span class="nf">swap_rows</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,:])</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span>
    <span class="c1"># second label, BUT NOT CREATING A 2ND ARRAY.</span>
    <span class="c1"># Try it for yourself if you want.</span>
    <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">B</span>
    <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">C</span>
    <span class="k">return</span> <span class="n">A</span>

<span class="c1"># A function to perform LU decomposition with partial pivoting</span>
<span class="k">def</span> <span class="nf">LU_dec_pp</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># we won&#39;t modify in place but create local copy</span>
    <span class="n">P_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">L</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">:,</span><span class="n">k</span><span class="p">]))</span> 
        <span class="c1"># Find the index of the largest ABSOLUTE value. np.argmax will return </span>
        <span class="c1"># the index of the largest element in an array</span>
        <span class="n">j</span><span class="o">+=</span> <span class="n">k</span>               <span class="c1"># A[1+2,2] = A[3,2] = 3!        </span>
        <span class="n">A</span>  <span class="o">=</span> <span class="n">swap_rows</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
        <span class="n">P_</span> <span class="o">=</span> <span class="n">swap_rows</span><span class="p">(</span><span class="n">P_</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">:]</span><span class="o">*</span><span class="n">s</span>  
            <span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">A</span>   
    <span class="k">return</span> <span class="n">P_</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span>  <span class="mf">7.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">77.</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">48.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">91.</span> <span class="p">,</span><span class="mf">55.</span><span class="p">,</span> <span class="mf">67.</span><span class="p">]])</span>

<span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">LU_dec_pp</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">U</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Have we succeeded in creating partial pivoting?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">U</span><span class="p">)),</span> <span class="n">A</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.,  7.,  5.,  9.],
       [ 5., 14.,  7., 10.],
       [20., 77., 41., 48.],
       [25., 91., 55., 67.]])
array([[ 1.        ,  0.        ,  0.        ,  0.        ],
       [ 0.2       ,  1.        ,  0.        ,  0.        ],
       [ 0.8       , -0.375     ,  1.        ,  0.        ],
       [ 0.2       ,  0.375     ,  0.33333333,  1.        ]])
array([[ 25.        ,  91.        ,  55.        ,  67.        ],
       [  0.        , -11.2       ,  -6.        ,  -4.4       ],
       [  0.        ,   0.        ,  -5.25      ,  -7.25      ],
       [  0.        ,   0.        ,   0.        ,   0.66666667]])
array([[ 5.,  7.,  5.,  9.],
       [ 5., 14.,  7., 10.],
       [20., 77., 41., 48.],
       [25., 91., 55., 67.]])
Have we succeeded in creating partial pivoting? True
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "primer-computational-mathematics/book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./c_mathematics/numerical_methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="12_Gaussian_elimination.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Gaussian elimination</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="14_ill_conditioning_errors.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ill-conditioning and roundoff errors</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Imperial College London<br/>
  
      &copy; Copyright 2020.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>