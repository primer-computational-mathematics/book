
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Numerical differentiation &#8212; ESE Jupyter Material</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".cell"
const thebe_selector_input = ".cell_input div.highlight"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Solving or timestepping an ODE" href="3_Timestepping_an_ODE.html" />
    <link rel="prev" title="Interpolation and curve fitting" href="1_Interpolation_curve_fitting.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ESE Jupyter Material</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Landing page
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../a_modules/intro.html">
   Modules
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../b_coding/intro.html">
   Coding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../b_coding/NumPy_Arrays.html">
     NumPy arrays
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/intro.html">
     Fundamentals of Computer Science
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/1_Algorithmic_Complexity.html">
       Algorithmic complexity
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/2_Recursion.html">
       Recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/3_Divide_and_Conquer.html">
       Divide and Conquer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/4_Dynamic_Programming.html">
       Dynamic Programming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/5_Greedy_Algorithms.html">
       Greedy Algorithms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/6_Data_Structures.html">
       Data Structures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/7_Graph_Algorithms.html">
       Graph Algorithms
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Intro%20to%20Python/intro.html">
     Intro to Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/1_Printing_and_formatting_statements.html">
       Printing and formatting statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/2_Variables.html">
       Variables
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/3_If_statement.html">
       If statement
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/4_While_loops.html">
       While loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/5_Lists.html">
       Lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/6_For_loops.html">
       For loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/7_List_comprehensions.html">
       List comprehensions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/8_Nested_lists.html">
       Nested lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/9_Handling_errors.html">
       Handling errors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/10_Importing.html">
       Importing in Python
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/11_Functions.html">
       Creating custom functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/12_Tuples.html">
       Tuples
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/13_File_handling.html">
       File handling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/14_Dictionaries.html">
       Dictionaries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/15_Flow_control_statements.html">
       Flow control statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/16_Sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/17_Matplotlib.html">
       Plotting data with Matplotlib
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/18_Assert.html">
       Assert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/19_Classes.html">
       Python classes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/20_Lambdas.html">
       Lambdas
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Machine%20Learning/intro.html">
     Machine learning
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%200%20--%20Introduction.html">
       Chapter 0 – Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%201%20--%20Neural%20Network.html">
       Chapter 1 – Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%202%20--%20Maximum%20Likelihood.html">
       Chapter 2 – Maximum Likelihood
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%203%20--%20Cross%20Entropy.html">
       Chapter 3 – Cross Entropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%204%20--%20Cost%20Function.html">
       Chapter 4 – Cost Function
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%205%20--%20Gradient%20Descent%201.html">
       Chapter 5 – Gradient Descent 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%206%20--%20Gradient%20Descent%202.html">
       Chapter 6 – Gradient Descent 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%207%20--%20Real%20%28Non-linear%29%20Neural%20Network.html">
       Chapter 7 – Real (Non-linear) Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%208%20--%20Feedforward.html">
       Chapter 8 – Feedforward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%209%20--%20Back%20Propagation.html">
       Chapter 9 – Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2010%20--%20General%20Back%20Propagation.html">
       Chapter 10 – General Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2011%20--%20Underfitting%20and%20Overfitting.html">
       Chapter 11 – Underfitting and Overfitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2012%20--%20Early-stopping%2C%20Dropout%20%26%20Mini-batch.html">
       Chapter 12 – Early-stopping, Dropout &amp; Mini-batch
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2013%20--%20Vanishing%20Gradient%201.html">
       Chapter 13 – Vanishing Gradient 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2014%20--%20Vanishing%20Gradient%202.html">
       Chapter 14 – Vanishing Gradient 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2015%20--%20Regularisation.html">
       Chapter 15 – Regularisation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2016%20--%20Other%20Activation%20Functions.html">
       Chapter 16 – Other Activation Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2017%20--%20Local%20Minima%20Trap.html">
       Chapter 17 – Local Minima Trap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2018%20--%20Softmax.html">
       Chapter 18 – Softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2019%20--%20Hyper-Parameters.html">
       Chapter 19 – Hyper-Parameters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Machine%20Learning/Chapter%2020%20--%20Coding%20Example.html">
       Chapter 20 – Coding Example
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Pandas/intro.html">
     Pandas
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/1_basics.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/2_filter_select_assign.html">
       Filtering, selecting and assigning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/3_merge_combine_group_sort.html">
       Merging, combining, grouping and sorting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/4_summary_statistics.html">
       Summary statistics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/5_time_stamps.html">
       Creating date-time stamps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/6_plotting.html">
       Plotting
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Programming%20Tools/intro.html">
     Programming tools
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Programming%20Tools/1_Version_Control_Git.html">
       Version control Git
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro.html">
   Mathematics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../basic_maths/intro.html">
     Basic Maths
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/1_logic.html">
       Logic and proof
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/2_sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/3_functions.html">
       Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/4_elementary_functions_1.html">
       Elementary functions 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/5_elementary_functions_2.html">
       Elementary functions 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/6_composition_and_inverse.html">
       Composition and Inverse Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/7_Coordinate_Systems.html">
       Coordinate systems
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic_maths/8_Vectors.html">
       Vectors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../calculus/intro.html">
     Calculus
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../calculus/Multivariable_Calculus.html">
       Multivariable calculus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../calculus/Vector_Calculus_MM1.html">
       Vector calculus (MM1)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../calculus/Vector_Calculus_MM3.html">
       Vector calculus (MM3)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../complex_analysis/intro.html">
     Complex analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/1_introduction.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/2_complex_plane.html">
       Complex plane
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/3_complex_functions.html">
       Complex functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/4_holomorphic_functions.html">
       Holomorphic functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/5_integrating.html">
       Complex integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../complex_analysis/6_fractals.html">
       Fractals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../differential_equations/intro.html">
     Differential equations
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/1_de_introduction.html">
       Introduction to differential equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/2_linear_des.html">
       Linear Differential Equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/3_first-order_odes.html">
       First-order ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/4_higher_ord_lin_odes.html">
       Higher order Linear ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/5_ode_series.html">
       Series ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/6_pde_basicdefinitions.html">
       Introductory definitions and concepts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/7_pde_first_order.html">
       First-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/8_pde_second_order.html">
       Canonical form of second-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/9_poisson_laplace_eq.html">
       Poisson’s and Laplace’s equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/10_heat_eq.html">
       Heat (diffusion) equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/11_pde_fourier.html">
       Solving PDEs with fourier methods
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/12_wave_eq.html">
       Wave equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/13_similarity_solutions.html">
       Self-similar solutions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../differential_equations/ODEs_MM1.html">
       ODEs
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../linear_algebra/intro.html">
     Linear algebra
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/1_Basic_definitions_and_operations.html">
       Basic definitions and operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/2_Linear_Systems.html">
       Systems of linear equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/3_Theory.html">
       Theory
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/4_Eigenvalues_and_eigenvectors.html">
       Eigenvalues and eigenvectors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/5_Linear_Algebra_in_Python.html">
       Linear Algebra in Python
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/5_Matrices.html">
       Matrices
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../linear_algebra/6_Eigenvalues.html">
       Eigenvalues
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../mathematical_notation/intro.html">
     Mathematical notation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../mathematical_notation/Big_O_notation.html">
       Big O notation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../mathematical_notation/Tensors_Review.html">
       Review of tensors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="intro.html">
     Numerical methods
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="1_Interpolation_curve_fitting.html">
       Interpolation and curve fitting
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Numerical differentiation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="3_Timestepping_an_ODE.html">
       Solving or timestepping an ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="4_Heuns_method.html">
       Heun’s method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="5_Runge_Kutta_method.html">
       Runge-Kutta method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="6_Solving_PDEs_SOR.html">
       Successive over-relaxation method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="7_FTCS.html">
       FTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="8_BTCS.html">
       BTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="9_Numerical_integration.html">
       Numerical integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="10_Roots_of_equations.html">
       Roots of equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="11_linear_algebra_intro.html">
       Linear algebra introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="12_Gaussian_elimination.html">
       Gaussian elimination
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="13_LU_decomposition.html">
       LU decomposition
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="14_ill_conditioning_errors.html">
       Ill-conditioning and roundoff errors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="15_iterative_methods_to_solve_matrix.html">
       Iterative methods to solve a matrix
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Intro_to_Modelling.html">
       Introduction to Modelling
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../series_and_sequences/intro.html">
     Series and sequences
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Basic_Sequences_Series.html">
       Sequences and Series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Fourier_series.html">
       Fourier series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Fourier_transforms.html">
       Fourier transforms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../series_and_sequences/Taylor_series.html">
       Taylor series
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../statistics/intro.html">
     Statistics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../statistics/Linear_Regression.html">
       Linear regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../statistics/Statistics_for_Geoscientists.html">
       Introduction to statistics for Geoscientists
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../d_geosciences/intro.html">
   Geosciences
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Applied%20Geophysics/intro.html">
     Applied Geophysics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Applied%20Geophysics/1D_Resistivity_Forward_Modelling.html">
       1D resistivity forward modelling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Applied%20Geophysics/Gravity%20correction.html">
       Gravity corrections
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Applied%20Geophysics/Magnetic%20surveys.html">
       Magnetic surveys
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Climate/intro.html">
     Climate
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Climate/Climate_Model.html">
       Climate model
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Continental%20Tectonics/intro.html">
     Continental Tectonics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Continental%20Tectonics/Isostasy.html">
       Isostasy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Continental%20Tectonics/Lithospheric_Strength.html">
       Lithospheric Strength
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Continental%20Tectonics/Ridge_Push_and_Slab_Pull.html">
       Ridge Push and Slab Pull
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Deforming%20the%20Earth/intro.html">
     Deforming the Earth
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Deforming%20the%20Earth/Basics_of_Stress_and_Strain.html">
       Basics of Stress and Strain
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Electromagnetism/intro.html">
     Electromagnetism
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/1_electricity_magnetism.html">
       Electricity and magnetism
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/2_maxwell_eqs.html">
       Maxwell’s equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Electromagnetism/3_four_field.html">
       The four-field formalism
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Geodynamics%20%28Fluid%20Dynamics%29/intro.html">
     Geodynamics (Fluid Dynamics)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geodynamics%20%28Fluid%20Dynamics%29/1D_Heat_Conduction.html">
       1D heat conduction (layered medium)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geodynamics%20%28Fluid%20Dynamics%29/Lecture5_1D_Pipe_Flow.html">
       1D Pipe Flow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geodynamics%20%28Fluid%20Dynamics%29/Lecture6_Non_Linear_Viscosity_2D_Stokes.html">
       Non Linear Viscosity 2D Stokes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geodynamics%20%28Fluid%20Dynamics%29/Lecture7_Pipe_Flow_with_Heat.html">
       Pipe Flow with Heat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geodynamics%20%28Fluid%20Dynamics%29/Lecture8_Part1_Navier_Stoke_Equation.html">
       Navier Stoke Equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geodynamics%20%28Fluid%20Dynamics%29/Lecture8_Part2_SPH_Algorithm_For_Energy_Equation.html">
       SPH Algorithm for Energy Equation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics%20of%20the%20Oceans/intro.html">
     Geophysical Fluid Dynamics of the Oceans
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics%20of%20the%20Oceans/Mixed%20layer.html">
       The mixed layer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics%20of%20the%20Oceans/Stream%20lines.html">
       Stream functions and stream lines
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics%20of%20the%20Oceans/Tides.html">
       Tides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Geophysical%20Fluid%20Dynamics%20of%20the%20Oceans/Water%20wave%20dispersion.html">
       Water wave dispersion
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Gravity%2C%20Magnetism%2C%20and%20Orbital%20Dynamics/intro.html">
     Gravity, Magnetism, and Orbital Dynamics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
    <label for="toctree-checkbox-25">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Gravity%2C%20Magnetism%2C%20and%20Orbital%20Dynamics/Keplerian_Orbits.html">
       Keplerian orbits
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/intro.html">
     High-Temperature Geochemistry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
    <label for="toctree-checkbox-26">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Distribution_Coefficients.html">
       Distribution coefficients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Evaporation_and_Condensation.html">
       Evaporation and Condensation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Isotope_Systematics_of_Mixing.html">
       Isotope Systematics of Mixing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Lu-Hf_Decay.html">
       Lu-Hf Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Major_and_Trace_Elements.html">
       Major and trace elements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Melting_and_Crystalisation.html">
       Melting and crystalisation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Nuclides.html">
       Nuclides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Radioactive_Dating.html">
       Radioactive Dating
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Rb-Sr_Decay.html">
       Rb-Sr Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Re-Os_Decay.html">
       Re-Os Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Sm-Nd_Decay.html">
       Sm-Nd Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/Stable_Isotope_Geochemistry%20.html">
       Stable Isotope Geochemistry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/High-Temperature%20Geochemistry/U-Th-Pb_Decay.html">
       U-Th-Pb Decay
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/intro.html">
     Low-Temperature Geochemistry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
    <label for="toctree-checkbox-27">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Arrhenius_Equation.html">
       Arrhenius Equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/CO2_H2O_System.html">
       CO2-H2O System
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Defining_Activity_Coefficients.html">
       Defining activity coefficients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Hess_Law.html">
       Hess’ law
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Pourbaix_Diagram.html">
       Pourbaix Diagram
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Rate_Law.html">
       Rate Law
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Reaction_Quotients.html">
       Reaction Quotients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Low-Temperature%20Geochemistry/Stability_Diagram.html">
       Stability Diagram
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Miscellaneous/intro.html">
     Miscellaneous
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
    <label for="toctree-checkbox-28">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Miscellaneous/Euler_Pole.html">
       Euler Pole
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Miscellaneous/Isostasy.html">
       Isostasy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Miscellaneous/Longitude_Latitude_Degree_Convertion.html">
       Reading Maps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Miscellaneous/Milankovitch_cycles.html">
       Milankovitch cycles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Miscellaneous/Seafloor_ages.html">
       Seafloor ages
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Physical%20Processes/intro.html">
     Physical Processes
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
    <label for="toctree-checkbox-29">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Dimensional_Analysis.html">
       Dimensional Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Fluids_%26_the_Bernoulli_effect.html">
       Fluids &amp; the Bernoulli effect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Heat.html">
       Heat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Physical%20Processes/Reynolds_number.html">
       Reynolds number
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Remote%20Sensing/intro.html">
     Remote Sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
    <label for="toctree-checkbox-30">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Remote%20Sensing/Image_Filtering.html">
       Image filtering
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Remote%20Sensing/Image_Point_Operations.html">
       Image point operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Remote%20Sensing/Image_Transformations_and_Orthorectification.html">
       Image transformations and orthorectification
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Tectonics%20of%20the%20Ocean/intro.html">
     Tectonics of the Ocean
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
    <label for="toctree-checkbox-31">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Tectonics%20of%20the%20Ocean/Plate_Models.html">
       Heat Flow
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/Waves/intro.html">
     Waves
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
    <label for="toctree-checkbox-32">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Attenuation.html">
       Attenuation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Fourier_Series.html">
       Fourier series in Python
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Introduction_To_Waves.html">
       Introduction to waves
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Refraction.html">
       Superposition of Waves, Reflection and Refraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/Waves/Transmission_and_Reflection.html">
       Impedance, Transmission and Reflection
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/mechanics/intro.html">
     Mechanics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/>
    <label for="toctree-checkbox-33">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/mechanics/1_Motion_in_1D.html">
       Motion in 1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/mechanics/2_Motion_in_2D.html">
       Motion in 2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/mechanics/3_Work_and_Energy.html">
       Work and Energy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/mechanics/4_Rotational_Motion.html">
       Rotational Motion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/mechanics/5_Gravity.html">
       Gravity
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../d_geosciences/seismology/intro.html">
     Seismology
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/>
    <label for="toctree-checkbox-34">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/seismology/3D_Earthquake_Focus_Plot.html">
       Plotting Earthquake Focus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/seismology/CMP_Common_Mid_Point_Gather.html">
       Common Mid-point Gather
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/seismology/Downloading_earthquake_data.html">
       Downloading earthquake data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/seismology/Ghosting.html">
       Ghosting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/seismology/Spatial_aliasing.html">
       Spatial Aliasing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../d_geosciences/seismology/Temporal_aliasing.html">
       Temporal Aliasing
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../e_extra/intro.html">
   Further resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/>
  <label for="toctree-checkbox-35">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Camera_Calibration.html">
     Camera calibration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Cartography_Cartopy.html">
     Cartopy (maps)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Dakota.html">
     Dakota
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Foundations.html">
     Google Earth Engine foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Getting_Started_.html">
     Google Earth Engine getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Particle_Image_Velocimetry.html">
     Particle image velocimetry (PIV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/contributors_guide.html">
     Contributor’s guide
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../e_extra/UAV_Mapping/intro.html">
     UAV Mapping
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/>
    <label for="toctree-checkbox-36">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/UAV_Mapping/1.Mission_Planning.html">
       1. Mission Planning
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/primer-computational-mathematics/book/master?urlpath=tree/notebooks/c_mathematics/numerical_methods/2_Numerical_differentiation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/primer-computational-mathematics/book/issues/new?title=Issue%20on%20page%20%2Fc_mathematics/numerical_methods/2_Numerical_differentiation.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/c_mathematics/numerical_methods/2_Numerical_differentiation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition">
   Definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forward-difference-method-fdm">
   Forward difference method (FDM)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-accuracy">
   Estimating accuracy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taylor-series-example">
     Taylor series example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fdm-accuracy">
     FDM accuracy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#central-difference-method-cdm">
   Central difference method (CDM)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#second-derivative">
     Second derivative
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-differential-equations">
   Solving differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#euler-method">
     Euler method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heun-s-method">
     Heun’s method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runge-kutta-method">
     Runge-Kutta method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#successive-over-relaxation-method">
     Successive over-relaxation method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward-time-centred-space-method">
     Forward Time Centred Space method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-function-to-perform-numerical-differentiation">
     A function to perform numerical differentiation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derivative-of-sin-x">
     Derivative of \(sin(x)\)
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Numerical differentiation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition">
   Definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forward-difference-method-fdm">
   Forward difference method (FDM)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-accuracy">
   Estimating accuracy
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taylor-series-example">
     Taylor series example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fdm-accuracy">
     FDM accuracy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#central-difference-method-cdm">
   Central difference method (CDM)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#second-derivative">
     Second derivative
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-differential-equations">
   Solving differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#euler-method">
     Euler method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heun-s-method">
     Heun’s method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#runge-kutta-method">
     Runge-Kutta method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#successive-over-relaxation-method">
     Successive over-relaxation method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward-time-centred-space-method">
     Forward Time Centred Space method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-function-to-perform-numerical-differentiation">
     A function to perform numerical differentiation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derivative-of-sin-x">
     Derivative of \(sin(x)\)
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="numerical-differentiation">
<span id="nm-num-differentiation"></span><h1>Numerical differentiation<a class="headerlink" href="#numerical-differentiation" title="Permalink to this headline">#</a></h1>
<p><a class="reference internal" href="../../a_modules/intro.html#module-nm"><span class="std std-ref"><!-- module-nm badge --><span class="module module-nm">Numerical Methods</span></span></a></p>
<section id="definition">
<span id="index-0"></span><h2>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">#</a></h2>
<p>The classical definition of the derivative of a function \(f\) at a point \(x_0\) is of given by:</p>
<p>\[f’(x_0)=\lim_{h\rightarrow 0} \frac{f(x_0+h)-f(x_0)}{h}.\]</p>
<div class="admonition-notation admonition">
<p class="admonition-title">Notation</p>
<ol>
<li><p>Note that the following are all equivalent mathematical ways of writing the derivative of the function \(f\) with respect to \(x\) and evaluated at the location \(x_0\):</p>
<p>\[f’(x_0) = \frac{df}{dx}(x_0) = \left.\frac{df}{dx}\right|_{x_0}.\]</p>
</li>
<li><p>We’re using \(h\) here to denote a small (potentially infinitesimally small) increment to the \(x\) coordinate, as is common. But note that in the literature \(\Delta x\) is commonly used to mean the same thing. Also, for finite \(h\) there is significant overlap here with the mesh spacing in a numerical approximation, as we shall see below, and so \(\Delta x\) is also used.</p></li>
</ol>
</div>
<p>To find the 1st derivative, you will differentiate a function once. To find the 2nd derivative, you will differentiate a function twice. While for many functions, there are analytical solutions, there are also many important functions that do not have analytical solutions. However, finding the differentiation of these function could be important for studying the change of these functions, so numerical differentiation is neccesary.</p>
<p>There are several different ways that numerical differentiation can be done, and each with their merits and demerits. Higher order accuracy in the numerical differentiation would require more sophisticated methods of numerical differentiation.</p>
<p>One of the popular ways to do numerical differentiation is through <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference"><strong>finite difference</strong></a>. To evaluate the derivative at a point termed \(x_0\), the finite difference method uses point or points around the point \(x_0\) to find the derivative at the point \(x_0\).</p>
</section>
<section id="forward-difference-method-fdm">
<span id="nm-forward-difference"></span><h2>Forward difference method (FDM)<a class="headerlink" href="#forward-difference-method-fdm" title="Permalink to this headline">#</a></h2>
<p id="index-1">The forward difference is a method of finding the derivative at a point. The forward difference works by taking the gradient between a point \(x_0\) and a point in front of \(x_0\). As the point in front of \(x_0\) becomes closer and closer to \(x_0\), then the gradient between \(x_0\) and the point in front of \(x_0\) becomes closer and closer to the derivative of the function at \(x_0\). Because this method uses a point in front of \(x_0\), it has <em>forward</em> in its name, and because it uses the difference between \(x_0\) and the point in front of \(x_0\), it has <em>difference</em> in its name.</p>
<p>For example, we can turn the formal definition of a derivative given above into an approximation rule by replacing the limit as \(h\) approaches zero (i.e. the \(\text{lim}_{h\rightarrow\infty}\)) with a small but finite \(\Delta x\) value:</p>
<p>\[ f’(x_0)\approx \frac{f(x_0+\Delta x)-f(x_0)}{\Delta x},\quad \Delta x&gt;0. \]</p>
<p>Since this approximate gradient method uses values of \(x\) greater than \(x_0\) (\(\Delta x&gt;0\)), this algorithm is known as the <strong>forward difference method</strong>.</p>
<p>The figure below illustrates this approximation.</p>
<div class="cell_output docutils container">
<img alt="../../_images/2_Numerical_differentiation_1_0.png" src="../../_images/2_Numerical_differentiation_1_0.png" />
</div>
<p>In the figure the derivative is approximated by the slope of the red line, while the true derivative is the slope of the blue line - if the second (and/or higher) derivative of the function is large then this approximation might not be very good, unless you make \(\Delta x\) very small:</p>
<div class="cell_output docutils container">
<img alt="../../_images/2_Numerical_differentiation_2_0.png" src="../../_images/2_Numerical_differentiation_2_0.png" />
</div>
<div class="dropdown admonition">
<p class="admonition-title">Exercise: compute first derivative with FDM</p>
<p>Find an approximation to \(f’(2.36)\) from the following data:</p>
<p>\[f(2.36) = 0.85866,\\
f(2.37) = 0.86289,\]</p>
<p>using the forward difference scheme.</p>
<p>Solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span> <span class="o">=</span> <span class="mf">2.37</span><span class="o">-</span><span class="mf">2.36</span>
<span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.86289</span><span class="o">-</span><span class="mf">0.85866</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Derivative with FDM = </span><span class="si">%.5f</span><span class="s2">. &quot;</span> <span class="o">%</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>The answer should be 0.423.</p>
</div>
</section>
<section id="estimating-accuracy">
<h2>Estimating accuracy<a class="headerlink" href="#estimating-accuracy" title="Permalink to this headline">#</a></h2>
<p>As previously discussed, there are many different methods that are possible to use for numerical differentiation. Ultimately, all methods will move closer to the derivative of the function at the point \(x_0\) as the \(\Delta x\) used becomes smaller and smaller. What differentiates a good method from a bad  method is how accurate the estimate for the derivative is, given that all methods have the same \(\Delta x\) in their equation. Thus what makes a method good/bad is the accuracy of the method.</p>
<p>We can use a <a class="reference internal" href="../series_and_sequences/Taylor_series.html#taylor-series"><span class="std std-ref">Taylor series</span></a> expansion, or Taylor series analysis, to estimate the accuracy of the method. Recall that Taylor series in one dimension tells us that we can approximate the value of the function at a location in terms of its value, and value of its derivative, at a nearby point:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
f(x_0+h) &amp;= f(x_0) + hf'(x_0) + \frac{h^2}{2!}f''(x_0) + \frac{h^3}{3!}f'''(x_0) + \ldots\\[5pt]
&amp;= f(x_0)+hf'(x_0) + \frac{h^2}{2!}f''(x_0) + \mathcal{O}(h^3),
\end{align*}
\end{split}\]</div>
<p>where \(\mathcal{O}(h^3)\) represents the collection of terms that are third-order in \(h\) or higher. We call this the Taylor series expansion about (or around) the point \(x_0\) (since all the functions in the expansion on the RHS are evaluated at this point). An equivalent way of writing this expansion would be (just define \(x\) to be \(x_0+h\))</p>
<p>\[f(x) = f(x_0) + (x - x_0) f’(x_0) + \frac{(x - x_0)^2}{2!} f’’(x_0) + \frac{(x - x_0)^3}{3!} f’’’(x_0) + \mathcal{O}((x - x_0)^4).\]</p>
<p>The error increases if \(\Delta x\) increase, while the error decreases if the \(\Delta x\) decreases.</p>
<p>1st order accuracy means that the error and \(\Delta x\) are in a linear relationship. As we make the spacing smaller we expect the error in our derivative to fall linearly, meaning that if we made the spacing 2 times smaller, the error becomes 2 times smaller.</p>
<section id="taylor-series-example">
<h3>Taylor series example<a class="headerlink" href="#taylor-series-example" title="Permalink to this headline">#</a></h3>
<p>The figure below represents an exponential function (in blue) and the sum of the first (\(n+1\)) terms of its Taylor series expansion around the point 0 (in red).</p>
<p style="text-align:center;"><img src="https://upload.wikimedia.org/wikipedia/commons/6/62/Exp_series.gif" width="300px"></p>
<p>Source: <a class="reference external" href="https://upload.wikimedia.org/wikipedia/commons/6/62/Exp_series.gif">Wikipedia</a></p>
<p>As can be seen, more terms in the Taylor series means that the function resulting from the Taylor series better match with the actual function. It also means that the Taylor series better match with the function at greater distance away form point 0. Of course, if we are very close to the point 0, then the function obtained from Taylor series with more terms has very little difference to the function obtained from Taylor series with fewer terms; however, if we move further away from the point 0, then the function obtained from Taylor series with more terms remains accurate, while the numerical derivative from the Taylor series with less terms deviates significantly.</p>
</section>
<section id="fdm-accuracy">
<span id="nm-fdm-accuracy"></span><h3>FDM accuracy<a class="headerlink" href="#fdm-accuracy" title="Permalink to this headline">#</a></h3>
<p>Forward difference method is 1st order accurate. Let’s prove it with Taylor series.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Note</p>
<p>We state that forward difference method is a numerical differentiation method, that has a certain order of accuracy when finding the numerical derivative at the point \(x_0\). The Taylor series is exact, meaning that the left hand side of the Taylor series is exactly equal to the right hand side of the Taylor series. It should also be noted that moving terms form left hand side of the Taylor series to the right hand side of the Taylor series does not affec the equality of the Taylor series.</p>
</aside>
<p>To find the accuracy of a numerical differentiation method, we need a comparison between the numerical differentiation method and something exact; thus, we will compare the forward difference method to the Taylor series (exact solution), to understand how much does the estimate differ from the exact.</p>
<p>Forward difference method:
\[ f’(x_0)\approx \frac{f(x_0+\Delta x)-f(x_0)}{\Delta x},\quad \Delta x&gt;0. \]</p>
<p>Taylor series:
\[ f(x_0+h) = f(x_0) + hf’(x_0) + \frac{h^2}{2!}f’’(x_0) + \frac{h^3}{3!}f’’’(x_0) + \ldots.\]</p>
<p>Since both \(h\) and \(\Delta x\) refer to very small numbers, by assuming that \(h &gt; 0\) we could say that \(h \approx \Delta x\), and thus rewrite as:</p>
<p>\[ f’(x_0)\approx \frac{f(x_0+h)-f(x_0)}{h},;;;; h&gt;0,\\
f(x_0+h) = f(x_0) + hf’(x_0) + \frac{h^2}{2!}f’’(x_0) + \frac{h^3}{3!}f’’’(x_0) + \ldots.\]</p>
<p>To make comparisons, we take the common parts out, and find the parts that are different:
\[ f’(x_0)\approx \frac{f(x_0+h)-f(x_0)}{h},\quad h&gt;0,\\
\frac {f(x_0+h) - f(x_0)}{h}= f’(x_0) + \frac{h^1}{2!}f’’(x_0) + \frac{h^2}{3!}f’’’(x_0) + \ldots.\]</p>
<p>Making the same thing appear on the LFH of both the FDM and the Taylor Series:
\[\text{FDM: } f’(x_0)\approx \frac{f(x_0+h)-f(x_0)}{h},\quad h&gt;0,\\
\text{Taylor series: }f’(x_0) =  \frac {f(x_0+h) - f(x_0)}{h}   - \frac{h^1}{2!}f’’(x_0) - \frac{h^2}{3!}f’’’(x_0) + \ldots.\]</p>
<p>We see that there are differences between the FDM and the Taylor series for how the derivative of the function at the point \(x_0\) is defined. The Taylor series have several extra terms \(- \frac{h^1}{2!}f’’(x_0) - \frac{h^2}{3!}f’’’(x_0) + \ldots\) compared to the FDM. The extra terms of the Taylor series, start from the term that includes 2nd derivative of the function \(- \frac{h^1}{2!}f’’(x_0)\) and continue onwards to terms that include higher derivatives, like the 3rd, 4th. These extra terms are the difference between the Taylor series and the FDM solution.</p>
<p>The Taylor series and FDM are similar up to, and not including the 2nd derivative of the function. Thus, because the similarity between the Taylor series and the FDM does not include the 2nd derivative, or any other higher derivative, we say that the FDM is only <strong>1st order accurate</strong>.</p>
</section>
</section>
<section id="central-difference-method-cdm">
<span id="nm-central-difference"></span><h2>Central difference method (CDM)<a class="headerlink" href="#central-difference-method-cdm" title="Permalink to this headline">#</a></h2>
<p id="index-2">In an attempt to derive a more accurate method we use two Taylor series expansions - one in the positive and one in negative \(x\) direction from \(x_0\). Since we hope to achieve better than first-order accuracy, we include an extra term in the series:</p>
<p>\[
f(x_0+ \Delta x) = f(x_0)+\Delta x f’(x_0)+\frac{\Delta x^2}{2}f’’(x_0) + \mathcal{O}(\Delta x^3),\\
f(x_0- \Delta x) = f(x_0)- \Delta x f’(x_0)+\frac{(-\Delta x)^2}{2}f’’(x_0) + \mathcal{O}((-\Delta x)^3).\]</p>
<aside class="margin sidebar">
<p class="sidebar-title">Note</p>
<p>Note that we don’t worry about signs when using the \(\mathcal{O}\) notation.</p>
</aside>
<p>Using the fact that \((-\Delta x)^2=\Delta x^2\) and the absolute value signs from the definition of \(\mathcal{O}\)):</p>
<p>\[
f(x_0+\Delta x) = f(x_0)+\Delta xf’(x_0)+\frac{\Delta x^2}{2}f’’(x_0) + \mathcal{O}(\Delta x^3),\\
f(x_0-\Delta x) = f(x_0)-\Delta xf’(x_0)+\frac{\Delta x^2}{2}f’’(x_0) + \mathcal{O}(\Delta x^3).\]</p>
<p>Remember that we are looking for an expression for \(f’(x_0)\). Noticing the sign change between the derivative terms in the two equations, we subtract the second equation from the first to give:</p>
<p>\[ f(x_0+\Delta x)-f(x_0-\Delta x)=2\Delta xf’(x_0) + \mathcal{O}(\Delta x^3).\]
Finally, we can rearrange to get an expression for \(f’(x_0)\):</p>
<p>\[ f’(x_0)=\frac{f(x_0+\Delta x)-f(x_0-\Delta x)}{2\Delta x} + O(\Delta x^2),\]
which, contrary to the 1st order FDM, is an approximation to the derivative that is <strong>2nd order accurate</strong>.</p>
<p>By considering an interval symmetric about \(x_0\), we have created a second-order approximation for the derivative of \(f\). This symmetry gives the scheme its name - the <a class="reference external" href="https://en.wikipedia.org/wiki/Central_differencing_scheme">central difference method</a>.</p>
<p>The figure below illustrates this scheme:</p>
<div class="cell_output docutils container">
<img alt="../../_images/2_Numerical_differentiation_6_0.png" src="../../_images/2_Numerical_differentiation_6_0.png" />
</div>
<p>The derivative is approximated by the slope of the red line, while the true derivative is the slope of the blue line. Even without the analysis above it’s hopefully clear visually why this should in general give a lower error than the forward difference. If we halve \(h\), the error should drop by a factor of 4, rather than 2 in case of 1st order scheme.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise: compute first derivative with CDM</p>
<p>Find an approximation to \(f’(0.2)\) from the following data:</p>
<p>\[f(0.1) = 0.078348,\\
f(0.2) = 0.138910,\\
f(0.3) = 0.192916,\]</p>
<p>using the central difference scheme.</p>
<p>Solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.192916</span><span class="o">-</span><span class="mf">0.078348</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Derivative with CDM = </span><span class="si">%.5f</span><span class="s2">. &quot;</span> <span class="o">%</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>The answer should be 0.57284.</p>
</div>
<section id="second-derivative">
<span id="nm-second-derivative"></span><h3>Second derivative<a class="headerlink" href="#second-derivative" title="Permalink to this headline">#</a></h3>
<p id="index-3">Numerical differentiation may be extended to the second derivative by noting that the second derivative is the derivative of the first derivative. That is, if we define a new function \(g\) where:</p>
<p>\[ g(x) = f’(x), \]</p>
<p>then</p>
<p>\[ f’’(x) = g’(x), \]</p>
<p>a consequence of this (obvious) observation is that we can just apply our differencing formula twice in order to achieve a second derivative, and so on for even higher derivatives.</p>
<p>Recall that <a class="reference internal" href="#nm-central-difference"><span class="std std-ref">central difference method</span></a> is 2nd order accurate, and superior to the <a class="reference internal" href="#nm-forward-difference"><span class="std std-ref">forward difference method</span></a>. Therefore, we will extend the central difference method to find second derivative.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Note</p>
<p>We make this choice since we have a vision to ultimately end up with an approximation that utilises a three-point stencil. Three-point stencil means that the equation at the end will only use three points, namely
\[f(x_0+\Delta x),\ f(x_0) \text{ and } f(x_0-\Delta x)\].
If we have used \(\Delta x\) instead, the equation would need more point stencil.</p>
</aside>
<p>In order to calculate \(f’’(x_0)\) using a central difference method, we first calculate \(f’(x)\) for each of two half intervals, one to the left of \(x_0\) and one to the right:</p>
<p>\[
f’\left(x_0+\frac{\Delta x}{2}\right) \approx \frac{f(x_0+\Delta x)-f(x_0)}{\Delta x},\\
f’\left(x_0-\frac{\Delta x}{2}\right) \approx \frac{f(x_0)-f(x_0-\Delta x)}{\Delta x}.
\]</p>
<p>We recognise the formula on the RHS above as first-order forward and backward differences, if we were to consider the derivatives on the LHS to be evaluated at \(x_0\).</p>
<p>By considering the LHS at \(x_0\pm \Delta x/2\) they are in actual fact second-order <em>central</em> differences where the denominator of the RHS is \(2\times (\Delta x/2)\).</p>
<p>We can now calculate the second derivative making use of these two values within another central difference. But we must note again that these two values are telling us \(f’(x)\) at the points \(x_0\pm{\Delta x}/{2}\), which are only \(\Delta x\) rather than \(2\Delta x\) apart.</p>
<p>In the central difference formula, the denominator is the difference of the inputs into the function at the numerator. The inputs here are \(x_0+\frac{\Delta x}{2}\) and \(x_0-\frac{\Delta x}{2}\), so the denominator will be \((x_0+\frac{\Delta x}{2}) - (x_0-\frac{\Delta x}{2})\), which yields \(\Delta x\).</p>
<p>We must remember this in the denominator of the central difference formula to yield</p>
<p>\[
f’’(x_0)\approx\frac{f’(x_0+\frac{\Delta x}{2})-f’(x_0-\frac{\Delta x}{2})}{\Delta x},\\
f’’(x_0)\approx\frac{\frac{f(x_0+\Delta x)-f(x_0)}{\Delta x}-\frac{f(x_0)-f(x_0-h)}{\Delta x}}{\Delta x},\\
f’’(x_0)\approx\frac{f(x_0+\Delta x)-2f(x_0)+f(x_0-\Delta x)}{\Delta x^2}.
\]</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise: compute second derivative</p>
<p>Find an approximation to \(f’’(1)\) from the following data:</p>
<p>\[f(0.84) = 0.431711,\\
f(0.92) = 0.398519,\\
f(1.00) = 0.367879,\\
f(1.08) = 0.339596,\\
f(1.16) = 0.313486.\]</p>
<p>Solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span> <span class="o">=</span> <span class="mf">0.08</span>
<span class="n">ddf</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.339596</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.367879</span> <span class="o">+</span> <span class="mf">0.398519</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dx</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2nd Derivative with CDM = </span><span class="si">%.5f</span><span class="s2">. &quot;</span> <span class="o">%</span> <span class="n">ddf</span><span class="p">)</span>
</pre></div>
</div>
<p>The answer should be 0.36828.</p>
<p>We were given more data than we actually used. An alternative approach would be to use <em>non-centred differencing</em>, e.g. the following is also a valid approximation to the second derivative</p>
<p>\[f’’(x_0)\approx\frac{f(x_0+2\Delta x)-2f(x_0+\Delta x)+f(x_0)}{\Delta x^2}.\]</p>
<p>This can come in handy if we need to approximate the value of derivatives at or near to a boundary where we don’t have data beyond that boundary.</p>
<p>If we wanted to use all of this data, an alternative would be to fit a polynomial, and then differentiate this analytical expression exactly to approximate the derivative at any point between 0.84 and 1.16 (recalling that extrapolation is dangerous).</p>
</div>
</section>
</section>
<section id="solving-differential-equations">
<span id="nm-solving-diff-eq"></span><h2>Solving differential equations<a class="headerlink" href="#solving-differential-equations" title="Permalink to this headline">#</a></h2>
<p>One of the most important applications of numerical mathematics in the sciences is the numerical solution of ordinary differential equations (ODEs). While the ODEs you will encounter during your mathematics modules are mostly solvable through analytical solutions, real world ODE are often in the form where it has been proven that no analytical solutions exists. However, many of these ODEs govern important physical processes, and thus, numerical solutions were found for these ODEs.</p>
<p>To recap through an example, suppose we have the general first-order ODE:</p>
<aside class="margin sidebar">
<p class="sidebar-title">Note</p>
<p>For \(u=u(t)\), \(\frac{du}{dt}=u’=\dot{u}\).</p>
</aside>
<p>\[
u’(t)=f(u(t),t) \
u(t_0)=u_0.\]</p>
<p>That is, the derivative of \(u\) with respect to \(t\) is some known function of \(u\) and \(t\), and we also know the initial condition of \(u\) at some initial time \(t_0\).</p>
<p>If we manage to solve this equation analytically, the solution will be a function \(u(t)\) which is defined for every \(t&gt;t_0\). Our objective is to find an approximate solution to the ODE at a finite set of points. In this case, we will attempt to find approximate solutions at \(t=t_0,\), \(t_0+\Delta t\), \(t_0+2\Delta t\), \(t_0+3\Delta t\), \(\ldots\).</p>
<p>It is frequently useful to think of the independent variable, \(t\), as representing time. A numerical method steps forward in time units of \(\Delta t\), attempting to calculate \(u(t+\Delta t)\) in using the previously calculated value \(u(t)\).</p>
<p>More on timestepping an ODE can be found <a class="reference internal" href="3_Timestepping_an_ODE.html#timestepping-ode"><span class="std std-ref">here</span></a>.</p>
<section id="euler-method">
<h3>Euler method<a class="headerlink" href="#euler-method" title="Permalink to this headline">#</a></h3>
<p>Euler method is one of the simplest schemes to solve ODEs. You can find the notebook expanding on this method <a class="reference internal" href="3_Timestepping_an_ODE.html#nm-euler-method"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="heun-s-method">
<h3>Heun’s method<a class="headerlink" href="#heun-s-method" title="Permalink to this headline">#</a></h3>
<p>Heun’s method is a modified/improved version of the Euler method. You can find the notebook expanding on this method <a class="reference internal" href="4_Heuns_method.html#nm-heun-method"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="runge-kutta-method">
<h3>Runge-Kutta method<a class="headerlink" href="#runge-kutta-method" title="Permalink to this headline">#</a></h3>
<p>Runge-Kutta method is a 4th order interative method of approximating ODEs. You can find the notebook expanding on this method <a class="reference internal" href="5_Runge_Kutta_method.html#runge-kutta-method"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="successive-over-relaxation-method">
<h3>Successive over-relaxation method<a class="headerlink" href="#successive-over-relaxation-method" title="Permalink to this headline">#</a></h3>
<p>Successive over-relaxation is a method of solving partial differential equations (PDEs). You can find the notebook expanding on this method <a class="reference internal" href="6_Solving_PDEs_SOR.html#successive-over-relaxation"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="forward-time-centred-space-method">
<h3>Forward Time Centred Space method<a class="headerlink" href="#forward-time-centred-space-method" title="Permalink to this headline">#</a></h3>
<p>Forward Time Centred Space scheme is used for parabolic PDEs. You can find the notebook expanding on this method <a class="reference internal" href="7_FTCS.html#ftcs-scheme"><span class="std std-ref">here</span></a>.</p>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<section id="a-function-to-perform-numerical-differentiation">
<h3>A function to perform numerical differentiation<a class="headerlink" href="#a-function-to-perform-numerical-differentiation" title="Permalink to this headline">#</a></h3>
<p>As covered above, the expression</p>
<p>\[\frac{f(x+\Delta x) - f(x-\Delta x)}{2\Delta x},\]</p>
<p>can be used to find an approximate derivative of the function \(f(x)\) provided that \(\Delta x\) is appropriately small.</p>
<p>Let’s write a function <code class="docutils literal notranslate"><span class="pre">diff(f,</span> <span class="pre">x,</span> <span class="pre">dx</span> <span class="pre">=</span> <span class="pre">1.0e-6)</span></code> that returns the approximation of the derivative of a mathematical function represented by a Python function <code class="docutils literal notranslate"><span class="pre">f(x)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">dx</span><span class="p">)</span>
    <span class="n">derivative</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">dx</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">derivative</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s apply the above formula to differentiate \(f(x) = e^x\) at \(x = 0\), \(f(x) = e^{−2x}\) at \(x = 0\), \(f(x) = \cos(x)\) at \(x = 2\pi\), and \(f(x) = \ln(x)\) at \(x = 1\).</p>
<p>In each case, using \(\Delta x = 0.01\), let’s write out the error, i.e. the difference between the exact derivative and the result of the formula above.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span>
<span class="n">derivative</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The approximate derivative of exp(x) at x = 0 is: </span><span class="si">%f</span><span class="s2">. The error is </span><span class="si">%f</span><span class="s2">.&quot;</span>
      <span class="o">%</span> <span class="p">(</span><span class="n">derivative</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">derivative</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">derivative</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The approximate derivative of exp(-2*x) at x = 0 is: </span><span class="si">{0:.5f}</span><span class="s1">.  The error is </span><span class="si">{1:.5f}</span><span class="s1">.&#39;</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">derivative</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">derivative</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">))))</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span>
<span class="n">derivative</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The approximate derivative of cos(x) at x = 2*pi is: </span><span class="si">{0:.5f}</span><span class="s1">.  The error is </span><span class="si">{1:.5f}</span><span class="s1">.&#39;</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">derivative</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">derivative</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)))</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span>
<span class="n">derivative</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The approximate derivative of ln(x) at x = 0 is: </span><span class="si">{0:.5f}</span><span class="s1">.  The error is </span><span class="si">{1:.5f}</span><span class="s1">.&#39;</span>
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">derivative</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">derivative</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The approximate derivative of exp(x) at x = 0 is: 1.000017. The error is 0.000017.
The approximate derivative of exp(-2*x) at x = 0 is: -2.00013.  The error is 0.00013.
The approximate derivative of cos(x) at x = 2*pi is: 0.00000.  The error is 0.00000.
The approximate derivative of ln(x) at x = 0 is: 1.00003.  The error is 0.00003.
</pre></div>
</div>
</div>
</div>
</section>
<section id="derivative-of-sin-x">
<h3>Derivative of \(sin(x)\)<a class="headerlink" href="#derivative-of-sin-x" title="Permalink to this headline">#</a></h3>
<p>We will compute</p>
<p>\[\frac{d(\sin x)}{dx}\qquad\textrm{at}\qquad x = 0.8\]</p>
<p>using FDM and CDM. We will evaluate these derivatives for decreasing values of \(h\) (starting with \(h=1.0\) and halving) and compare the values against the exact solution.</p>
<p>At first let’s define <code class="docutils literal notranslate"><span class="pre">forward_diff</span></code> and <code class="docutils literal notranslate"><span class="pre">central_diff</span></code> functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">forward_diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="p">):</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">fxph</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fxph</span> <span class="o">-</span> <span class="n">fx</span><span class="p">)</span> <span class="o">/</span> <span class="n">dx</span>


<span class="k">def</span> <span class="nf">central_diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="p">):</span>
    <span class="n">fxph</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span>
    <span class="n">fxnh</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">dx</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fxph</span> <span class="o">-</span> <span class="n">fxnh</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We know that the exact solution is \(\frac{d \sin(x){dx}=\cos{x}\), we can evaluate that and store to compare later with the numerical solution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exact derivative at sin(0.8) = </span><span class="si">%.5f</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">exact</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exact derivative at sin(0.8) = 0.69671.
</pre></div>
</div>
</div>
</div>
<p>Now, we can compute solution with two schemes and compare with the exact solution:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># headers for the following errors outputs</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%20s%40s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Forward differencing&#39;</span><span class="p">,</span> <span class="s1">&#39;Central differencing&#39;</span><span class="p">))</span>

<span class="c1"># We&#39;re going to store all the values for plotting,</span>
<span class="c1"># initialise variable for these</span>
<span class="n">fd_errors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cd_errors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dx_all</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># An initial mesh spacing</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">fd</span> <span class="o">=</span> <span class="n">forward_diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
    <span class="n">cd</span> <span class="o">=</span> <span class="n">central_diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%10g</span><span class="s1"> (error=</span><span class="si">%10.2g</span><span class="s1">)         </span><span class="si">%10g</span><span class="s1"> (error=</span><span class="si">%10.2g</span><span class="s1">)&#39;</span> <span class="o">%</span>
          <span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fd</span> <span class="o">-</span> <span class="n">exact</span><span class="p">),</span> <span class="n">cd</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cd</span> <span class="o">-</span> <span class="n">exact</span><span class="p">)))</span>
    <span class="c1"># Store the h and the errors</span>
    <span class="n">dx_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">fd_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fd</span> <span class="o">-</span> <span class="n">exact</span><span class="p">))</span>
    <span class="n">cd_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cd</span> <span class="o">-</span> <span class="n">exact</span><span class="p">))</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Halve h for the next iteration</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Forward differencing                    Central differencing
  0.256492 (error=      0.44)           0.586258 (error=      0.11)
  0.492404 (error=       0.2)           0.668038 (error=     0.029)
  0.600269 (error=     0.096)           0.689472 (error=    0.0072)
  0.650117 (error=     0.047)           0.694894 (error=    0.0018)
  0.673843 (error=     0.023)           0.696253 (error=   0.00045)
  0.685386 (error=     0.011)           0.696593 (error=   0.00011)
  0.691074 (error=    0.0056)           0.696678 (error=   2.8e-05)
  0.693897 (error=    0.0028)             0.6967 (error=   7.1e-06)
  0.695304 (error=    0.0014)           0.696705 (error=   1.8e-06)
  0.696006 (error=    0.0007)           0.696706 (error=   4.4e-07)
</pre></div>
</div>
</div>
</div>
<p>Let’s plot the errors in a log-log plot so that we can see the relationship between the error and the increment:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dx_all</span><span class="p">,</span> <span class="n">fd_errors</span><span class="p">,</span> <span class="s1">&#39;b.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forward diff.&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dx_all</span><span class="p">,</span> <span class="n">cd_errors</span><span class="p">,</span> <span class="s1">&#39;k.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Central diff.&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\Delta x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convergence plot&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2_Numerical_differentiation_19_0.png" src="../../_images/2_Numerical_differentiation_19_0.png" />
</div>
</div>
<p>The errors fall linearly in \(\Delta x\) on a log-log plot, therefore they have a polynomial relationship. The slopes of the lines indicate the order of the relationship - slope 1 for forward difference and slope 2 for central difference.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "primer-computational-mathematics/book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./c_mathematics/numerical_methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="1_Interpolation_curve_fitting.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Interpolation and curve fitting</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="3_Timestepping_an_ODE.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Solving or timestepping an ODE</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Imperial College London<br/>
  
      &copy; Copyright 2020.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>