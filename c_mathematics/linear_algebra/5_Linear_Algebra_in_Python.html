

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Linear Algebra in Python &#8212; ESE Jupyter Material</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".cell"
        const thebe_selector_input = ".cell_input div.highlight"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Mathematical notation" href="../mathematical_notation/intro.html" />
    <link rel="prev" title="Eigenvalues and eigenvectors" href="4_Eigenvalues_and_eigenvectors.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ESE Jupyter Material</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../../intro.html">Landing page</a>
  </li>
  <li class="">
    <a href="../../a_modules/intro.html">Modules</a>
  </li>
  <li class="">
    <a href="../../b_coding/intro.html">Coding</a>
  </li>
  <li class="active">
    <a href="../intro.html">Mathematics</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="../calculus/intro.html">Calculus</a>
    </li>
    <li class="">
      <a href="../complex_analysis/intro.html">Complex analysis</a>
    </li>
    <li class="">
      <a href="../differential_equations/intro.html">Differential equations</a>
    </li>
    <li class="active">
      <a href="intro.html">Linear algebra</a>
      <ul class="nav sidenav_l3">
      <li class="">
        <a href="1_Basic_definitions_and_operations.html">Basic definitions and operations</a>
      </li>
      <li class="">
        <a href="2_Linear_Systems.html">Systems of linear equations</a>
      </li>
      <li class="">
        <a href="3_Theory.html">Theory</a>
      </li>
      <li class="">
        <a href="4_Eigenvalues_and_eigenvectors.html">Eigenvalues and eigenvectors</a>
      </li>
      <li class="active">
        <a href="">Linear Algebra in Python</a>
      </li>
    </ul>
    </li>
    <li class="">
      <a href="../mathematical_notation/intro.html">Mathematical notation</a>
    </li>
    <li class="">
      <a href="../numerical_methods/intro.html">Numerical methods</a>
    </li>
    <li class="">
      <a href="../series_and_sequences/intro.html">Series and sequences</a>
    </li>
    <li class="">
      <a href="../sets_and_functions/intro.html">Sets and functions</a>
    </li>
    <li class="">
      <a href="../statistics/intro.html">Statistics</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../../d_geosciences/intro.html">Geosciences</a>
  </li>
  <li class="">
    <a href="../../e_extra/intro.html">Further resources</a>
  </li>
  <li class="">
    <a href="../../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/c_mathematics/linear_algebra/5_Linear_Algebra_in_Python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/primer-computational-mathematics/book/issues/new?title=Issue%20on%20page%20%2Fc_mathematics/linear_algebra/5_Linear_Algebra_in_Python.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/primer-computational-mathematics/book/master?urlpath=tree/notebooks/c_mathematics/linear_algebra/5_Linear_Algebra_in_Python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#motivation" class="nav-link">Motivation</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#python" class="nav-link">Python</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#constructing-some-useful-matrices" class="nav-link">Constructing some useful matrices</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#identity-matrix" class="nav-link">Identity matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#diagonal-matrix" class="nav-link">Diagonal matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#example-tridiagonal-matrix" class="nav-link">Example: tridiagonal matrix</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#triangular-matrix" class="nav-link">Triangular matrix</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#sparse-matrices" class="nav-link">Sparse matrices</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#examples-convert-a-numpy-array" class="nav-link">Examples: Convert a NumPy array</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#examples-construct-a-tridiagonal-matrix" class="nav-link">Examples: Construct a tridiagonal matrix</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#matrix-operations" class="nav-link">Matrix operations</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#arithmetic-operations" class="nav-link">Arithmetic operations</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#matrix-multiplication" class="nav-link">Matrix multiplication</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#inner-product" class="nav-link">Inner product</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#transpose" class="nav-link">Transpose</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h4">
            <a href="#reshaping-arrays" class="nav-link">Reshaping arrays</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#complex-conjugate" class="nav-link">Complex conjugate</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#norms" class="nav-link">Norms</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#matrix-inverse" class="nav-link">Matrix inverse</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#solving-systems-of-linear-equations" class="nav-link">Solving systems of linear equations</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#example-runge-kutta-wave-equation" class="nav-link">Example: Runge-Kutta, Wave equation</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#further-reading" class="nav-link">Further reading</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#qr-and-lu-decomposition" class="nav-link">QR and LU decomposition</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="linear-algebra-in-python">
<h1>Linear Algebra in Python<a class="headerlink" href="#linear-algebra-in-python" title="Permalink to this headline">¶</a></h1>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>Linear algebra is of vital importance in almost any area of science and engineering and therefore numerical linear algebra is just as important in computational science. Some of the more popular areas of application include machine learning, computer vision, finite element method, optimisation, and many others.</p>
<p>Computers use a discrete representation of the real numbers, rather than a continuous one, which has several consequences. Most notably, it means that there have to be gaps between adjacent numbers. We will therefore most often want to work with <a class="reference external" href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">floating point numbers with double precision</a> (<em>float</em> in python) which allow us to represent real numbers with very high precision. However, often in computing we deal with extremely large datasets (e.g. matrices with millions of rows and columns) so even tiny errors can grow and accumulate very fast if our algorithm is <a class="reference external" href="https://en.wikipedia.org/wiki/Numerical_stability"><em>numerically unstable</em></a>.</p>
<p>For example, we might be tempted to solve <span class="math notranslate nohighlight">\(A \mathbf{x} = \mathbf{b}\)</span> by calculating an inverse of A, but calculating inverses and determinants of matrices is generally avoided in computing due to round-off errors. Numerical linear algebra therefore aims to come up with fast and efficient algorithms to solve usual linear algebra problems without magnifying these (and other) small errors.</p>
</div>
<div class="section" id="python">
<h2>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h2>
<p>The main library for linear algebra in Python is <a class="reference external" href="https://www.scipy.org/">SciPy</a> which makes use of NumPy arrays. NumPy also provides plenty of basic functionalities through its functions in <a class="reference external" href="https://numpy.org/doc/stable/reference/routines.linalg.html"><code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code></a>, but many advanced capabilities remain reserved for <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html"><code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="k">as</span> <span class="nn">la</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="constructing-some-useful-matrices">
<h2>Constructing some useful matrices<a class="headerlink" href="#constructing-some-useful-matrices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="identity-matrix">
<h3>Identity matrix<a class="headerlink" href="#identity-matrix" title="Permalink to this headline">¶</a></h3>
<p>NumPy provides us with two almost identical functions to construct identity matrices: <code class="docutils literal notranslate"><span class="pre">numpy.identity(n)</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy.eye(n,</span> <span class="pre">[m=n],</span> <span class="pre">[k=0])</span></code>. The former constructs a square matrix with n rows and columns with 1s on the main diagonal. The latter constructs an <span class="math notranslate nohighlight">\(n \times m\)</span> matrix with 1s on the kth diagonal (k=0 is the main diagonal). Examples below demonstrate this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;identity(5) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># square 5x5 matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">eye(4, 5) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># 4x5 matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">eye(4, 5, -1) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># 1st lower diagonal</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">eye(4, 5, 2) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># 2nd upper diagonal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>identity(5) = 
 [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 1.]]

eye(4, 5) = 
 [[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 0.]]

eye(4, 5, -1) = 
 [[0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]

eye(4, 5, 2) = 
 [[0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0.]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="diagonal-matrix">
<h3>Diagonal matrix<a class="headerlink" href="#diagonal-matrix" title="Permalink to this headline">¶</a></h3>
<p>The function <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.diag.html"><code class="docutils literal notranslate"><span class="pre">numpy.diag(array,</span> <span class="pre">[k=0])</span></code></a> either extracts a diagonal from an array or constructs a diagonal array:</p>
<ol class="simple">
<li><p>if the input array is 2-D, returns a 1-D array with diagonal entries</p></li>
<li><p>if the input array is 1-D, returns a diagonal 2-D array with entries from the input array on the diagonal.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diag(M) = &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diag(v) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>diag(M) =  [1 4]
diag(v) = 
 [[6 0]
 [0 8]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-tridiagonal-matrix">
<h3>Example: tridiagonal matrix<a class="headerlink" href="#example-tridiagonal-matrix" title="Permalink to this headline">¶</a></h3>
<p>Let us show how we could use <code class="docutils literal notranslate"><span class="pre">numpy.diag</span></code> to construct a tridiagonal matrix, which is a banded matrix with non-zero entries on the main diagonal and the first off-diagonals above and below the main diagonal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2 3 0 0]
 [1 2 3 0]
 [0 1 2 3]
 [0 0 1 2]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="triangular-matrix">
<h3>Triangular matrix<a class="headerlink" href="#triangular-matrix" title="Permalink to this headline">¶</a></h3>
<p>To construct upper or lower triangular matrices we use <code class="docutils literal notranslate"><span class="pre">numpy.triu(array,</span> <span class="pre">[k=0])</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.tril(array,</span> <span class="pre">[k=0])</span></code> functions (u stands for upper, l stands for lower). Returns an array whose entries below or above the kth diagonal are 0 (k=0 is the main diagonal).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">triu(M) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">triu(M, -1) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">tril(M, 1) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M = 
 [[ 1  2  3]
 [ 4  5  6]
 [ 7  8  9]
 [10 11 12]]

triu(M) = 
 [[1 2 3]
 [0 5 6]
 [0 0 9]
 [0 0 0]]

triu(M, -1) = 
 [[ 1  2  3]
 [ 4  5  6]
 [ 0  8  9]
 [ 0  0 12]]

tril(M, 1) = 
 [[ 1  2  0]
 [ 4  5  6]
 [ 7  8  9]
 [10 11 12]]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="sparse-matrices">
<h2>Sparse matrices<a class="headerlink" href="#sparse-matrices" title="Permalink to this headline">¶</a></h2>
<p>A sparse matrix is a matrix with mostly zero-valued entries. Performing operations on sparse matrices can therefore be unnecessarily computationally expensive, since we are unnecessarily adding 0s or multiplying by 0, for example. Therefore, when working with sparse matrices we would like to have an option to simply skip this kind of operations.</p>
<p>The identity matrix and diagonal matrices are examples of such matrices, although a sparse matrix does not need to have any particular structure. The non-zero entries could be completely random, and this is most often the case in practice.</p>
<p>SciPy allows us to build such matrices and do operations on them with the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/sparse.html"><code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code></a> package. There are several formats how these matrices are stored and users are encouraged to read the documentation and the <a class="reference external" href="https://en.wikipedia.org/wiki/Sparse_matrix">Wikipedia page</a> for an explanation of them. For example, a sparse matrix in coordinate format is stored in three arrays: one for the values of non-zero entries and two for the row and column index of those entries.</p>
<div class="section" id="examples-convert-a-numpy-array">
<h3>Examples: Convert a NumPy array<a class="headerlink" href="#examples-convert-a-numpy-array" title="Permalink to this headline">¶</a></h3>
<p>We can convert any array to a sparse matrix. For example, we can use the function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.coo_matrix.html"><code class="docutils literal notranslate"><span class="pre">scipy.sparse.coo_matrix</span></code></a> to construct a matrix in COOrdinate format. Let us convert a tridiagonal NumPy matrix to a sparse SciPy matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">coo_matrix</span>


<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">spA</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2 3 0 0 0 0 0 0 0 0]
 [1 2 3 0 0 0 0 0 0 0]
 [0 1 2 3 0 0 0 0 0 0]
 [0 0 1 2 3 0 0 0 0 0]
 [0 0 0 1 2 3 0 0 0 0]
 [0 0 0 0 1 2 3 0 0 0]
 [0 0 0 0 0 1 2 3 0 0]
 [0 0 0 0 0 0 1 2 3 0]
 [0 0 0 0 0 0 0 1 2 3]
 [0 0 0 0 0 0 0 0 1 2]]
  (0, 0)	2
  (0, 1)	3
  (1, 0)	1
  (1, 1)	2
  (1, 2)	3
  (2, 1)	1
  (2, 2)	2
  (2, 3)	3
  (3, 2)	1
  (3, 3)	2
  (3, 4)	3
  (4, 3)	1
  (4, 4)	2
  (4, 5)	3
  (5, 4)	1
  (5, 5)	2
  (5, 6)	3
  (6, 5)	1
  (6, 6)	2
  (6, 7)	3
  (7, 6)	1
  (7, 7)	2
  (7, 8)	3
  (8, 7)	1
  (8, 8)	2
  (8, 9)	3
  (9, 8)	1
  (9, 9)	2
</pre></div>
</div>
</div>
</div>
<p>In the above example, A has 100 entries, while spA (‘sparse A’) has only 28. In this case we would not save much computational time since a <span class="math notranslate nohighlight">\(10 \times 10\)</span> matrix is quite small. However, sparse matrices become more useful (and even essential) the larger our matrix is.</p>
</div>
<div class="section" id="examples-construct-a-tridiagonal-matrix">
<h3>Examples: Construct a tridiagonal matrix<a class="headerlink" href="#examples-construct-a-tridiagonal-matrix" title="Permalink to this headline">¶</a></h3>
<p>Users more comfortable with SciPy may wish to directly construct sparse matrices, instead of converting a NumPy array. Let us construct the same tridiagonal matrix as in the previous example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>


<span class="n">diagonals</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span><span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">diagonals</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;coo&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>  <span class="c1"># print the entire array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2. 3. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 2. 3. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 2. 3. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 2. 3. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 2. 3. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 2. 3. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 2. 3. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 2. 3. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 2. 3.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 2.]]
  (1, 0)	1.0
  (2, 1)	1.0
  (3, 2)	1.0
  (4, 3)	1.0
  (5, 4)	1.0
  (6, 5)	1.0
  (7, 6)	1.0
  (8, 7)	1.0
  (9, 8)	1.0
  (0, 0)	2.0
  (1, 1)	2.0
  (2, 2)	2.0
  (3, 3)	2.0
  (4, 4)	2.0
  (5, 5)	2.0
  (6, 6)	2.0
  (7, 7)	2.0
  (8, 8)	2.0
  (9, 9)	2.0
  (0, 1)	3.0
  (1, 2)	3.0
  (2, 3)	3.0
  (3, 4)	3.0
  (4, 5)	3.0
  (5, 6)	3.0
  (6, 7)	3.0
  (7, 8)	3.0
  (8, 9)	3.0
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="matrix-operations">
<h2>Matrix operations<a class="headerlink" href="#matrix-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="arithmetic-operations">
<h3>Arithmetic operations<a class="headerlink" href="#arithmetic-operations" title="Permalink to this headline">¶</a></h3>
<p>All arithmetic operators (<code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span> </code>, <code class="docutils literal notranslate"><span class="pre">%</span></code>, <code class="docutils literal notranslate"><span class="pre">**</span></code>, <code class="docutils literal notranslate"><span class="pre">//</span></code>) on arrays apply elementwise. If both operands are matrices they need to have the same dimensions (to be conformable for the operation).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> 
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M + M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="n">M</span><span class="p">)</span>  <span class="c1"># add</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M - M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">-</span> <span class="n">M</span><span class="p">)</span>  <span class="c1"># subtract</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;4 * M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">M</span><span class="p">)</span>  <span class="c1"># multiply by a scalar</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M * M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">*</span> <span class="n">M</span><span class="p">)</span>  <span class="c1"># multiply matrices elementwise</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M / M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">/</span> <span class="n">M</span><span class="p">)</span>  <span class="c1"># divide elementwise</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M ** 3 =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># exponentiation elementwise (M**3 = M*M*M)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M % 2 =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># modulus</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M // 2 =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># integer (floor) division</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M =
 [[1 2]
 [3 4]]
M + M =
 [[2 4]
 [6 8]]
M - M =
 [[0 0]
 [0 0]]
4 * M =
 [[ 4  8]
 [12 16]]
M * M =
 [[ 1  4]
 [ 9 16]]
M / M =
 [[1. 1.]
 [1. 1.]]
M ** 3 =
 [[ 1  8]
 [27 64]]
M % 2 =
 [[1 0]
 [1 0]]
M // 2 =
 [[0 1]
 [1 2]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="matrix-multiplication">
<h3>Matrix multiplication<a class="headerlink" href="#matrix-multiplication" title="Permalink to this headline">¶</a></h3>
<p>NumPy uses the function <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.matmul.html"><code class="docutils literal notranslate"><span class="pre">numpy.matmul(array1,</span> <span class="pre">array2)</span></code></a> to multiply two matrices. Users of Python 3.5 or newer can use the operator <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> instead.</p>
<p>To raise a matrix to some power we need to use the function <code class="docutils literal notranslate"><span class="pre">numpy.linalg.matrix_power(array,</span> <span class="pre">exp)</span></code>.</p>
<p><strong>Note:</strong> When one of the operands is a 1-D array (we might initialise a vector this way if we are not careful - see below on reshaping arrays), it will automatically be assumed that it is a row vector if it is left-multiplying or a column vector if it is right-multiplying. The result will be a 1-D array as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M @ M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">@</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M @ M @ M =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">@</span> <span class="n">M</span> <span class="o">@</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M^3 = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">la</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># 1-D array</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x @ M = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">@</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M @ x = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M @ M =
 [[ 7 10]
 [15 22]]
M @ M @ M =
 [[ 37  54]
 [ 81 118]]
M^3 = 
 [[ 37  54]
 [ 81 118]]
x =  [1 2]
x @ M = 
 [ 7 10]
M @ x = 
 [ 5 11]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inner-product">
<h3>Inner product<a class="headerlink" href="#inner-product" title="Permalink to this headline">¶</a></h3>
<p>The function <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dot.html"><code class="docutils literal notranslate"><span class="pre">numpy.dot(array1,</span> <span class="pre">array2)</span></code></a> is an alternative matrix product function but we recommend using it only for calculating an inner product of two vectors. Curious readers are encouraged to read the documentation for other uses, although <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> is preferred.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transpose">
<h3>Transpose<a class="headerlink" href="#transpose" title="Permalink to this headline">¶</a></h3>
<p>A matrix can be transposed using <code class="docutils literal notranslate"><span class="pre">numpy.transpose(array)</span></code> or with the array attribute <code class="docutils literal notranslate"><span class="pre">array.T</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M.T = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;numpy.transpose(M) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M.T = 
 [[1 3]
 [2 4]]
numpy.transpose(M) = 
 [[1 3]
 [2 4]]
</pre></div>
</div>
</div>
</div>
<div class="section" id="reshaping-arrays">
<h4>Reshaping arrays<a class="headerlink" href="#reshaping-arrays" title="Permalink to this headline">¶</a></h4>
<p>Note that 1-D NumPy arrays remain unchanged when transposed. To avoid this kind of issues, column (or row) vectors should be initialised as 2-D <span class="math notranslate nohighlight">\(n \times 1\)</span> (or <span class="math notranslate nohighlight">\(1 \times n\)</span>) arrays. Below demonstrates this, as well as how to reshape 1-D arrays to 2-D. A very useful method of doing this is by giving -1 as one of the new shape parameters. We cannot give -1 for more than one shape parameter, as this is the unknown value which NumPy will figure out for us. For example, if we start from a 1-D array of 4 entries, reshaping it to (-1, 1, 2) will generate an array of shape <span class="math notranslate nohighlight">\(k \times 1 \times 2\)</span> where <span class="math notranslate nohighlight">\(k \in \mathbb{N}\)</span> has to satisfy <span class="math notranslate nohighlight">\(k \cdot 1 \cdot 2 = 4\)</span> so that the total number of entries (A.size in NumPy) is preserved. If this <span class="math notranslate nohighlight">\(k\)</span> does not exist, the reshaping is not possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;, number of dimensions: &#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="s1">&#39;, shape:&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x.T =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;, number of dimensions: &#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="s1">&#39;, shape:&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x.T = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># reshape </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[1., 2., 3.].reshape(-1, 1) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;, number of dimensions: &#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="s1">&#39;, shape:&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x = [1. 2. 3.] , number of dimensions:  1 , shape: (3,)
x.T = [1. 2. 3.]
x = [[1. 2. 3.]] , number of dimensions:  2 , shape: (1, 3)
x.T = 
 [[1.]
 [2.]
 [3.]]
[1., 2., 3.].reshape(-1, 1) = 
 [[1.]
 [2.]
 [3.]] , number of dimensions:  2 , shape: (3, 1)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="complex-conjugate">
<h3>Complex conjugate<a class="headerlink" href="#complex-conjugate" title="Permalink to this headline">¶</a></h3>
<p>We use <code class="docutils literal notranslate"><span class="pre">numpy.conjugate(array)</span></code> or its alias <code class="docutils literal notranslate"><span class="pre">numpy.conj(array)</span></code> to find the complex conjugate of an array containing complex entries. Alternatively we can use the <code class="docutils literal notranslate"><span class="pre">.conj()</span></code> attribute of NumPy arrays.</p>
<p>To get the conjugate transpose (or Hermitian transpose) we would therefore write <code class="docutils literal notranslate"><span class="pre">array.T.conj()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="n">j</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="n">j</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="n">j</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;conj(C) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C.conj() = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">C.T.conj() = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C = 
 [[1.+1.j 2.+2.j]
 [3.+3.j 4.+4.j]]
conj(C) = 
 [[1.-1.j 2.-2.j]
 [3.-3.j 4.-4.j]]
C.conj() = 
 [[1.-1.j 2.-2.j]
 [3.-3.j 4.-4.j]]

C.T.conj() = 
 [[1.-1.j 3.-3.j]
 [2.-2.j 4.-4.j]]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="norms">
<h2>Norms<a class="headerlink" href="#norms" title="Permalink to this headline">¶</a></h2>
<p>The function <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.norm.html"><code class="docutils literal notranslate"><span class="pre">numpy.linalg.norm(array,</span> <span class="pre">[order])</span></code></a> returns a matrix or vector norm of specified order. If the order is not specified, it returns the Frobenius matrix norm (or 2-norm for vectors).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">norm(x, 1) = &#39;</span><span class="p">,</span><span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;norm(x) = &#39;</span><span class="p">,</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;norm(x, np.inf)&#39;</span><span class="p">,</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">norm(M)&#39;</span><span class="p">,</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;norm(M, np.inf)&#39;</span><span class="p">,</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x =  [1 2 3]
M = 
 [[1 2]
 [3 4]]

norm(x, 1) =  6.0
norm(x) =  3.7416573867739413
norm(x, np.inf) 3.0

norm(M) 5.477225575051661
norm(M, np.inf) 7.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="matrix-inverse">
<h2>Matrix inverse<a class="headerlink" href="#matrix-inverse" title="Permalink to this headline">¶</a></h2>
<p>We can find the inverse of a square matrix with the function <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.inv.html"><code class="docutils literal notranslate"><span class="pre">numpy.linalg.inv(array)</span></code></a>. As briefly mentioned in the motivation section, an inverse of large matrix is very likely to be imprecise due to round-off errors. However, we might be able to get away with it with certain smaller matrices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inverse(M) = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">la</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>inverse(M) = 
 [[-2.   1. ]
 [ 1.5 -0.5]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solving-systems-of-linear-equations">
<h2>Solving systems of linear equations<a class="headerlink" href="#solving-systems-of-linear-equations" title="Permalink to this headline">¶</a></h2>
<p>We will most often want to solve a linear matrix equation <span class="math notranslate nohighlight">\(A \mathbf{x} = \mathbf{b}\)</span>.</p>
<p>As briefly mentioned in the motivation section, we should not solve this by finding an inverse <span class="math notranslate nohighlight">\(A^{-1}\)</span> and then multiplying <span class="math notranslate nohighlight">\(A^{-1}\mathbf{b}\)</span> to find <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>NumPy provides us with a function <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html"><code class="docutils literal notranslate"><span class="pre">numpy.linalg.solve(A,</span> <span class="pre">b)</span></code></a> which will solve the equation for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> but it does it in a different way (see LU decomposition at the end of the notebook). It is required that <span class="math notranslate nohighlight">\(A\)</span> is not singular. For singular matrices we need to use the least-squares method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">9.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.2  1.8 -0.4]
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-runge-kutta-wave-equation">
<h3>Example: Runge-Kutta, Wave equation<a class="headerlink" href="#example-runge-kutta-wave-equation" title="Permalink to this headline">¶</a></h3>
<p>Consider the 1-D wave equation</p>
<div class="math notranslate nohighlight">
\[ u_{tt} + u_{xx} = 0, \qquad u(0) = u(L) = 0,\]</div>
<p>in the domain [0, L]. To solve it, let us write a standard explicit second order Runge-Kutta time-stepping algorithm. First, we need to discretise the equation with a finite difference approximation,</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial^2}{\partial t^2} u_i - \frac{u_{i-1} -2u_i + u_{i+1}}{\Delta x^2} = 0, \qquad u_0 = u_{N+1}=0,\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta x = L / (N + 1)\)</span> and <span class="math notranslate nohighlight">\(u_i = u(x_i) = u(i \Delta x)\)</span>, <span class="math notranslate nohighlight">\(i = 1, \dots, N\)</span>. Writing <span class="math notranslate nohighlight">\(\mathbf{v} = (u_1, u_2, \dots, u_N)^T\)</span>, we can express this equation as:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial^2}{\partial t^2} \mathbf{v} + A \mathbf{v} = 0, \]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(N \times N\)</span> tridiagonal coefficient matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \frac{1}{\Delta x^2}
    \begin{bmatrix}
         2&amp; -1  &amp; 0 &amp;\cdots &amp; 0 &amp; 0\\
        -1&amp; 2   &amp; -1 &amp;\cdots &amp; 0 &amp; 0\\
        0 &amp; -1 &amp; 2 &amp; \cdots &amp; 0 &amp; 0 \\
           &amp;\vdots&amp;&amp;&amp;\vdots&amp;\vdots\\
        0 &amp; 0 &amp; 0 &amp; \cdots &amp; 2 &amp; -1 \\
        0 &amp; 0 &amp; 0 &amp; \cdots &amp; -1 &amp; 2 \\
    \end{bmatrix}. \end{split}\]</div>
<p>Now we begin to see how linear algebra can be used to solve our PDE. We want to solve an ODE, so we introduce <span class="math notranslate nohighlight">\(\mathbf{w} = dv / dt\)</span></p>
<p>u(x, 0) = {\rm e}^{-x^2}, u_t(x, 0) = 0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span> <span class="c1">#/ dx**2</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 2. -1.  0.  0.  0.  0.  0.  0.  0.  0.]
 [-1.  2. -1.  0.  0.  0.  0.  0.  0.  0.]
 [ 0. -1.  2. -1.  0.  0.  0.  0.  0.  0.]
 [ 0.  0. -1.  2. -1.  0.  0.  0.  0.  0.]
 [ 0.  0.  0. -1.  2. -1.  0.  0.  0.  0.]
 [ 0.  0.  0.  0. -1.  2. -1.  0.  0.  0.]
 [ 0.  0.  0.  0.  0. -1.  2. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0. -1.  2. -1.  0.]
 [ 0.  0.  0.  0.  0.  0.  0. -1.  2. -1.]
 [ 0.  0.  0.  0.  0.  0.  0.  0. -1.  2.]]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<p>Trefethen, L.N. and Bau III, D., 1997. Numerical linear algebra (Vol. 50). Siam.</p>
<div class="section" id="qr-and-lu-decomposition">
<h3>QR and LU decomposition<a class="headerlink" href="#qr-and-lu-decomposition" title="Permalink to this headline">¶</a></h3>
<p>The most common method for finding a numerical solutions of an equation <span class="math notranslate nohighlight">\(A \mathbf{x} = \mathbf{b}\)</span> make use of <a class="reference external" href="https://en.wikipedia.org/wiki/QR_decomposition">QR</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition">LU decompositions</a>.</p>
<p><strong>QR decomposition</strong> (or factorisation) decomposes a matrix <span class="math notranslate nohighlight">\(A\)</span> into a product <span class="math notranslate nohighlight">\(A = QR\)</span>, where <span class="math notranslate nohighlight">\(Q\)</span> is an orthogonal (or unitary if complex) matrix and <span class="math notranslate nohighlight">\(R\)</span> is upper-triangular. An orthogonal matrix <span class="math notranslate nohighlight">\(Q\)</span> is a matrix whose transpose is equal to its inverse, i.e. <span class="math notranslate nohighlight">\(Q^T = Q^{-1}\)</span>. Having found <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(R\)</span>, solving the equation is then performed via a simple back-substitution because the LHS is upper-triangular:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A \mathbf{x} = \mathbf{b} \\
QR \mathbf{x} = \mathbf{b} \\
R \mathbf{x} = Q^T \mathbf{b}. \end{split}\]</div>
<p>Hence we got away with calculating an inverse of <span class="math notranslate nohighlight">\(A\)</span>, but rather we found an inverse of <span class="math notranslate nohighlight">\(Q\)</span> which does not require any further calculations.</p>
<p><strong>LU decomposition</strong> factorises <span class="math notranslate nohighlight">\(A\)</span> such that <span class="math notranslate nohighlight">\(A = LU\)</span> where <span class="math notranslate nohighlight">\(L\)</span> is a lower-triangular matrix and <span class="math notranslate nohighlight">\(U\)</span> is an upper triangular matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split} A \mathbf{x} = \mathbf{b} \\ 
LU \mathbf{x} = \mathbf{b} \end{split}\]</div>
<p>First we solve <span class="math notranslate nohighlight">\( L \mathbf{y} = \mathbf{b}\)</span> for <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{y} = U\mathbf{x}\)</span> and then we solve <span class="math notranslate nohighlight">\(U\mathbf{x} = \mathbf{y}\)</span> for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. It is very simple to solve these two equations since solving triangular systems involves only back- or forward- substitution.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "primer-computational-mathematics/book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./c_mathematics/linear_algebra"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="4_Eigenvalues_and_eigenvectors.html" title="previous page">Eigenvalues and eigenvectors</a>
    <a class='right-next' id="next-link" href="../mathematical_notation/intro.html" title="next page">Mathematical notation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Imperial College London<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>