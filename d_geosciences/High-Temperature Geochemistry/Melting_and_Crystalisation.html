
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Melting and crystalisation &#8212; ESE Jupyter Material</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".cell"
const thebe_selector_input = ".cell_input div.highlight"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Nuclides" href="Nuclides.html" />
    <link rel="prev" title="Major and trace elements" href="Major_and_Trace_Elements.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ESE Jupyter Material</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Landing page
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../a_modules/intro.html">
   Modules
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/continental_tectonics/intro.html">
     Continental Tectonics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Euler_Pole.html">
       Euler Pole
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Isostasy.html">
       Isostasy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Lithospheric_Strength.html">
       Lithospheric Strength
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/continental_tectonics/Ridge_Push_and_Slab_Pull.html">
       Ridge Push and Slab Pull
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/math_methods_1/intro.html">
     Mathematical methods 1
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/1_Coordinate_Systems.html">
       Coordinate systems
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/2_Vectors.html">
       Vectors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/3_Multivariable_Calculus.html">
       Multivariable calculus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/4_Vector_Calculus.html">
       Vector calculus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/5_Matrices.html">
       Matrices
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/6_Eigenvalues.html">
       Eigenvalues
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/7_Series.html">
       Series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/8_ODEs.html">
       ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/math_methods_1/9_Modelling.html">
       Modelling
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/mathematical_methods_2/intro.html">
     Mathematical Methods 2
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mathematical_methods_2/1_complex_numbers.html">
       Complex Numbers
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/mechanics/intro.html">
     Mechanics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/1_Motion_in_1D.html">
       Motion in 1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/2_Motion_in_2D.html">
       Motion in 2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/3_Work_and_Energy.html">
       Work and Energy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/4_Rotational_Motion.html">
       Rotational Motion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/mechanics/5_Gravity.html">
       Gravity
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/seismology/intro.html">
     Seismology
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/CMP_Common_Mid_Point_Gather.html">
       Common Mid-point Gather
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Ghosting.html">
       Ghosting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Spatial_aliasing.html">
       Spatial Aliasing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/seismology/Temporal_aliasing.html">
       Temporal Aliasing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../a_modules/tectonics_of_the_ocean/intro.html">
     Techtonics of the ocean
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../a_modules/tectonics_of_the_ocean/Plate_Models.html">
       Heat Flow
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../b_coding/intro.html">
   Coding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../b_coding/NumPy_Arrays.html">
     NumPy arrays
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/intro.html">
     Fundamentals of Computer Science
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/1_Algorithmic_Complexity.html">
       Algorithmic complexity
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/2_Recursion.html">
       Recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/3_Divide_and_Conquer.html">
       Divide and Conquer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/4_Dynamic_Programming.html">
       Dynamic Programming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/5_Greedy_Algorithms.html">
       Greedy Algorithms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/6_Data_Structures.html">
       Data Structures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Fundamentals%20of%20Computer%20Science/7_Graph_Algorithms.html">
       Graph Algorithms
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Intro%20to%20Python/intro.html">
     Intro to Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/1_Printing_and_formatting_statements.html">
       Printing and formatting statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/2_Variables.html">
       Variables
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/3_If_statement.html">
       If statement
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/4_While_loops.html">
       While loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/5_Lists.html">
       Lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/6_For_loops.html">
       For loops
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/7_List_comprehensions.html">
       List comprehensions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/8_Nested_lists.html">
       Nested lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/9_Handling_errors.html">
       Handling errors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/10_Importing.html">
       Importing in Python
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/11_Functions.html">
       Creating custom functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/12_Tuples.html">
       Tuples
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/13_File_handling.html">
       File handling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/14_Dictionaries.html">
       Dictionaries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/15_Flow_control_statements.html">
       Flow control statements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/16_Sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/17_Matplotlib.html">
       Plotting data with Matplotlib
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/18_Assert.html">
       Assert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/19_Classes.html">
       Python classes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Intro%20to%20Python/20_Lambdas.html">
       Lambdas
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Pandas/intro.html">
     Pandas
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/1_basics.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/2_filter_select_assign.html">
       Filtering, selecting and assigning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/3_merge_combine_group_sort.html">
       Merging, combining, grouping and sorting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/4_summary_statistics.html">
       Summary statistics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/5_time_stamps.html">
       Creating date-time stamps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Pandas/6_plotting.html">
       Plotting
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../b_coding/Programming%20Tools/intro.html">
     Programming tools
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../b_coding/Programming%20Tools/1_Version_Control_Git.html">
       Version control Git
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../c_mathematics/intro.html">
   Mathematics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/calculus/intro.html">
     Calculus
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/calculus/Vector_calculus.html">
       Vector calculus
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/complex_analysis/intro.html">
     Complex analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/complex_analysis/1_introduction.html">
       Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/complex_analysis/2_complex_plane.html">
       Complex plane
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/complex_analysis/3_complex_functions.html">
       Complex functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/complex_analysis/4_holomorphic_functions.html">
       Holomorphic functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/complex_analysis/5_integrating.html">
       Complex integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/complex_analysis/6_fractals.html">
       Fractals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/differential_equations/intro.html">
     Differential equations
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/1_de_introduction.html">
       Introduction to differential equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/2_linear_des.html">
       Linear Differential Equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/3_first-order_odes.html">
       First-order ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/4_higher_ord_lin_odes.html">
       Higher order Linear ODEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/5_ode_series.html">
       Series ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/6_pde_basicdefinitions.html">
       Introductory definitions and concepts
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/7_pde_first_order.html">
       First-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/8_pde_second_order.html">
       Canonical form of second-order linear PDEs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/9_poisson_laplace_eq.html">
       Poisson’s and Laplace’s equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/10_heat_eq.html">
       Heat (diffusion) equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/11_pde_fourier.html">
       Solving PDEs with fourier methods
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/12_wave_eq.html">
       Wave equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/differential_equations/13_similarity_solutions.html">
       Self-similar solutions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/linear_algebra/intro.html">
     Linear algebra
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/linear_algebra/1_Basic_definitions_and_operations.html">
       Basic definitions and operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/linear_algebra/2_Linear_Systems.html">
       Systems of linear equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/linear_algebra/3_Theory.html">
       Theory
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/linear_algebra/4_Eigenvalues_and_eigenvectors.html">
       Eigenvalues and eigenvectors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/linear_algebra/5_Linear_Algebra_in_Python.html">
       Linear Algebra in Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/mathematical_notation/intro.html">
     Mathematical notation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/mathematical_notation/Big_O_notation.html">
       Big O notation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/mathematical_notation/Tensors_Review.html">
       Review of tensors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/numerical_methods/intro.html">
     Numerical methods
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/1_Interpolation_curve_fitting.html">
       Interpolation and curve fitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/2_Numerical_differentiation.html">
       Numerical differentiation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/3_Timestepping_an_ODE.html">
       Solving or timestepping an ODE
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/4_Heuns_method.html">
       Heun’s method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/5_Runge_Kutta_method.html">
       Runge-Kutta method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/6_Solving_PDEs_SOR.html">
       Successive over-relaxation method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/7_FTCS.html">
       FTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/8_BTCS.html">
       BTCS scheme
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/9_Numerical_integration.html">
       Numerical integration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/10_Roots_of_equations.html">
       Roots of equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/11_linear_algebra_intro.html">
       Linear algebra introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/12_Gaussian_elimination.html">
       Gaussian elimination
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/13_LU_decomposition.html">
       LU decomposition
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/14_ill_conditioning_errors.html">
       Ill-conditioning and roundoff errors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/numerical_methods/15_iterative_methods_to_solve_matrix.html">
       Iterative methods to solve a matrix
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/series_and_sequences/intro.html">
     Series and sequences
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/series_and_sequences/Fourier_series.html">
       Fourier series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/series_and_sequences/Fourier_transforms.html">
       Fourier transforms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/series_and_sequences/Taylor_series.html">
       Taylor series
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/sets_and_functions/intro.html">
     Sets and functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/sets_and_functions/1_logic.html">
       Logic and proof
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/sets_and_functions/2_sets.html">
       Sets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/sets_and_functions/3_functions.html">
       Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/sets_and_functions/4_elementary_functions_1.html">
       Elementary functions 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/sets_and_functions/5_elementary_functions_2.html">
       Elementary functions 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/sets_and_functions/6_composition_and_inverse.html">
       Composition and Inverse Functions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../c_mathematics/statistics/intro.html">
     Statistics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/statistics/Linear_Regression.html">
       Linear regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../c_mathematics/statistics/Statistics_for_Geoscientists.html">
       Introduction to statistics for Geoscientists
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro.html">
   Geosciences
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
  <label for="toctree-checkbox-23">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../1D_Heat_Conduction.html">
     1D heat conduction (layered medium)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1D_Resistivity_Forward_Modelling.html">
     1D resistivity forward modelling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3D_Earthquake_Focus_Plot.html">
     Plotting Earthquake Focus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Climate_Model.html">
     Climate model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Downloading_earthquake_data.html">
     Downloading earthquake data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Keplerian_Orbits.html">
     Keplerian orbits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Longitude_Latitude_Degree_Convertion.html">
     Reading Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Milankovitch_cycles.html">
     Milankovitch cycles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Seafloor_ages.html">
     Seafloor ages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Tides.html">
     Tides
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Wave_dispersion.html">
     Wave dispersion
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Electromagnetism/intro.html">
     Electromagnetism
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Electromagnetism/1_electricity_magnetism.html">
       Electricity and magnetism
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Electromagnetism/2_maxwell_eqs.html">
       Maxwell’s equations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Electromagnetism/3_four_field.html">
       The four-field formalism
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Fluid_Dynamics/intro.html">
     Fluid dynamics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
    <label for="toctree-checkbox-25">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Fluid_Dynamics/Lecture5_1D_Pipe_Flow.html">
       1D Pipe Flow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Fluid_Dynamics/Lecture6_Non_Linear_Viscosity_2D_Stokes.html">
       Non Linear Viscosity 2D Stokes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Fluid_Dynamics/Lecture7_Pipe_Flow_with_Heat.html">
       Pipe Flow with Heat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Fluid_Dynamics/Lecture8_Part1_Navier_Stoke_Equation.html">
       Navier Stoke Equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Fluid_Dynamics/Lecture8_Part2_SPH_Algorithm_For_Energy_Equation.html">
       SPH Algorithm for Energy Equation
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Geophysical%20Fluid%20Dynamics/intro.html">
     Geophysical Fluid Dynamics of the Oceans
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
    <label for="toctree-checkbox-26">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Geophysical%20Fluid%20Dynamics/Mixed%20layer.html">
       The mixed layer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Geophysical%20Fluid%20Dynamics/Stream%20lines.html">
       Stream functions and stream lines
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="intro.html">
     High-Temperature Geochemistry
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/>
    <label for="toctree-checkbox-27">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="Distribution_Coefficients.html">
       Distribution coefficients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Evaporation_and_Condensation.html">
       Evaporation and Condensation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Isotope_Systematics_of_Mixing.html">
       Isotope Systematics of Mixing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Lu-Hf_Decay.html">
       Lu-Hf Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Major_and_Trace_Elements.html">
       Major and trace elements
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Melting and crystalisation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Nuclides.html">
       Nuclides
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Radioactive_Dating.html">
       Radioactive Dating
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Rb-Sr_Decay.html">
       Rb-Sr Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Re-Os_Decay.html">
       Re-Os Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Sm-Nd_Decay.html">
       Sm-Nd Decay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="Stable_Isotope_Geochemistry%20.html">
       Stable Isotope Geochemistry
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="U-Th-Pb_Decay.html">
       U-Th-Pb Decay
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Low-Temperature%20Geochemistry/intro.html">
     Low-Temperature Geochemistry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/>
    <label for="toctree-checkbox-28">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/Arrhenius_Equation.html">
       Arrhenius Equation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/CO2_H2O_System.html">
       CO2-H2O System
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/Defining_Activity_Coefficients.html">
       Defining activity coefficients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/Hess_Law.html">
       Hess’ law
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/Pourbaix_Diagram.html">
       Pourbaix Diagram
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/Rate_Law.html">
       Rate Law
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/Reaction_Quotients.html">
       Reaction Quotients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Low-Temperature%20Geochemistry/Stability_Diagram.html">
       Stability Diagram
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Physical%20Processes/intro.html">
     Physical Processes
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/>
    <label for="toctree-checkbox-29">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Physical%20Processes/Dimensional_Analysis.html">
       Dimensional Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Physical%20Processes/Fluids_%26_the_Bernoulli_effect.html">
       Fluids &amp; the Bernoulli effect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Physical%20Processes/Heat.html">
       Heat
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Physical%20Processes/Isostasy.html">
       Isostasy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Physical%20Processes/Reynolds_number.html">
       Reynolds number
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Pure%20and%20Applied%20Geophysics/intro.html">
     Pure and Applied Geophysics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/>
    <label for="toctree-checkbox-30">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Pure%20and%20Applied%20Geophysics/Gravity%20correction.html">
       Gravity corrections
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Pure%20and%20Applied%20Geophysics/Magnetic%20surveys.html">
       Magnetic surveys
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Waves/intro.html">
     Waves
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/>
    <label for="toctree-checkbox-31">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Waves/Attenuation.html">
       Attenuation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Waves/Fourier_Series.html">
       Fourier series
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Waves/Introduction_To_Waves.html">
       Introduction to waves
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Waves/Refraction.html">
       Superposition of Waves, Reflection and Refraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Waves/Transmission_and_Reflection.html">
       Impedance, Transmission and Reflection
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../remote_sensing/intro.html">
     Remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/>
    <label for="toctree-checkbox-32">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../remote_sensing/Image_Filtering.html">
       Image filtering
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../remote_sensing/Image_Point_Operations.html">
       Image point operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../remote_sensing/Image_Transformations_and_Orthorectification.html">
       Image transformations and orthorectification
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../e_extra/intro.html">
   Further resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/>
  <label for="toctree-checkbox-33">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Camera_Calibration.html">
     Camera calibration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Cartography_Cartopy.html">
     Cartopy (maps)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Dakota.html">
     Dakota
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Foundations.html">
     Google Earth Engine foundations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Google_Earth_Engine_Getting_Started_.html">
     Google Earth Engine getting started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/Particle_Image_Velocimetry.html">
     Particle image velocimetry (PIV)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../e_extra/contributors_guide.html">
     Contributor’s guide
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../e_extra/UAV_Mapping/intro.html">
     UAV Mapping
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/>
    <label for="toctree-checkbox-34">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/UAV_Mapping/1.Mission_Planning.html">
       1. Mission Planning
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/intro.html">
     Machine learning
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/>
    <label for="toctree-checkbox-35">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%200%20--%20Introduction.html">
       Chapter 0 – Introduction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%201%20--%20Neural%20Network.html">
       Chapter 1 – Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%202%20--%20Maximum%20Likelihood.html">
       Chapter 2 – Maximum Likelihood
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%203%20--%20Cross%20Entropy.html">
       Chapter 3 – Cross Entropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%204%20--%20Cost%20Function.html">
       Chapter 4 – Cost Function
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%205%20--%20Gradient%20Descent%201.html">
       Chapter 5 – Gradient Descent 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%206%20--%20Gradient%20Descent%202.html">
       Chapter 6 – Gradient Descent 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%207%20--%20Real%20%28Non-linear%29%20Neural%20Network.html">
       Chapter 7 – Real (Non-linear) Neural Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%208%20--%20Feedforward.html">
       Chapter 8 – Feedforward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%209%20--%20Back%20Propagation.html">
       Chapter 9 – Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2010%20--%20General%20Back%20Propagation.html">
       Chapter 10 – General Back Propagation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2011%20--%20Underfitting%20and%20Overfitting.html">
       Chapter 11 – Underfitting and Overfitting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2012%20--%20Early-stopping%2C%20Dropout%20%26%20Mini-batch.html">
       Chapter 12 – Early-stopping, Dropout &amp; Mini-batch
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2013%20--%20Vanishing%20Gradient%201.html">
       Chapter 13 – Vanishing Gradient 1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2014%20--%20Vanishing%20Gradient%202.html">
       Chapter 14 – Vanishing Gradient 2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2015%20--%20Regularisation.html">
       Chapter 15 – Regularisation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2016%20--%20Other%20Activation%20Functions.html">
       Chapter 16 – Other Activation Functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2017%20--%20Local%20Minima%20Trap.html">
       Chapter 17 – Local Minima Trap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2018%20--%20Softmax.html">
       Chapter 18 – Softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2019%20--%20Hyper-Parameters.html">
       Chapter 19 – Hyper-Parameters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../e_extra/pytorch_image_filtering_ml/Chapter%2020%20--%20Coding%20Example.html">
       Chapter 20 – Coding Example
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/primer-computational-mathematics/book/master?urlpath=tree/notebooks/d_geosciences/High-Temperature Geochemistry/Melting_and_Crystalisation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/primer-computational-mathematics/book/issues/new?title=Issue%20on%20page%20%2Fd_geosciences/High-Temperature Geochemistry/Melting_and_Crystalisation.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/d_geosciences/High-Temperature Geochemistry/Melting_and_Crystalisation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#batch-equilibrium-melting">
   Batch (equilibrium) melting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fractional-melting">
   Fractional melting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#batch-equilibrium-crystallization">
   Batch (equilibrium) crystallization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fractional-crystallization">
   Fractional crystallization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#last-remarks">
   Last remarks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-set-2">
   Problem Set 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Melting and crystalisation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#batch-equilibrium-melting">
   Batch (equilibrium) melting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fractional-melting">
   Fractional melting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#batch-equilibrium-crystallization">
   Batch (equilibrium) crystallization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fractional-crystallization">
   Fractional crystallization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#last-remarks">
   Last remarks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-set-2">
   Problem Set 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="melting-and-crystalisation">
<h1>Melting and crystalisation<a class="headerlink" href="#melting-and-crystalisation" title="Permalink to this headline">#</a></h1>
<p><a class="reference internal" href="../../a_modules/intro.html#module-htg"><span class="std std-ref"><!-- module-htg badge --><span class="module module-htg">High-Temperature Geochemistry</span></span></a></p>
<p>Trace elements can be used effectively to understand igneous processes – this is because trace element fractionation is governed by the mineral phases present, which in turn are governed by pressure, temperature and chemical composition.</p>
<p>Precise trace element data can be obtained on small samples or <em>in situ</em> with ion probes or by laser ablation-ICP-MS. Such data provide unprecedented insights into igneous processes.</p>
<p>There are a wide variety of quantitative models that attempt to describe trace element behavior during partial melting and crystal fractionation. In the following, we will discuss and apply the simplest but still very useful form of models.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import relevant modules</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log10</span><span class="p">,</span> <span class="n">floor</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create our own functions</span>

<span class="c1"># function to calculate the bulk distribution coefficient of an element in a rock</span>
<span class="c1"># make sure the orders of values for each mineral are correct</span>
<span class="k">def</span> <span class="nf">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_list</span><span class="p">,</span> <span class="n">KD_list</span><span class="p">):</span>
    <span class="n">minerals_percentages_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">minerals_percentages_list</span><span class="p">)</span>
    <span class="n">KD_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">KD_list</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">minerals_percentages_array</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="n">KD_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span>


<span class="c1"># function to round a value to a certain number of significant figures</span>
<span class="k">def</span> <span class="nf">round_to_n_sf</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">no_of_significant_figures</span><span class="p">):</span>
    <span class="n">value_rounded</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">no_of_significant_figures</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)))))</span>
    <span class="k">return</span> <span class="n">value_rounded</span>
            
</pre></div>
</div>
</div>
</div>
<section id="batch-equilibrium-melting">
<h2>Batch (equilibrium) melting<a class="headerlink" href="#batch-equilibrium-melting" title="Permalink to this headline">#</a></h2>
<p id="index-0">Batch melting involves complete equilibration between the solid phase (rock) and the melt (liquid) that is produced. This yields the following mass balance for the concentrations of an element:</p>
<div class="math notranslate nohighlight">
\[C_0 = C_L F + C_S (1-F)\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_0\)</span> is the original concentration of the solid (and the whole system),</p></li>
<li><p><span class="math notranslate nohighlight">\(C_L\)</span> is the concentration of the liquid,</p></li>
<li><p><span class="math notranslate nohighlight">\(C_S\)</span> is the concentration of the solid,</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span> is the melt fraction (= (mass of melt)/(mass of system))</p></li>
</ul>
<p>With the definition of a distribution coefficient <span class="math notranslate nohighlight">\(D = \frac{C_S}{C_L}\)</span>, this can be rearranged to:</p>
<div class="math notranslate nohighlight">
\[C_0 = C_L F + C_L D (1-F)\]</div>
<div class="math notranslate nohighlight">
\[\therefore \frac{C_L}{C_0} = \frac{1}{F + D(1-F)}\]</div>
<p>The equation above describes the enrichment or depletion of a trace element in a melt (relative to the original state in the unmolten solid) as a function of the degree of melting. We can plot it to see the change of the ratio of <span class="math notranslate nohighlight">\(C_L\)</span> and <span class="math notranslate nohighlight">\(C_0\)</span> as a rock is melting (<span class="math notranslate nohighlight">\(F\)</span> increases).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for calculating the CL/C0 ratio of melt from batch melting</span>
<span class="k">def</span> <span class="nf">ratio_CL_C0_batch_melting</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">F</span><span class="o">+</span><span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of CL/C0 against F at various D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF9B3C&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;#00F3FF&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span>
    <span class="n">ratio_CL_C0</span> <span class="o">=</span> <span class="n">ratio_CL_C0_batch_melting</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">ratio_CL_C0</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$D=</span><span class="si">{</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;melt fraction ($F$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration in liquid /</span><span class="se">\n</span><span class="s1">Original concentration in source&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Batch melting&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fb8607aaf0&gt;
</pre></div>
</div>
<img alt="../../_images/Melting_and_Crystalisation_6_1.png" src="../../_images/Melting_and_Crystalisation_6_1.png" />
</div>
</div>
<p>It is useful to consider and discuss three special cases of partial melting:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(D &lt;&lt; F\)</span>, then <span class="math notranslate nohighlight">\(\frac{C_L}{C_0}\approx\frac{1}{F}\)</span>. The degree of enrichment for a highly incompatible trace element is inversely proportional to the degree of melting.</p></li>
<li><p>As <span class="math notranslate nohighlight">\(F\)</span> approaches <span class="math notranslate nohighlight">\(0\)</span> (very little melting), then <span class="math notranslate nohighlight">\(\frac{C_L}{C_0}\approx\frac{1}{D}\)</span>. This means that the degree of enrichment depends on the compatibility of an element. The maximum enrichment that can be achieved is <span class="math notranslate nohighlight">\(\frac{1}{D}\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(D\)</span> is large (<span class="math notranslate nohighlight">\(&gt;1\)</span>; compatible element), the depletion in the melt is <span class="math notranslate nohighlight">\(\frac{1}{D}\)</span> when <span class="math notranslate nohighlight">\(F\)</span> is small. This result is relatively insensitive to <span class="math notranslate nohighlight">\(F\)</span>.</p></li>
</ul>
<p>Given this relationship:</p>
<div class="math notranslate nohighlight">
\[\frac{C_L}{C_0} = \frac{1}{F + D(1-F)}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[D = \frac{C_S}{C_L}\]</div>
<p>The trace element concentration of the residual solid rock that is in equilibrium with a partial batch equilibrium melt is straightforward to calculate:</p>
<div class="math notranslate nohighlight">
\[\frac{C_S}{C_0} = \frac{D}{F + D(1-F)} = \frac{C_LD}{C_0}\]</div>
</section>
<section id="fractional-melting">
<h2>Fractional melting<a class="headerlink" href="#fractional-melting" title="Permalink to this headline">#</a></h2>
<p id="index-1">If melting is very rapid and the liquids are sufficiently low in viscosity, the melts can be quickly driven away from the source rock by buoyancy forces. In this case, the solid will be unable to equilibrate with the total amount of melt that is produced during the melting process. Hence we have incomplete equilibration between solid and melt.</p>
<p>For the modelling, we can treat this case as equilibration of the solid with an infinitesimally small amount of liquid. The mass balance of the system then yields the following equation:</p>
<div class="math notranslate nohighlight">
\[\frac{C_{L, increment}}{C_0} = \frac{1}{D}(1-F)^{\frac{1}{D}-1}\]</div>
<p>This equation describes the composition of a <strong>single melt increment</strong> that is formed at a particular value of <span class="math notranslate nohighlight">\(F\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for calculating the CL/C0 ratio of melt increment formed at a particular F</span>
<span class="k">def</span> <span class="nf">ratio_CL_increment_C0_fractional_melting</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">D</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of CL/C0 against F at various D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF9B3C&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;#00F3FF&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span>
    <span class="n">ratio_CL_C0</span> <span class="o">=</span> <span class="n">ratio_CL_increment_C0_fractional_melting</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">ratio_CL_C0</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$D=</span><span class="si">{</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;melt fraction ($F$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration in liquid /</span><span class="se">\n</span><span class="s1">Original concentration in source&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fractional Melting – Composition of Melt Increments&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fb871eb3d0&gt;
</pre></div>
</div>
<img alt="../../_images/Melting_and_Crystalisation_11_1.png" src="../../_images/Melting_and_Crystalisation_11_1.png" />
</div>
</div>
<p>Note how quickly the concentrations of the incompatible elements (<span class="math notranslate nohighlight">\(D &lt; 1\)</span>) decline in melt increments that are formed at higher degrees of partial melting (e.g., <span class="math notranslate nohighlight">\(F &gt; 1\%\)</span> for <span class="math notranslate nohighlight">\(D = 0.001\)</span>).</p>
<p>An <strong>aggregate liquid</strong> can be produced by mixing the various melt increments that are formed over the melting interval <span class="math notranslate nohighlight">\(F = 0\)</span> to <span class="math notranslate nohighlight">\(F\)</span>.</p>
<div class="math notranslate nohighlight">
\[\frac{C_{L, aggregate}}{C_0} = \frac{\int_{0}^{F}\frac{C_{L, increment}}{C_0}dF}{F-0} = \frac{\int_{0}^{F}\frac{1}{D}(1-F)^{\frac{1}{D}-1}dF}{F-0}\]</div>
<p>So, the composition of this aggregate liquid is given by:</p>
<div class="math notranslate nohighlight">
\[\frac{C_{L, aggregate}}{C_0} = \frac{1}{F}[1-(1-F)^{\frac{1}{D}}]\]</div>
<p>Note that aggregated fractional melts have compositions that are similar to batch melts for the same value of <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>Real melting probably lies somewhere between the two extremes of batch and fractional melting and is likely to be more complicated also!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for calculating the CL/C0 ratio of aggregate melt formed over the melting interval F=0 to F</span>
<span class="k">def</span> <span class="nf">ratio_CL_aggregate_C0_fractional_melting</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">F</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">D</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of CL/C0 against F at various D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF9B3C&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;#00F3FF&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span>
    <span class="c1"># the equation describing the composition of an aggregate liquid formed over the melting interval F=0 to F</span>
    <span class="n">ratio_CL_C0</span> <span class="o">=</span> <span class="n">ratio_CL_aggregate_C0_fractional_melting</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">ratio_CL_C0</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$D=</span><span class="si">{</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;melt fraction ($F$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration in liquid /</span><span class="se">\n</span><span class="s1">Original concentration in source&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fractional Melting – Composition of Aggregate Melts&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fb8738d1f0&gt;
</pre></div>
</div>
<img alt="../../_images/Melting_and_Crystalisation_14_1.png" src="../../_images/Melting_and_Crystalisation_14_1.png" />
</div>
</div>
</section>
<section id="batch-equilibrium-crystallization">
<h2>Batch (equilibrium) crystallization<a class="headerlink" href="#batch-equilibrium-crystallization" title="Permalink to this headline">#</a></h2>
<p id="index-2">Equilibrium crystallization occurs when the total liquid and the total solid remain in equilibrium throughout the crystallization (differentiation) of a magma. If we define <span class="math notranslate nohighlight">\(F\)</span> as the fraction of the system that is still liquid (not crystallized) then:</p>
<div class="math notranslate nohighlight">
\[\frac{C_L}{C_0} = \frac{1}{F + D(1-F)}\]</div>
<p>Note that this equation is identical to the batch melting equation!</p>
<p>This model is probably not applicable to the formation of solid mineral crystals in a magma chamber because it requires that even the crystal interiors are in continuous equilibrium with the melt. This can only be achieved by solid-state diffusion and this is too slow over mineral-sized distances (mm to cm) to permit equilibration, even at magmatic temperatures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for calculating the CL/C0 ratio of remaining melt after batch crystallization</span>
<span class="k">def</span> <span class="nf">ratio_CL_C0_batch_crystallization</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">F</span><span class="o">+</span><span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of CL/C0 against F at various D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF9B3C&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;#00F3FF&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span>
    <span class="n">ratio_CL_C0</span> <span class="o">=</span> <span class="n">ratio_CL_C0_batch_crystallization</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">ratio_CL_C0</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$D=</span><span class="si">{</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;melt fraction ($F$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration in liquid /</span><span class="se">\n</span><span class="s1">Original concentration in source&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Batch crystallization&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fb8867e490&gt;
</pre></div>
</div>
<img alt="../../_images/Melting_and_Crystalisation_17_1.png" src="../../_images/Melting_and_Crystalisation_17_1.png" />
</div>
</div>
<p>The equilibrium crystallization model is nonetheless useful because it can be applied to the equilibration of two immiscible melts, which can both rapidly equilibrate internally by diffusion:</p>
<ul class="simple">
<li><p>Equilibrium between a silicate melt and a metallic melt – relevant for core formation on Earth, where an Fe-rich melt segregated from the molten silicate mantle. Here we would use <span class="math notranslate nohighlight">\(K_D\)</span> values for the system metallic meltsilicate melt.</p></li>
<li><p>Equilibrium between a silicate melt and an immiscible sulfide melt – relevant for the formation of sulfide-ore deposits and (at a smaller scale) the differentiation of many basaltic melts in near-surface magma chambers. Here we would use <span class="math notranslate nohighlight">\(K_D\)</span> values for the system sulfide meltsilicate melt.</p></li>
</ul>
</section>
<section id="fractional-crystallization">
<h2>Fractional crystallization<a class="headerlink" href="#fractional-crystallization" title="Permalink to this headline">#</a></h2>
<p id="index-3">Fractional crystallization assumes that an instantaneous equilibrium is achieved between the liquid and an (infinitesimally) thin surface layer of a solid crystal. In this case, the relevant partitioning equation is:</p>
<div class="math notranslate nohighlight">
\[\frac{C_{L}}{C_0} = F^{D-1}\]</div>
<p>Fractional crystallization has a dramatic effect on compatible element abundances, as these are rapidly depleted in the melt.</p>
<p>Incompatible elements (<span class="math notranslate nohighlight">\(D &lt; 1\)</span>) are enriched in the remaining melt, by a factor that is the inverse to the amount of liquid remaining. Hence, they do not change greatly in concentration until &gt;90% of the magma has crystallized.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for calculating the CL/C0 ratio of remaining melt (fraction of melt remaining = F) after fractional crystallization</span>
<span class="k">def</span> <span class="nf">ratio_CL_C0_fractional_crystallization</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">F</span><span class="o">**</span><span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of CL/C0 against F at various D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF9B3C&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;#00F3FF&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span>
    <span class="c1"># the equation describing the composition of a remaining liquid (fraction of melt remaining = F)</span>
    <span class="n">ratio_CL_C0</span> <span class="o">=</span> <span class="n">ratio_CL_C0_fractional_crystallization</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">ratio_CL_C0</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$D=</span><span class="si">{</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;melt fraction ($F$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration in liquid /</span><span class="se">\n</span><span class="s1">Original concentration in source&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fractional crystallization&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fb8a74f280&gt;
</pre></div>
</div>
<img alt="../../_images/Melting_and_Crystalisation_21_1.png" src="../../_images/Melting_and_Crystalisation_21_1.png" />
</div>
</div>
<p>Given</p>
<div class="math notranslate nohighlight">
\[\frac{C_{L}}{C_0} = F^{D-1}\]</div>
<p>the trace element concentration of a crystal layer that is in equilibrium with a residual melt at a particular value of <span class="math notranslate nohighlight">\(F\)</span> is</p>
<div class="math notranslate nohighlight">
\[\frac{C_{S, increment}}{C_0} = DF^{D-1}\]</div>
<p>The mean trace element concentration of a crystal that is formed by crystallization between <span class="math notranslate nohighlight">\(F = 1\)</span> and <span class="math notranslate nohighlight">\(F\)</span> is</p>
<div class="math notranslate nohighlight">
\[\frac{C_{S, aggregate}}{C_0} = \frac{\int_{F}^{1}\frac{C_{S, increment}}{C_0}dF}{1-F} = \frac{\int_{F}^{1}DF^{D-1}dF}{1-F}\]</div>
<div class="math notranslate nohighlight">
\[\therefore \frac{C_{S, aggregate}}{C_0} = \frac{1-F^D}{1-F}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for calculating the CS/C0 ratio of aggregate crystal after fractional crystallization</span>
<span class="k">def</span> <span class="nf">ratio_CS_aggregate_C0_fractional_crystallization</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">F</span><span class="o">**</span><span class="n">D</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="last-remarks">
<h2>Last remarks<a class="headerlink" href="#last-remarks" title="Permalink to this headline">#</a></h2>
<p>Note that fractional crystallization and partial melting have opposite effects on trace element ratios:</p>
<ul class="simple">
<li><p>Incompatible elements with small <span class="math notranslate nohighlight">\(D\)</span> values are most readily fractionated from each other at small degrees of partial melting rather than by fractional crystallization.</p></li>
<li><p>Compatible elements are easy to fractionate from one another by fractional crystallization. Such fractionations are difficult to achieve by partial melting at values of <span class="math notranslate nohighlight">\(F\)</span> that correspond to the formation of common basaltic magmas (<span class="math notranslate nohighlight">\(F \approx 5 - 15\%\)</span>).</p></li>
</ul>
</section>
<section id="problem-set-2">
<h2>Problem Set 2<a class="headerlink" href="#problem-set-2" title="Permalink to this headline">#</a></h2>
<p>Assume a mantle source that is characterized by the following trace element concentrations: <span class="math notranslate nohighlight">\(0.703\,\mu g/g\)</span> <span class="math notranslate nohighlight">\(Nd\)</span>, <span class="math notranslate nohighlight">\(0.273\,\mu g/g\)</span> <span class="math notranslate nohighlight">\(Sm\)</span>, and <span class="math notranslate nohighlight">\(1880\,\mu g/g\)</span> <span class="math notranslate nohighlight">\(Ni\)</span>. Use the partition coefficients from the handout for the following calculations.</p>
<p>(1) Calculate the <span class="math notranslate nohighlight">\(Nd\)</span>, <span class="math notranslate nohighlight">\(Sm\)</span>, and <span class="math notranslate nohighlight">\(Ni\)</span> concentrations of a batch equilibrium partial melt that is formed at <span class="math notranslate nohighlight">\(F = 10\%\)</span> by melting of a source with a spinel peridotite mineralogy (<span class="math notranslate nohighlight">\(66\%\)</span> ol, <span class="math notranslate nohighlight">\(24\%\)</span> opx, <span class="math notranslate nohighlight">\(8\%\)</span> cpx and <span class="math notranslate nohighlight">\(2\%\)</span> spinel). What are the <span class="math notranslate nohighlight">\(Nd\)</span>, <span class="math notranslate nohighlight">\(Sm\)</span>, and <span class="math notranslate nohighlight">\(Ni\)</span> concentrations of the residual rock that are in equilibrium with the <span class="math notranslate nohighlight">\(10\%\)</span> melt?</p>
<p>We have been given the original concentrations (<span class="math notranslate nohighlight">\(C_0\)</span>) of <span class="math notranslate nohighlight">\(Nd\)</span>, <span class="math notranslate nohighlight">\(Sm\)</span>, and <span class="math notranslate nohighlight">\(Ni\)</span> in the source. So, we can find the concentrations of those elements in the melt produced by batch melting (<span class="math notranslate nohighlight">\(C_L\)</span>) by finding <span class="math notranslate nohighlight">\(\frac{C_L}{C_0}\)</span> using the equation below and multiplying the ratio by <span class="math notranslate nohighlight">\(C_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{C_L}{C_0} = \frac{1}{F + D(1-F)}\]</div>
<p>After that, we can find the concentrations of those elements in the remaining solid (<span class="math notranslate nohighlight">\(C_S\)</span>) using the definition of bulk distribution coefficients:</p>
<div class="math notranslate nohighlight">
\[D = \frac{C_S}{C_L}\]</div>
<p>But first of all, we need the distribution coefficients from the handout. See the table below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a dataframe to show the distribution coefficients of some elements in some minerals acquired from the handout</span>
<span class="n">minerals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Olivine (ol)&quot;</span><span class="p">,</span> <span class="s2">&quot;Orthopyroxene (opx)&quot;</span><span class="p">,</span> <span class="s2">&quot;Clinopyroxene (cpx)&quot;</span><span class="p">,</span> <span class="s2">&quot;Spinel (sp)&quot;</span><span class="p">,</span> <span class="s2">&quot;Garnet (gn)&quot;</span><span class="p">,</span> <span class="s2">&quot;Plagioclase (plag)&quot;</span><span class="p">]</span>
<span class="n">KD_Rb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">]</span>
<span class="n">KD_U</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span>
<span class="n">KD_Pb</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="n">KD_Sr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">KD_Nd</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">]</span>
<span class="n">KD_Sm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">]</span>
<span class="n">KD_Cr</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]</span>
<span class="n">KD_Ni</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">]</span>

<span class="n">dict1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;&#39;</span> <span class="p">:</span> <span class="n">minerals</span><span class="p">,</span>
        <span class="s1">&#39;Rb&#39;</span> <span class="p">:</span> <span class="n">KD_Rb</span><span class="p">,</span>
        <span class="s1">&#39;U&#39;</span> <span class="p">:</span> <span class="n">KD_U</span><span class="p">,</span>
        <span class="s1">&#39;Pb&#39;</span> <span class="p">:</span> <span class="n">KD_Pb</span><span class="p">,</span>
        <span class="s1">&#39;Sr&#39;</span> <span class="p">:</span> <span class="n">KD_Sr</span><span class="p">,</span>
        <span class="s1">&#39;Nd&#39;</span> <span class="p">:</span> <span class="n">KD_Nd</span><span class="p">,</span>
        <span class="s1">&#39;Sm&#39;</span> <span class="p">:</span> <span class="n">KD_Sm</span><span class="p">,</span>
        <span class="s1">&#39;Cr&#39;</span> <span class="p">:</span> <span class="n">KD_Cr</span><span class="p">,</span>
        <span class="s1">&#39;Ni&#39;</span> <span class="p">:</span> <span class="n">KD_Ni</span><span class="p">}</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dict1</span><span class="p">)</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Rb&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;Pb&#39;</span><span class="p">,</span> <span class="s1">&#39;Sr&#39;</span><span class="p">,</span> <span class="s1">&#39;Nd&#39;</span><span class="p">,</span> <span class="s1">&#39;Sm&#39;</span><span class="p">,</span> <span class="s1">&#39;Cr&#39;</span><span class="p">,</span> <span class="s1">&#39;Ni&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
    <span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">e</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table 1: The distribution coefficients of some elements in some minerals.&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">hide_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table 1: The distribution coefficients of some elements in some minerals.
</pre></div>
</div>
<div class="output text_html"><style  type="text/css" >
</style><table id="T_ee379_" ><thead>    <tr>        <th class="col_heading level0 col0" ></th>        <th class="col_heading level0 col1" >Rb</th>        <th class="col_heading level0 col2" >U</th>        <th class="col_heading level0 col3" >Pb</th>        <th class="col_heading level0 col4" >Sr</th>        <th class="col_heading level0 col5" >Nd</th>        <th class="col_heading level0 col6" >Sm</th>        <th class="col_heading level0 col7" >Cr</th>        <th class="col_heading level0 col8" >Ni</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_ee379_row0_col0" class="data row0 col0" >Olivine (ol)</td>
                        <td id="T_ee379_row0_col1" class="data row0 col1" >4.0e-05</td>
                        <td id="T_ee379_row0_col2" class="data row0 col2" >2.0e-05</td>
                        <td id="T_ee379_row0_col3" class="data row0 col3" >8.0e-03</td>
                        <td id="T_ee379_row0_col4" class="data row0 col4" >6.0e-05</td>
                        <td id="T_ee379_row0_col5" class="data row0 col5" >1.0e-04</td>
                        <td id="T_ee379_row0_col6" class="data row0 col6" >4.0e-04</td>
                        <td id="T_ee379_row0_col7" class="data row0 col7" >6.0e-01</td>
                        <td id="T_ee379_row0_col8" class="data row0 col8" >8.0e+00</td>
            </tr>
            <tr>
                                <td id="T_ee379_row1_col0" class="data row1 col0" >Orthopyroxene (opx)</td>
                        <td id="T_ee379_row1_col1" class="data row1 col1" >5.0e-03</td>
                        <td id="T_ee379_row1_col2" class="data row1 col2" >1.0e-03</td>
                        <td id="T_ee379_row1_col3" class="data row1 col3" >1.0e-02</td>
                        <td id="T_ee379_row1_col4" class="data row1 col4" >5.0e-03</td>
                        <td id="T_ee379_row1_col5" class="data row1 col5" >1.0e-02</td>
                        <td id="T_ee379_row1_col6" class="data row1 col6" >2.0e-02</td>
                        <td id="T_ee379_row1_col7" class="data row1 col7" >2.0e+00</td>
                        <td id="T_ee379_row1_col8" class="data row1 col8" >4.0e+00</td>
            </tr>
            <tr>
                                <td id="T_ee379_row2_col0" class="data row2 col0" >Clinopyroxene (cpx)</td>
                        <td id="T_ee379_row2_col1" class="data row2 col1" >3.0e-03</td>
                        <td id="T_ee379_row2_col2" class="data row2 col2" >1.0e-02</td>
                        <td id="T_ee379_row2_col3" class="data row2 col3" >1.0e-02</td>
                        <td id="T_ee379_row2_col4" class="data row2 col4" >1.6e-01</td>
                        <td id="T_ee379_row2_col5" class="data row2 col5" >2.8e-01</td>
                        <td id="T_ee379_row2_col6" class="data row2 col6" >4.6e-01</td>
                        <td id="T_ee379_row2_col7" class="data row2 col7" >4.0e+00</td>
                        <td id="T_ee379_row2_col8" class="data row2 col8" >3.0e+00</td>
            </tr>
            <tr>
                                <td id="T_ee379_row3_col0" class="data row3 col0" >Spinel (sp)</td>
                        <td id="T_ee379_row3_col1" class="data row3 col1" >5.0e-04</td>
                        <td id="T_ee379_row3_col2" class="data row3 col2" >1.0e-03</td>
                        <td id="T_ee379_row3_col3" class="data row3 col3" >nan</td>
                        <td id="T_ee379_row3_col4" class="data row3 col4" >5.0e-04</td>
                        <td id="T_ee379_row3_col5" class="data row3 col5" >6.0e-04</td>
                        <td id="T_ee379_row3_col6" class="data row3 col6" >5.0e-04</td>
                        <td id="T_ee379_row3_col7" class="data row3 col7" >2.0e+02</td>
                        <td id="T_ee379_row3_col8" class="data row3 col8" >1.0e+01</td>
            </tr>
            <tr>
                                <td id="T_ee379_row4_col0" class="data row4 col0" >Garnet (gn)</td>
                        <td id="T_ee379_row4_col1" class="data row4 col1" >7.0e-03</td>
                        <td id="T_ee379_row4_col2" class="data row4 col2" >6.0e-03</td>
                        <td id="T_ee379_row4_col3" class="data row4 col3" >1.0e-04</td>
                        <td id="T_ee379_row4_col4" class="data row4 col4" >1.0e-02</td>
                        <td id="T_ee379_row4_col5" class="data row4 col5" >3.6e-01</td>
                        <td id="T_ee379_row4_col6" class="data row4 col6" >1.1e+00</td>
                        <td id="T_ee379_row4_col7" class="data row4 col7" >5.0e-01</td>
                        <td id="T_ee379_row4_col8" class="data row4 col8" >4.0e-01</td>
            </tr>
            <tr>
                                <td id="T_ee379_row5_col0" class="data row5 col0" >Plagioclase (plag)</td>
                        <td id="T_ee379_row5_col1" class="data row5 col1" >3.0e-02</td>
                        <td id="T_ee379_row5_col2" class="data row5 col2" >5.0e-02</td>
                        <td id="T_ee379_row5_col3" class="data row5 col3" >1.1e+00</td>
                        <td id="T_ee379_row5_col4" class="data row5 col4" >3.0e+00</td>
                        <td id="T_ee379_row5_col5" class="data row5 col5" >4.0e-02</td>
                        <td id="T_ee379_row5_col6" class="data row5 col6" >3.0e-02</td>
                        <td id="T_ee379_row5_col7" class="data row5 col7" >2.0e-02</td>
                        <td id="T_ee379_row5_col8" class="data row5 col8" >4.0e-02</td>
            </tr>
    </tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 1</span>
<span class="c1"># Elements</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Nd&quot;</span><span class="p">,</span> <span class="s2">&quot;Sm&quot;</span><span class="p">,</span> <span class="s2">&quot;Ni&quot;</span><span class="p">]</span>
<span class="c1"># original concentration of Nd, Sm, Ni in the sources (C0)</span>
<span class="n">C0_source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.703</span><span class="p">,</span> <span class="mf">0.273</span><span class="p">,</span> <span class="mi">1880</span><span class="p">])</span>  <span class="c1"># µg/g</span>
<span class="c1"># the percentages of minerals (ol, opx, cpx, sp, gn, plag) in the source</span>
<span class="n">minerals_percentages_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">66</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1"># calculate the bulk distribution coefficient (D) of Nd, Sm, Ni in the source</span>
<span class="n">D_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_1</span><span class="p">,</span> <span class="n">KD_Nd</span><span class="p">),</span>
     <span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_1</span><span class="p">,</span> <span class="n">KD_Sm</span><span class="p">),</span>
     <span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_1</span><span class="p">,</span> <span class="n">KD_Ni</span><span class="p">)])</span>
<span class="c1"># melt fraction (F)</span>
<span class="n">F_1</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># 10% melt</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the melt (CL)</span>
<span class="n">CL_1</span> <span class="o">=</span> <span class="n">ratio_CL_C0_batch_melting</span><span class="p">(</span><span class="n">F_1</span><span class="p">,</span> <span class="n">D_1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C0_source</span>  <span class="c1"># µg/g</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the remaining solid (CS)</span>
<span class="n">CS_1</span> <span class="o">=</span> <span class="n">CL_1</span> <span class="o">*</span> <span class="n">D_1</span>

<span class="c1"># print answers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For fractional crystallization with F = </span><span class="si">%g</span><span class="s2"> (</span><span class="si">%g%%</span><span class="s2"> melt),&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">F_1</span><span class="p">,</span> <span class="n">F_1</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">%s</span><span class="s2"> concentration in the melt is </span><span class="si">%g</span><span class="s2"> µg/g, and that in the residual rock is </span><span class="si">%g</span><span class="s2"> µg/g.&quot;</span> \
          <span class="o">%</span> <span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CL_1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CS_1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For fractional crystallization with F = 0.1 (10% melt),
The Nd concentration in the melt is 5.74 µg/g, and that in the residual rock is 0.143 µg/g.
The Sm concentration in the melt is 1.98 µg/g, and that in the residual rock is 0.083 µg/g.
The Ni concentration in the melt is 308 µg/g, and that in the residual rock is 2050 µg/g.
</pre></div>
</div>
</div>
</div>
<p>(2) Calculate the <span class="math notranslate nohighlight">\(Nd\)</span>, <span class="math notranslate nohighlight">\(Sm\)</span>, and <span class="math notranslate nohighlight">\(Ni\)</span> concentrations of a batch equilibrium partial melt that is formed at <span class="math notranslate nohighlight">\(F = 3\%\)</span> by melting of a source with a garnet peridotite mineralogy (<span class="math notranslate nohighlight">\(63\%\)</span> ol, <span class="math notranslate nohighlight">\(30\%\)</span> opx, <span class="math notranslate nohighlight">\(2\%\)</span> cpx and <span class="math notranslate nohighlight">\(5\%\)</span> garnet).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 2</span>
<span class="c1"># the percentages of minerals (ol, opx, cpx, sp, gn, plag) in the source</span>
<span class="n">minerals_percentages_2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">63</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1"># calculate the bulk distribution coefficient (D) of Nd, Sm, Ni in the source</span>
<span class="n">D_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_2</span><span class="p">,</span> <span class="n">KD_Nd</span><span class="p">),</span>
     <span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_2</span><span class="p">,</span> <span class="n">KD_Sm</span><span class="p">),</span>
     <span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_2</span><span class="p">,</span> <span class="n">KD_Ni</span><span class="p">)])</span>
<span class="c1"># melt fraction (F)</span>
<span class="n">F_2</span> <span class="o">=</span> <span class="mf">0.03</span>  <span class="c1"># 3% melt</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the melt (CL)</span>
<span class="n">CL_2</span> <span class="o">=</span> <span class="n">ratio_CL_C0_batch_melting</span><span class="p">(</span><span class="n">F_2</span><span class="p">,</span> <span class="n">D_2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C0_source</span>  <span class="c1"># µg/g</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the remaining solid (CS)</span>
<span class="n">CS_2</span> <span class="o">=</span> <span class="n">CL_2</span> <span class="o">*</span> <span class="n">D_2</span>

<span class="c1"># print answers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For fractional crystallization with F = </span><span class="si">%g</span><span class="s2"> (</span><span class="si">%g%%</span><span class="s2"> melt),&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">F_2</span><span class="p">,</span> <span class="n">F_2</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">%s</span><span class="s2"> concentration in the melt is </span><span class="si">%g</span><span class="s2"> µg/g, and that in the residual rock is </span><span class="si">%g</span><span class="s2"> µg/g.&quot;</span> \
          <span class="o">%</span> <span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CL_2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CS_2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For fractional crystallization with F = 0.03 (3% melt),
The Nd concentration in the melt is 12.6 µg/g, and that in the residual rock is 0.336 µg/g.
The Sm concentration in the melt is 2.78 µg/g, and that in the residual rock is 0.196 µg/g.
The Ni concentration in the melt is 305 µg/g, and that in the residual rock is 1930 µg/g.
</pre></div>
</div>
</div>
</div>
<p>(3) Repeat the calculation of Question 2, but for an aggregate melt formed by fractional melting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 3</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the melt (CL)</span>
<span class="n">CL_3</span> <span class="o">=</span> <span class="n">ratio_CL_aggregate_C0_fractional_melting</span><span class="p">(</span><span class="n">F_2</span><span class="p">,</span> <span class="n">D_2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C0_source</span>  <span class="c1"># µg/g</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the remaining solid (CS)</span>
<span class="n">CS_3</span> <span class="o">=</span> <span class="n">CL_3</span> <span class="o">*</span> <span class="n">D_2</span>

<span class="c1"># print answers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For fractional crystallization with F = </span><span class="si">%g</span><span class="s2"> (</span><span class="si">%g%%</span><span class="s2"> melt),&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">F_2</span><span class="p">,</span> <span class="n">F_2</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">%s</span><span class="s2"> concentration in the aggregate melt is </span><span class="si">%g</span><span class="s2"> µg/g, and that in the residual rock is </span><span class="si">%g</span><span class="s2"> µg/g.&quot;</span> \
          <span class="o">%</span> <span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CL_3</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CS_3</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For fractional crystallization with F = 0.03 (3% melt),
The Nd concentration in the aggregate melt is 16 µg/g, and that in the residual rock is 0.425 µg/g.
The Sm concentration in the aggregate melt is 3.19 µg/g, and that in the residual rock is 0.225 µg/g.
The Ni concentration in the aggregate melt is 301 µg/g, and that in the residual rock is 1900 µg/g.
</pre></div>
</div>
</div>
</div>
<p>(4) The <span class="math notranslate nohighlight">\(10\%\)</span> partial melt (of Question 1) pools in a magma chamber where it crystallizes partially, with crystals consisting of <span class="math notranslate nohighlight">\(40\%\)</span> olivine and <span class="math notranslate nohighlight">\(60\%\)</span> plagioclase. Calculate the <span class="math notranslate nohighlight">\(Nd\)</span>, <span class="math notranslate nohighlight">\(Sm\)</span> and <span class="math notranslate nohighlight">\(Ni\)</span> concentrations of the residual liquid, after <span class="math notranslate nohighlight">\(35\%\)</span> of the melt has crystallized (solidified) by ideal fractional crystallization. What are the mean <span class="math notranslate nohighlight">\(Nd\)</span>, <span class="math notranslate nohighlight">\(Sm\)</span>, and <span class="math notranslate nohighlight">\(Ni\)</span> contents of the fractionating assemblage?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 4</span>
<span class="c1"># original concentration of Nd, Sm, Ni in the melt (C0)</span>
<span class="n">C0_melt</span> <span class="o">=</span> <span class="n">CL_1</span>  <span class="c1"># µg/g</span>
<span class="c1"># the percentages of minerals (ol, opx, cpx, sp, gn, plag) in the source</span>
<span class="n">minerals_percentages_4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="c1"># calculate the bulk distribution coefficient (D) of Nd, Sm, Ni in the source</span>
<span class="n">D_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_4</span><span class="p">,</span> <span class="n">KD_Nd</span><span class="p">),</span>
     <span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_4</span><span class="p">,</span> <span class="n">KD_Sm</span><span class="p">),</span>
     <span class="n">bulk_distribution_coefficient_calculator</span><span class="p">(</span><span class="n">minerals_percentages_4</span><span class="p">,</span> <span class="n">KD_Ni</span><span class="p">)])</span>
<span class="c1"># melt fraction (F)</span>
<span class="n">F_4</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.35</span>  <span class="c1"># 35% of the melt has crystallized</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the melt (CL)</span>
<span class="n">CL_4</span> <span class="o">=</span> <span class="n">ratio_CL_C0_fractional_crystallization</span><span class="p">(</span><span class="n">F_4</span><span class="p">,</span> <span class="n">D_4</span><span class="p">)</span> <span class="o">*</span> <span class="n">C0_melt</span>  <span class="c1"># µg/g</span>
<span class="c1"># calculate the concentration of Nd, Sm, Ni in the remaining solid (CS)</span>
<span class="n">CS_4</span> <span class="o">=</span> <span class="n">ratio_CS_aggregate_C0_fractional_crystallization</span><span class="p">(</span><span class="n">F_4</span><span class="p">,</span> <span class="n">D_4</span><span class="p">)</span> <span class="o">*</span> <span class="n">C0_melt</span>  <span class="c1"># µg/g</span>

<span class="c1"># print answers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For fractional crystallization with F = </span><span class="si">%g</span><span class="s2"> (</span><span class="si">%g%%</span><span class="s2"> melt, i.e. </span><span class="si">%g%%</span><span class="s2"> of the melt has crystallized),&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">F_4</span><span class="p">,</span> <span class="n">F_4</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F_4</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">%s</span><span class="s2"> concentration in the remaining melt is </span><span class="si">%g</span><span class="s2"> µg/g, and that in the fractionating assemblage is </span><span class="si">%g</span><span class="s2"> µg/g.&quot;</span> \
          <span class="o">%</span> <span class="p">(</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CL_4</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">CS_4</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For fractional crystallization with F = 0.65 (65% melt, i.e. 35% of the melt has crystallized),
The Nd concentration in the remaining melt is 8.75 µg/g, and that in the fractionating assemblage is 0.169 µg/g.
The Sm concentration in the remaining melt is 3.03 µg/g, and that in the fractionating assemblage is 0.0441 µg/g.
The Ni concentration in the remaining melt is 118 µg/g, and that in the fractionating assemblage is 660 µg/g.
</pre></div>
</div>
</div>
</div>
<p>(5) Calculate the <span class="math notranslate nohighlight">\(Sm/Nd\)</span> and <span class="math notranslate nohighlight">\(Ni/Nd\)</span> ratios of the original mantle source (MS), the melts M1, M2, M3, and M4 produced in Question 1, 2, 3, and 4, the solid residue S1 of Question 1 and the fractionating minerals F4 of Question 4.</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span>(a) If you compare MS with M1 and S1, what is the main reason for the large difference in <span class="math notranslate nohighlight">\(Ni/Nd\)</span> ratio?</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span>(b) If you compare M1 with M2, what are the main reasons for the different <span class="math notranslate nohighlight">\(Sm/Nd\)</span> ratios?</p>
<p><span class="math notranslate nohighlight">\(\quad\)</span>(c) If you compare M4 with M1 and F4, what are the main reasons for the relatively similar <span class="math notranslate nohighlight">\(Sm/Nd\)</span> ratios, whilst <span class="math notranslate nohighlight">\(Ni/Nd\)</span> is very different?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question 5</span>
<span class="c1"># Calculate Sm/Nd and Ni/Nd ratios of the original mantle source (MS), </span>
<span class="c1"># the melts M1, M2, M3, and M4 produced in Question 1, 2, 3, and 4, </span>
<span class="c1"># the solid residue S1 of Question 1 and the fractionating minerals F4 of Question 4</span>
<span class="n">Sm_Nd_ratio_MS</span> <span class="o">=</span> <span class="n">C0_source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">C0_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ni_Nd_ratio_MS</span> <span class="o">=</span> <span class="n">C0_source</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">C0_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Sm_Nd_ratio_M1</span> <span class="o">=</span> <span class="n">CL_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">CL_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ni_Nd_ratio_M1</span> <span class="o">=</span> <span class="n">CL_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">CL_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Sm_Nd_ratio_M2</span> <span class="o">=</span> <span class="n">CL_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">CL_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ni_Nd_ratio_M2</span> <span class="o">=</span> <span class="n">CL_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">CL_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Sm_Nd_ratio_M3</span> <span class="o">=</span> <span class="n">CL_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">CL_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ni_Nd_ratio_M3</span> <span class="o">=</span> <span class="n">CL_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">CL_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Sm_Nd_ratio_M4</span> <span class="o">=</span> <span class="n">CL_4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">CL_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ni_Nd_ratio_M4</span> <span class="o">=</span> <span class="n">CL_4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">CL_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Sm_Nd_ratio_S1</span> <span class="o">=</span> <span class="n">CS_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">CS_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ni_Nd_ratio_S1</span> <span class="o">=</span> <span class="n">CS_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">CS_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Sm_Nd_ratio_S4</span> <span class="o">=</span> <span class="n">CS_4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">CS_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Ni_Nd_ratio_S4</span> <span class="o">=</span> <span class="n">CS_4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">CS_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># print answers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sm/Nd of MS = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Sm_Nd_ratio_MS</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ni/Nd of MS = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Ni_Nd_ratio_MS</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sm/Nd of M1 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Sm_Nd_ratio_M1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ni/Nd of M1 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Ni_Nd_ratio_M1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sm/Nd of M2 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Sm_Nd_ratio_M2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ni/Nd of M2 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Ni_Nd_ratio_M2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sm/Nd of M3 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Sm_Nd_ratio_M3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ni/Nd of M3 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Ni_Nd_ratio_M3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sm/Nd of M4 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Sm_Nd_ratio_M4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ni/Nd of M4 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Ni_Nd_ratio_M4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sm/Nd of S1 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Sm_Nd_ratio_S1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ni/Nd of S1 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Ni_Nd_ratio_S1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sm/Nd of S4 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Sm_Nd_ratio_S4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ni/Nd of S4 = </span><span class="si">%g</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">round_to_n_sf</span><span class="p">(</span><span class="n">Ni_Nd_ratio_S4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sm/Nd of MS = 0.388.
Ni/Nd of MS = 2670.
Sm/Nd of M1 = 0.345.
Ni/Nd of M1 = 53.6.
Sm/Nd of M2 = 0.221.
Ni/Nd of M2 = 24.3.
Sm/Nd of M3 = 0.2.
Ni/Nd of M3 = 18.9.
Sm/Nd of M4 = 0.346.
Ni/Nd of M4 = 13.5.
Sm/Nd of S1 = 0.581.
Ni/Nd of S1 = 14400.
Sm/Nd of S4 = 0.261.
Ni/Nd of S4 = 3900.
</pre></div>
</div>
</div>
</div>
<p>(a) <span class="math notranslate nohighlight">\(Ni\)</span> is compatible and remains in the residue whilst <span class="math notranslate nohighlight">\(Nd\)</span> is incompatible and is concentrated in the melt.</p>
<p>(b) <span class="math notranslate nohighlight">\(Sm/Nd\)</span> is different because (i) <span class="math notranslate nohighlight">\(F\)</span> is variable and (ii) because <span class="math notranslate nohighlight">\(Sm\)</span> is relatively compatible in garnet, which is in the source of M2 but not M1.</p>
<p>(c) Fractional crystallization is efficient at fractionating compatible element abundances (<span class="math notranslate nohighlight">\(Ni\)</span>) of melts, whilst incompatibles (<span class="math notranslate nohighlight">\(Sm\)</span>, <span class="math notranslate nohighlight">\(Nd\)</span>) are less affected.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Lecture slide and Practical for Lecture 2 of the High-Temperature Geochemistry module</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "primer-computational-mathematics/book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./d_geosciences/High-Temperature Geochemistry"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Major_and_Trace_Elements.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Major and trace elements</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Nuclides.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Nuclides</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Imperial College London<br/>
  
      &copy; Copyright 2020.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>