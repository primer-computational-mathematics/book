

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1D Resistivity Forward Modelling &#8212; ESE Jupyter Material</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Image Filtering" href="Image_Filtering.html" />
    <link rel="prev" title="Camera Calibration" href="Camera_Calibration.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ESE Jupyter Material</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../intro.html">Landing page</a>
  </li>
  <li class="">
    <a href="../mathematics/intro.html">Mathematics</a>
  </li>
  <li class="">
    <a href="../coding/intro.html">Coding</a>
  </li>
  <li class="active">
    <a href="intro.html">Geosciences</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="Tides.html">Tides</a>
    </li>
    <li class="">
      <a href="Google_Earth_Engine_Foundations.html">Google Earth Engine Foundations</a>
    </li>
    <li class="">
      <a href="Image_Point_Operations.html">Image Point Operations</a>
    </li>
    <li class="">
      <a href="Google_Earth_Engine_Getting_Started_.html">Google Earth Engine Getting Started</a>
    </li>
    <li class="">
      <a href="Particle_Image_Velocimetry.html">Particle Image Velocimetry (PIV)</a>
    </li>
    <li class="">
      <a href="Camera_Calibration.html">Camera Calibration</a>
    </li>
    <li class="active">
      <a href="">1D Resistivity Forward Modelling</a>
    </li>
    <li class="">
      <a href="Image_Filtering.html">Image Filtering</a>
    </li>
    <li class="">
      <a href="Climate_Model.html">Climate Model</a>
    </li>
    <li class="">
      <a href="Seismology.html">Seismology</a>
    </li>
    <li class="">
      <a href="Cartography_Cartopy.html">Cartography Cartopy</a>
    </li>
    <li class="">
      <a href="Image_Transformations_and_Orthorectification.html">Image Transformations and orthorectification</a>
    </li>
    <li class="">
      <a href="Dynamic_Earth.html">Dynamic Earth</a>
    </li>
    <li class="">
      <a href="Wave_dispersion.html">Wave Dispersion</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/geosciences/1D_Resistivity_Forward_Modelling.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/primer-computational-mathematics/book/master?urlpath=tree/notebooks/geosciences/1D_Resistivity_Forward_Modelling.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebelabSBT()" title="Launch Thebelab" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#enter-field-data" class="nav-link">Enter field data</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#enter-model-parameters" class="nav-link">Enter model parameters</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#model-generation" class="nav-link">Model generation</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#calculate-rms" class="nav-link">Calculate RMS</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#plot-results" class="nav-link">Plot results</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#references" class="nav-link">References</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="d-resistivity-forward-modelling">
<h1>1D Resistivity Forward Modelling<a class="headerlink" href="#d-resistivity-forward-modelling" title="Permalink to this headline">¶</a></h1>
<p>This notebook allows for the forward modelling of 1D resistivity data based of a chosen input model. Modify the model parameters to reduce the error between our modelled resistivity and our field data. Different models can explain the same data, however the simpler model is commonly preferred. Unless there is alternative data to justify the more complex model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#import required libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="enter-field-data">
<h2>Enter field data<a class="headerlink" href="#enter-field-data" title="Permalink to this headline">¶</a></h2>
<p>Change the below list to match field data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># AB/2 (m)</span>
<span class="n">pos_field</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span><span class="mf">8.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">12.0</span><span class="p">,</span><span class="mf">15.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">,</span><span class="mf">25.0</span><span class="p">,</span><span class="mf">30.0</span><span class="p">,</span><span class="mf">35.0</span><span class="p">,</span><span class="mf">40.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">60.0</span><span class="p">,</span><span class="mf">75.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">125.0</span><span class="p">,</span><span class="mf">150.0</span><span class="p">,</span><span class="mf">175.0</span><span class="p">,</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">250.0</span><span class="p">,</span><span class="mf">300.0</span><span class="p">,</span><span class="mf">400.0</span><span class="p">,</span><span class="mf">450.0</span><span class="p">,</span><span class="mf">500.0</span><span class="p">,</span><span class="mf">600.0</span><span class="p">]</span>

<span class="c1"># resistivity (ohm m)</span>
<span class="n">res_field</span> <span class="o">=</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span><span class="mf">12.8</span><span class="p">,</span><span class="mf">15.5</span><span class="p">,</span><span class="mf">22.0</span><span class="p">,</span><span class="mf">30.0</span><span class="p">,</span><span class="mf">40.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">55.0</span><span class="p">,</span><span class="mf">65.0</span><span class="p">,</span><span class="mf">80.0</span><span class="p">,</span><span class="mf">85.0</span><span class="p">,</span><span class="mf">90.0</span><span class="p">,</span><span class="mf">85.0</span><span class="p">,</span><span class="mf">85.1</span><span class="p">,</span><span class="mf">80.0</span><span class="p">,</span><span class="mf">75.0</span><span class="p">,</span><span class="mf">68.0</span><span class="p">,</span><span class="mf">53.0</span><span class="p">,</span><span class="mf">42.7</span><span class="p">,</span><span class="mf">39.0</span><span class="p">,</span><span class="mf">37.0</span><span class="p">,</span><span class="mf">36.0</span><span class="p">,</span><span class="mf">40.0</span><span class="p">,</span><span class="mf">41.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">49.0</span><span class="p">,</span><span class="mf">55.0</span><span class="p">,</span><span class="mf">57.0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="enter-model-parameters">
<h2>Enter model parameters<a class="headerlink" href="#enter-model-parameters" title="Permalink to this headline">¶</a></h2>
<p>Change the below lists to modify the model. The script takes any number of layers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## enter model parameters</span>
<span class="n">layer_no</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">depth_mdl</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.75</span><span class="p">,</span><span class="mf">5.00</span><span class="p">,</span><span class="mf">8.50</span><span class="p">,</span><span class="mf">18.00</span><span class="p">,</span><span class="mf">64.00</span><span class="p">,</span><span class="mf">200.00</span><span class="p">,</span><span class="mf">320.00</span><span class="p">,</span><span class="mf">1000.00</span><span class="p">]</span>  <span class="c1">#layer affected</span>
<span class="n">res_mdl</span> <span class="o">=</span> <span class="p">[</span><span class="mf">11.00</span><span class="p">,</span><span class="mf">650.00</span><span class="p">,</span><span class="mf">17.00</span><span class="p">,</span><span class="mf">200.00</span><span class="p">,</span><span class="mf">9.00</span><span class="p">,</span><span class="mf">320.00</span><span class="p">,</span><span class="mf">5.00</span><span class="p">,</span><span class="mf">70.00</span><span class="p">]</span>   <span class="c1">#layer affected</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="model-generation">
<h2>Model generation<a class="headerlink" href="#model-generation" title="Permalink to this headline">¶</a></h2>
<p>run all the cells below to process the input parameters and generate the final resistivity result. A complete curve matching method derived from the Bessel functions is used. This expression is suitable for solving any number of layers. Note that there is a large number of theoretical models that will fit the field data. Theoretical model obtained from reference 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#calculate layer thickness</span>
<span class="n">lyr_thickness</span> <span class="o">=</span> <span class="p">[</span><span class="n">depth_mdl</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>    <span class="c1">#layer affected</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">depth_mdl</span><span class="p">)):</span>    <span class="c1">#layer affected</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">lyr_thickness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth_mdl</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">depth_mdl</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>    <span class="c1">#layer affected</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">break</span>

<span class="c1">#required data lists</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">23</span><span class="o">+</span><span class="mi">14</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span> <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.14</span><span class="p">)</span>  

<span class="n">absica</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="o">+</span><span class="mi">23</span><span class="p">,</span><span class="mi">14</span><span class="o">+</span><span class="mi">23</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.000318</span><span class="p">,</span><span class="mf">0.002072</span><span class="p">,</span><span class="o">-</span><span class="mf">0.004978</span><span class="p">,</span><span class="mf">0.01125</span><span class="p">,</span><span class="o">-</span><span class="mf">0.02521</span><span class="p">,</span><span class="mf">0.05812</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1436</span><span class="p">,</span><span class="mf">0.393</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1324</span><span class="p">,</span><span class="mf">2.7044</span><span class="p">,</span><span class="o">-</span><span class="mf">3.4507</span><span class="p">,</span><span class="mf">0.4248</span><span class="p">,</span><span class="mf">1.1817</span><span class="p">,</span><span class="mf">0.6194</span><span class="p">,</span><span class="mf">0.2374</span><span class="p">,</span><span class="mf">0.08688</span><span class="p">,</span><span class="mf">0.0235</span><span class="p">,</span><span class="mf">0.01284</span><span class="p">,</span><span class="o">-</span><span class="mf">0.001198</span><span class="p">,</span><span class="mf">0.003042</span><span class="p">]</span>

<span class="c1">#transform data</span>
<span class="n">Transform</span> <span class="o">=</span> <span class="p">[]</span>  
<span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lyr_thickness</span><span class="p">)</span>    <span class="c1">#layer affected</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">I</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="n">length</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
        <span class="k">if</span> <span class="n">lyr_thickness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">lyr_thickness</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>    <span class="c1">#layer affected</span>
            <span class="n">results</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_mdl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">res_mdl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">lyr_thickness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">j</span><span class="p">)))</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>  <span class="o">*</span> <span class="p">((</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">lyr_thickness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">j</span><span class="p">)))</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span> <span class="n">res_mdl</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">Transform</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Apply lineal filters from O&#39;Neil   #??is this the correct naming??</span>
<span class="n">Transform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Transform</span><span class="p">)</span>   

<span class="n">Lineal_Filters</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#is this the correct naming?&quot;&quot;</span>

<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">19</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">19</span><span class="p">):</span>
        <span class="n">results</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span> <span class="n">Transform</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">Lineal_Filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#sum all columns</span>
<span class="n">Lineal_Filters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Lineal_Filters</span><span class="p">)</span>
<span class="n">res</span><span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Lineal_Filters</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Lineal_Filters</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">depth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">depth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-rms">
<h2>Calculate RMS<a class="headerlink" href="#calculate-rms" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#interpolate results at interval of field data</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span><span class="n">res</span><span class="p">)</span>
<span class="n">res_interp</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">pos_field</span><span class="p">)</span>

<span class="c1">#find RMS</span>
<span class="n">res_interp</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res_interp</span><span class="p">)</span>
<span class="n">res_field</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res_field</span><span class="p">)</span>
<span class="n">RMS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">res_field</span><span class="o">-</span><span class="n">res_interp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-results">
<h2>Plot results<a class="headerlink" href="#plot-results" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#create earth layers plot</span>
<span class="n">box_res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res_mdl</span><span class="p">:</span> <span class="n">box_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">box_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>   <span class="c1">#layer affected</span>

<span class="n">box_depth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">depth_mdl</span><span class="p">:</span>
        <span class="n">box_depth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">box_depth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>      <span class="c1">#layer affected</span>
<span class="n">box_depth</span> <span class="o">=</span> <span class="n">box_depth</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;depth (m)&quot;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;resistivity (ohm m)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span> <span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;model_results&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span> <span class="p">(</span><span class="n">box_depth</span><span class="p">,</span><span class="n">box_res</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;input_model&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span> <span class="p">(</span><span class="n">pos_field</span><span class="p">,</span><span class="n">res_field</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;field_data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;RMS error = </span><span class="si">%2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">RMS</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span> <span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1D_Resistivity_Forward_Modelling_16_0.png" src="../_images/1D_Resistivity_Forward_Modelling_16_0.png" />
</div>
</div>
<p>You could generate a loop to test a variety of models and save the best fit models to memory.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Molano, C., 2020. Carlosmolanowebsite. [online] Sites.google.com. Available at: <a class="reference external" href="https://sites.google.com/a/hidrogeocol.com.co/carlos_molano/Home">https://sites.google.com/a/hidrogeocol.com.co/carlos_molano/Home</a> [Accessed 26 June 2020].</p></li>
<li><p>Telford, WM, Geldart, LP, &amp; Sheriff, RE 1990, Applied Geophysics, Cambridge University Press, Cambridge. Available from: ProQuest Ebook Central. [26 June 2020].</p></li>
</ol>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Camera_Calibration.html" title="previous page">Camera Calibration</a>
    <a class='right-next' id="next-link" href="Image_Filtering.html" title="next page">Image Filtering</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Imperial College London<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>